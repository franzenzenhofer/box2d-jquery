/*! box2d-jquery - v0.8 - last build: 2013-02-21 21:36:54 */
var Box2D={};(function(c,b){function a(){}if(!(Object.prototype.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function){Object.defineProperty=function(f,e,d){d.get instanceof Function&&f.__defineGetter__(e,d.get);
d.set instanceof Function&&f.__defineSetter__(e,d.set);};}c.inherit=function(e,d){a.prototype=d.prototype;e.prototype=new a;e.prototype.constructor=e;};
c.generateCallback=function(e,d){return function(){d.apply(e,arguments);};};c.NVector=function(f){if(f===b){f=0;}for(var e=Array(f||0),d=0;d<f;++d){e[d]=0;
}return e;};c.is=function(e,d){if(e===null){return false;}if(d instanceof Function&&e instanceof d){return true;}if(e.constructor.__implements!=b&&e.constructor.__implements[d]){return true;
}return false;};c.parseUInt=function(d){return Math.abs(parseInt(d));};})(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;if(typeof Box2D==="undefined"){Box2D={};
}if(typeof Box2D.Collision==="undefined"){Box2D.Collision={};}if(typeof Box2D.Collision.Shapes==="undefined"){Box2D.Collision.Shapes={};}if(typeof Box2D.Common==="undefined"){Box2D.Common={};
}if(typeof Box2D.Common.Math==="undefined"){Box2D.Common.Math={};}if(typeof Box2D.Dynamics==="undefined"){Box2D.Dynamics={};}if(typeof Box2D.Dynamics.Contacts==="undefined"){Box2D.Dynamics.Contacts={};
}if(typeof Box2D.Dynamics.Controllers==="undefined"){Box2D.Dynamics.Controllers={};}if(typeof Box2D.Dynamics.Joints==="undefined"){Box2D.Dynamics.Joints={};
}(function(){function bp(){bp.b2AABB.apply(this,arguments);}function bo(){bo.b2Bound.apply(this,arguments);}function bi(){bi.b2BoundValues.apply(this,arguments);
this.constructor===bi&&this.b2BoundValues.apply(this,arguments);}function au(){au.b2Collision.apply(this,arguments);}function ax(){ax.b2ContactID.apply(this,arguments);
this.constructor===ax&&this.b2ContactID.apply(this,arguments);}function bw(){bw.b2ContactPoint.apply(this,arguments);}function a6(){a6.b2Distance.apply(this,arguments);
}function aE(){aE.b2DistanceInput.apply(this,arguments);}function bv(){bv.b2DistanceOutput.apply(this,arguments);}function bb(){bb.b2DistanceProxy.apply(this,arguments);
}function a5(){a5.b2DynamicTree.apply(this,arguments);this.constructor===a5&&this.b2DynamicTree.apply(this,arguments);}function bg(){bg.b2DynamicTreeBroadPhase.apply(this,arguments);
}function bh(){bh.b2DynamicTreeNode.apply(this,arguments);}function bm(){bm.b2DynamicTreePair.apply(this,arguments);}function a4(){a4.b2Manifold.apply(this,arguments);
this.constructor===a4&&this.b2Manifold.apply(this,arguments);}function a2(){a2.b2ManifoldPoint.apply(this,arguments);this.constructor===a2&&this.b2ManifoldPoint.apply(this,arguments);
}function aK(){aK.b2Point.apply(this,arguments);}function at(){at.b2RayCastInput.apply(this,arguments);this.constructor===at&&this.b2RayCastInput.apply(this,arguments);
}function az(){az.b2RayCastOutput.apply(this,arguments);}function bs(){bs.b2Segment.apply(this,arguments);}function bn(){bn.b2SeparationFunction.apply(this,arguments);
}function be(){be.b2Simplex.apply(this,arguments);this.constructor===be&&this.b2Simplex.apply(this,arguments);}function br(){br.b2SimplexCache.apply(this,arguments);
}function a9(){a9.b2SimplexVertex.apply(this,arguments);}function bf(){bf.b2TimeOfImpact.apply(this,arguments);}function a8(){a8.b2TOIInput.apply(this,arguments);
}function bB(){bB.b2WorldManifold.apply(this,arguments);this.constructor===bB&&this.b2WorldManifold.apply(this,arguments);}function a0(){a0.ClipVertex.apply(this,arguments);
}function aT(){aT.Features.apply(this,arguments);}function aO(){aO.b2CircleShape.apply(this,arguments);this.constructor===aO&&this.b2CircleShape.apply(this,arguments);
}function aJ(){aJ.b2EdgeChainDef.apply(this,arguments);this.constructor===aJ&&this.b2EdgeChainDef.apply(this,arguments);}function aL(){aL.b2EdgeShape.apply(this,arguments);
this.constructor===aL&&this.b2EdgeShape.apply(this,arguments);}function aF(){aF.b2MassData.apply(this,arguments);}function aD(){aD.b2PolygonShape.apply(this,arguments);
this.constructor===aD&&this.b2PolygonShape.apply(this,arguments);}function aG(){aG.b2Shape.apply(this,arguments);this.constructor===aG&&this.b2Shape.apply(this,arguments);
}function aX(){aX.b2Color.apply(this,arguments);this.constructor===aX&&this.b2Color.apply(this,arguments);}function aU(){aU.b2Settings.apply(this,arguments);
}function aP(){aP.b2Mat22.apply(this,arguments);this.constructor===aP&&this.b2Mat22.apply(this,arguments);}function aW(){aW.b2Mat33.apply(this,arguments);
this.constructor===aW&&this.b2Mat33.apply(this,arguments);}function aR(){aR.b2Math.apply(this,arguments);}function aQ(){aQ.b2Sweep.apply(this,arguments);
}function aI(){aI.b2Transform.apply(this,arguments);this.constructor===aI&&this.b2Transform.apply(this,arguments);}function aC(){aC.b2Vec2.apply(this,arguments);
this.constructor===aC&&this.b2Vec2.apply(this,arguments);}function aB(){aB.b2Vec3.apply(this,arguments);this.constructor===aB&&this.b2Vec3.apply(this,arguments);
}function ay(){ay.b2Body.apply(this,arguments);this.constructor===ay&&this.b2Body.apply(this,arguments);}function aA(){aA.b2BodyDef.apply(this,arguments);
this.constructor===aA&&this.b2BodyDef.apply(this,arguments);}function aw(){aw.b2ContactFilter.apply(this,arguments);}function bu(){bu.b2ContactImpulse.apply(this,arguments);
}function bj(){bj.b2ContactListener.apply(this,arguments);}function a7(){a7.b2ContactManager.apply(this,arguments);this.constructor===a7&&this.b2ContactManager.apply(this,arguments);
}function bc(){bc.b2DebugDraw.apply(this,arguments);this.constructor===bc&&this.b2DebugDraw.apply(this,arguments);}function a3(){a3.b2DestructionListener.apply(this,arguments);
}function bG(){bG.b2FilterData.apply(this,arguments);}function bd(){bd.b2Fixture.apply(this,arguments);this.constructor===bd&&this.b2Fixture.apply(this,arguments);
}function aH(){aH.b2FixtureDef.apply(this,arguments);this.constructor===aH&&this.b2FixtureDef.apply(this,arguments);}function al(){al.b2Island.apply(this,arguments);
this.constructor===al&&this.b2Island.apply(this,arguments);}function af(){af.b2TimeStep.apply(this,arguments);}function ad(){ad.b2World.apply(this,arguments);
this.constructor===ad&&this.b2World.apply(this,arguments);}function bO(){bO.b2CircleContact.apply(this,arguments);}function bL(){bL.b2Contact.apply(this,arguments);
this.constructor===bL&&this.b2Contact.apply(this,arguments);}function bC(){bC.b2ContactConstraint.apply(this,arguments);this.constructor===bC&&this.b2ContactConstraint.apply(this,arguments);
}function bF(){bF.b2ContactConstraintPoint.apply(this,arguments);}function bt(){bt.b2ContactEdge.apply(this,arguments);}function bk(){bk.b2ContactFactory.apply(this,arguments);
this.constructor===bk&&this.b2ContactFactory.apply(this,arguments);}function aV(){aV.b2ContactRegister.apply(this,arguments);}function ap(){ap.b2ContactResult.apply(this,arguments);
}function aM(){aM.b2ContactSolver.apply(this,arguments);this.constructor===aM&&this.b2ContactSolver.apply(this,arguments);}function ah(){ah.b2EdgeAndCircleContact.apply(this,arguments);
}function am(){am.b2NullContact.apply(this,arguments);this.constructor===am&&this.b2NullContact.apply(this,arguments);}function bQ(){bQ.b2PolyAndCircleContact.apply(this,arguments);
}function bI(){bI.b2PolyAndEdgeContact.apply(this,arguments);}function by(){by.b2PolygonContact.apply(this,arguments);}function ae(){ae.b2PositionSolverManifold.apply(this,arguments);
this.constructor===ae&&this.b2PositionSolverManifold.apply(this,arguments);}function aZ(){aZ.b2BuoyancyController.apply(this,arguments);}function ar(){ar.b2ConstantAccelController.apply(this,arguments);
}function aj(){aj.b2ConstantForceController.apply(this,arguments);}function ac(){ac.b2Controller.apply(this,arguments);}function bK(){bK.b2ControllerEdge.apply(this,arguments);
}function bA(){bA.b2GravityController.apply(this,arguments);}function a1(){a1.b2TensorDampingController.apply(this,arguments);}function bN(){bN.b2DistanceJoint.apply(this,arguments);
this.constructor===bN&&this.b2DistanceJoint.apply(this,arguments);}function bE(){bE.b2DistanceJointDef.apply(this,arguments);this.constructor===bE&&this.b2DistanceJointDef.apply(this,arguments);
}function bq(){bq.b2FrictionJoint.apply(this,arguments);this.constructor===bq&&this.b2FrictionJoint.apply(this,arguments);}function aS(){aS.b2FrictionJointDef.apply(this,arguments);
this.constructor===aS&&this.b2FrictionJointDef.apply(this,arguments);}function ao(){ao.b2GearJoint.apply(this,arguments);this.constructor===ao&&this.b2GearJoint.apply(this,arguments);
}function ag(){ag.b2GearJointDef.apply(this,arguments);this.constructor===ag&&this.b2GearJointDef.apply(this,arguments);}function av(){av.b2Jacobian.apply(this,arguments);
}function bP(){bP.b2Joint.apply(this,arguments);this.constructor===bP&&this.b2Joint.apply(this,arguments);}function bH(){bH.b2JointDef.apply(this,arguments);
this.constructor===bH&&this.b2JointDef.apply(this,arguments);}function ak(){ak.b2JointEdge.apply(this,arguments);}function bx(){bx.b2LineJoint.apply(this,arguments);
this.constructor===bx&&this.b2LineJoint.apply(this,arguments);}function aY(){aY.b2LineJointDef.apply(this,arguments);this.constructor===aY&&this.b2LineJointDef.apply(this,arguments);
}function aq(){aq.b2MouseJoint.apply(this,arguments);this.constructor===aq&&this.b2MouseJoint.apply(this,arguments);}function ai(){ai.b2MouseJointDef.apply(this,arguments);
this.constructor===ai&&this.b2MouseJointDef.apply(this,arguments);}function ab(){ab.b2PrismaticJoint.apply(this,arguments);this.constructor===ab&&this.b2PrismaticJoint.apply(this,arguments);
}function bJ(){bJ.b2PrismaticJointDef.apply(this,arguments);this.constructor===bJ&&this.b2PrismaticJointDef.apply(this,arguments);}function bz(){bz.b2PulleyJoint.apply(this,arguments);
this.constructor===bz&&this.b2PulleyJoint.apply(this,arguments);}function bM(){bM.b2PulleyJointDef.apply(this,arguments);this.constructor===bM&&this.b2PulleyJointDef.apply(this,arguments);
}function bD(){bD.b2RevoluteJoint.apply(this,arguments);this.constructor===bD&&this.b2RevoluteJoint.apply(this,arguments);}function bl(){bl.b2RevoluteJointDef.apply(this,arguments);
this.constructor===bl&&this.b2RevoluteJointDef.apply(this,arguments);}function aN(){aN.b2WeldJoint.apply(this,arguments);this.constructor===aN&&this.b2WeldJoint.apply(this,arguments);
}function an(){an.b2WeldJointDef.apply(this,arguments);this.constructor===an&&this.b2WeldJointDef.apply(this,arguments);}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase";
Box2D.Collision.b2AABB=bp;Box2D.Collision.b2Bound=bo;Box2D.Collision.b2BoundValues=bi;Box2D.Collision.b2Collision=au;Box2D.Collision.b2ContactID=ax;Box2D.Collision.b2ContactPoint=bw;
Box2D.Collision.b2Distance=a6;Box2D.Collision.b2DistanceInput=aE;Box2D.Collision.b2DistanceOutput=bv;Box2D.Collision.b2DistanceProxy=bb;Box2D.Collision.b2DynamicTree=a5;
Box2D.Collision.b2DynamicTreeBroadPhase=bg;Box2D.Collision.b2DynamicTreeNode=bh;Box2D.Collision.b2DynamicTreePair=bm;Box2D.Collision.b2Manifold=a4;Box2D.Collision.b2ManifoldPoint=a2;
Box2D.Collision.b2Point=aK;Box2D.Collision.b2RayCastInput=at;Box2D.Collision.b2RayCastOutput=az;Box2D.Collision.b2Segment=bs;Box2D.Collision.b2SeparationFunction=bn;
Box2D.Collision.b2Simplex=be;Box2D.Collision.b2SimplexCache=br;Box2D.Collision.b2SimplexVertex=a9;Box2D.Collision.b2TimeOfImpact=bf;Box2D.Collision.b2TOIInput=a8;
Box2D.Collision.b2WorldManifold=bB;Box2D.Collision.ClipVertex=a0;Box2D.Collision.Features=aT;Box2D.Collision.Shapes.b2CircleShape=aO;Box2D.Collision.Shapes.b2EdgeChainDef=aJ;
Box2D.Collision.Shapes.b2EdgeShape=aL;Box2D.Collision.Shapes.b2MassData=aF;Box2D.Collision.Shapes.b2PolygonShape=aD;Box2D.Collision.Shapes.b2Shape=aG;Box2D.Common.b2internal="Box2D.Common.b2internal";
Box2D.Common.b2Color=aX;Box2D.Common.b2Settings=aU;Box2D.Common.Math.b2Mat22=aP;Box2D.Common.Math.b2Mat33=aW;Box2D.Common.Math.b2Math=aR;Box2D.Common.Math.b2Sweep=aQ;
Box2D.Common.Math.b2Transform=aI;Box2D.Common.Math.b2Vec2=aC;Box2D.Common.Math.b2Vec3=aB;Box2D.Dynamics.b2Body=ay;Box2D.Dynamics.b2BodyDef=aA;Box2D.Dynamics.b2ContactFilter=aw;
Box2D.Dynamics.b2ContactImpulse=bu;Box2D.Dynamics.b2ContactListener=bj;Box2D.Dynamics.b2ContactManager=a7;Box2D.Dynamics.b2DebugDraw=bc;Box2D.Dynamics.b2DestructionListener=a3;
Box2D.Dynamics.b2FilterData=bG;Box2D.Dynamics.b2Fixture=bd;Box2D.Dynamics.b2FixtureDef=aH;Box2D.Dynamics.b2Island=al;Box2D.Dynamics.b2TimeStep=af;Box2D.Dynamics.b2World=ad;
Box2D.Dynamics.Contacts.b2CircleContact=bO;Box2D.Dynamics.Contacts.b2Contact=bL;Box2D.Dynamics.Contacts.b2ContactConstraint=bC;Box2D.Dynamics.Contacts.b2ContactConstraintPoint=bF;
Box2D.Dynamics.Contacts.b2ContactEdge=bt;Box2D.Dynamics.Contacts.b2ContactFactory=bk;Box2D.Dynamics.Contacts.b2ContactRegister=aV;Box2D.Dynamics.Contacts.b2ContactResult=ap;
Box2D.Dynamics.Contacts.b2ContactSolver=aM;Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=ah;Box2D.Dynamics.Contacts.b2NullContact=am;Box2D.Dynamics.Contacts.b2PolyAndCircleContact=bQ;
Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=bI;Box2D.Dynamics.Contacts.b2PolygonContact=by;Box2D.Dynamics.Contacts.b2PositionSolverManifold=ae;Box2D.Dynamics.Controllers.b2BuoyancyController=aZ;
Box2D.Dynamics.Controllers.b2ConstantAccelController=ar;Box2D.Dynamics.Controllers.b2ConstantForceController=aj;Box2D.Dynamics.Controllers.b2Controller=ac;
Box2D.Dynamics.Controllers.b2ControllerEdge=bK;Box2D.Dynamics.Controllers.b2GravityController=bA;Box2D.Dynamics.Controllers.b2TensorDampingController=a1;
Box2D.Dynamics.Joints.b2DistanceJoint=bN;Box2D.Dynamics.Joints.b2DistanceJointDef=bE;Box2D.Dynamics.Joints.b2FrictionJoint=bq;Box2D.Dynamics.Joints.b2FrictionJointDef=aS;
Box2D.Dynamics.Joints.b2GearJoint=ao;Box2D.Dynamics.Joints.b2GearJointDef=ag;Box2D.Dynamics.Joints.b2Jacobian=av;Box2D.Dynamics.Joints.b2Joint=bP;Box2D.Dynamics.Joints.b2JointDef=bH;
Box2D.Dynamics.Joints.b2JointEdge=ak;Box2D.Dynamics.Joints.b2LineJoint=bx;Box2D.Dynamics.Joints.b2LineJointDef=aY;Box2D.Dynamics.Joints.b2MouseJoint=aq;
Box2D.Dynamics.Joints.b2MouseJointDef=ai;Box2D.Dynamics.Joints.b2PrismaticJoint=ab;Box2D.Dynamics.Joints.b2PrismaticJointDef=bJ;Box2D.Dynamics.Joints.b2PulleyJoint=bz;
Box2D.Dynamics.Joints.b2PulleyJointDef=bM;Box2D.Dynamics.Joints.b2RevoluteJoint=bD;Box2D.Dynamics.Joints.b2RevoluteJointDef=bl;Box2D.Dynamics.Joints.b2WeldJoint=aN;
Box2D.Dynamics.Joints.b2WeldJointDef=an;})();Box2D.postDefs=[];(function(){var ad=Box2D.Collision.Shapes.b2CircleShape,ac=Box2D.Collision.Shapes.b2PolygonShape,T=Box2D.Collision.Shapes.b2Shape,ak=Box2D.Common.b2Settings,al=Box2D.Common.Math.b2Math,ah=Box2D.Common.Math.b2Sweep,r=Box2D.Common.Math.b2Transform,ao=Box2D.Common.Math.b2Vec2,ag=Box2D.Collision.b2AABB,v=Box2D.Collision.b2Bound,m=Box2D.Collision.b2BoundValues,J=Box2D.Collision.b2Collision,P=Box2D.Collision.b2ContactID,X=Box2D.Collision.b2ContactPoint,f=Box2D.Collision.b2Distance,e=Box2D.Collision.b2DistanceInput,at=Box2D.Collision.b2DistanceOutput,aj=Box2D.Collision.b2DistanceProxy,am=Box2D.Collision.b2DynamicTree,af=Box2D.Collision.b2DynamicTreeBroadPhase,ab=Box2D.Collision.b2DynamicTreeNode,x=Box2D.Collision.b2DynamicTreePair,ae=Box2D.Collision.b2Manifold,t=Box2D.Collision.b2ManifoldPoint,C=Box2D.Collision.b2Point,s=Box2D.Collision.b2RayCastInput,ai=Box2D.Collision.b2RayCastOutput,b=Box2D.Collision.b2Segment,ax=Box2D.Collision.b2SeparationFunction,av=Box2D.Collision.b2Simplex,ar=Box2D.Collision.b2SimplexCache,au=Box2D.Collision.b2SimplexVertex,ap=Box2D.Collision.b2TimeOfImpact,an=Box2D.Collision.b2TOIInput,aq=Box2D.Collision.b2WorldManifold,az=Box2D.Collision.ClipVertex,ay=Box2D.Collision.Features,aw=Box2D.Collision.IBroadPhase;
ag.b2AABB=function(){this.lowerBound=new ao;this.upperBound=new ao;};ag.prototype.IsValid=function(){var a=this.upperBound.y-this.lowerBound.y;return a=(a=this.upperBound.x-this.lowerBound.x>=0&&a>=0)&&this.lowerBound.IsValid()&&this.upperBound.IsValid();
};ag.prototype.GetCenter=function(){return new ao((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2);};ag.prototype.GetExtents=function(){return new ao((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2);
};ag.prototype.Contains=function(a){var c=true;return c=(c=(c=(c=c&&this.lowerBound.x<=a.lowerBound.x)&&this.lowerBound.y<=a.lowerBound.y)&&a.upperBound.x<=this.upperBound.x)&&a.upperBound.y<=this.upperBound.y;
};ag.prototype.RayCast=function(n,l){var k=-Number.MAX_VALUE,d=Number.MAX_VALUE,a=l.p1.x,y=l.p1.y,q=l.p2.x-l.p1.x,u=l.p2.y-l.p1.y,p=Math.abs(u),c=n.normal,o=0,g=0,j=o=0;
j=0;if(Math.abs(q)<Number.MIN_VALUE){if(a<this.lowerBound.x||this.upperBound.x<a){return false;}}else{o=1/q;g=(this.lowerBound.x-a)*o;o=(this.upperBound.x-a)*o;
j=-1;if(g>o){j=g;g=o;o=j;j=1;}if(g>k){c.x=j;c.y=0;k=g;}d=Math.min(d,o);if(k>d){return false;}}if(p<Number.MIN_VALUE){if(y<this.lowerBound.y||this.upperBound.y<y){return false;
}}else{o=1/u;g=(this.lowerBound.y-y)*o;o=(this.upperBound.y-y)*o;j=-1;if(g>o){j=g;g=o;o=j;j=1;}if(g>k){c.y=j;c.x=0;k=g;}d=Math.min(d,o);if(k>d){return false;
}}n.fraction=k;return true;};ag.prototype.TestOverlap=function(a){var d=a.lowerBound.y-this.upperBound.y,c=this.lowerBound.y-a.upperBound.y;if(a.lowerBound.x-this.upperBound.x>0||d>0){return false;
}if(this.lowerBound.x-a.upperBound.x>0||c>0){return false;}return true;};ag.Combine=function(a,d){var c=new ag;c.Combine(a,d);return c;};ag.prototype.Combine=function(a,c){this.lowerBound.x=Math.min(a.lowerBound.x,c.lowerBound.x);
this.lowerBound.y=Math.min(a.lowerBound.y,c.lowerBound.y);this.upperBound.x=Math.max(a.upperBound.x,c.upperBound.x);this.upperBound.y=Math.max(a.upperBound.y,c.upperBound.y);
};v.b2Bound=function(){};v.prototype.IsLower=function(){return(this.value&1)==0;};v.prototype.IsUpper=function(){return(this.value&1)==1;};v.prototype.Swap=function(c){var g=this.value,d=this.proxy,a=this.stabbingCount;
this.value=c.value;this.proxy=c.proxy;this.stabbingCount=c.stabbingCount;c.value=g;c.proxy=d;c.stabbingCount=a;};m.b2BoundValues=function(){};m.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number;
this.lowerValues[0]=0;this.lowerValues[1]=0;this.upperValues=new Vector_a2j_Number;this.upperValues[0]=0;this.upperValues[1]=0;};J.b2Collision=function(){};
J.ClipSegmentToLine=function(j,g,d,c){if(c===undefined){c=0;}var a,o=0;a=g[0];var l=a.v;a=g[1];var n=a.v,k=d.x*l.x+d.y*l.y-c;a=d.x*n.x+d.y*n.y-c;k<=0&&j[o++].Set(g[0]);
a<=0&&j[o++].Set(g[1]);if(k*a<0){d=k/(k-a);a=j[o];a=a.v;a.x=l.x+d*(n.x-l.x);a.y=l.y+d*(n.y-l.y);a=j[o];a.id=(k>0?g[0]:g[1]).id;++o;}return o;};J.EdgeSeparation=function(o,n,l,g,a){if(l===undefined){l=0;
}parseInt(o.m_vertexCount);var z=o.m_vertices;o=o.m_normals;var u=parseInt(g.m_vertexCount),y=g.m_vertices,q,c;q=n.R;c=o[l];o=q.col1.x*c.x+q.col2.x*c.y;
g=q.col1.y*c.x+q.col2.y*c.y;q=a.R;var p=q.col1.x*o+q.col1.y*g;q=q.col2.x*o+q.col2.y*g;for(var j=0,k=Number.MAX_VALUE,d=0;d<u;++d){c=y[d];c=c.x*p+c.y*q;
if(c<k){k=c;j=d;}}c=z[l];q=n.R;l=n.position.x+(q.col1.x*c.x+q.col2.x*c.y);n=n.position.y+(q.col1.y*c.x+q.col2.y*c.y);c=y[j];q=a.R;z=a.position.x+(q.col1.x*c.x+q.col2.x*c.y);
a=a.position.y+(q.col1.y*c.x+q.col2.y*c.y);z-=l;a-=n;return z*o+a*g;};J.FindMaxSeparation=function(p,o,n,g,a){var A=parseInt(o.m_vertexCount),y=o.m_normals,z,u;
u=a.R;z=g.m_centroid;var c=a.position.x+(u.col1.x*z.x+u.col2.x*z.y),q=a.position.y+(u.col1.y*z.x+u.col2.y*z.y);u=n.R;z=o.m_centroid;c-=n.position.x+(u.col1.x*z.x+u.col2.x*z.y);
q-=n.position.y+(u.col1.y*z.x+u.col2.y*z.y);u=c*n.R.col1.x+q*n.R.col1.y;q=c*n.R.col2.x+q*n.R.col2.y;c=0;for(var j=-Number.MAX_VALUE,l=0;l<A;++l){z=y[l];
z=z.x*u+z.y*q;if(z>j){j=z;c=l;}}y=J.EdgeSeparation(o,n,c,g,a);z=parseInt(c-1>=0?c-1:A-1);u=J.EdgeSeparation(o,n,z,g,a);q=parseInt(c+1<A?c+1:0);j=J.EdgeSeparation(o,n,q,g,a);
var d=l=0,k=0;if(u>y&&u>j){k=-1;l=z;d=u;}else{if(j>y){k=1;l=q;d=j;}else{p[0]=c;return y;}}for(;;){c=k==-1?l-1>=0?l-1:A-1:l+1<A?l+1:0;y=J.EdgeSeparation(o,n,c,g,a);
if(y>d){l=c;d=y;}else{break;}}p[0]=l;return d;};J.FindIncidentEdge=function(l,k,j,d,a,u){if(d===undefined){d=0;}parseInt(k.m_vertexCount);var p=k.m_normals,q=parseInt(a.m_vertexCount);
k=a.m_vertices;a=a.m_normals;var o;o=j.R;j=p[d];p=o.col1.x*j.x+o.col2.x*j.y;var c=o.col1.y*j.x+o.col2.y*j.y;o=u.R;j=o.col1.x*p+o.col1.y*c;c=o.col2.x*p+o.col2.y*c;
p=j;o=0;for(var n=Number.MAX_VALUE,g=0;g<q;++g){j=a[g];j=p*j.x+c*j.y;if(j<n){n=j;o=g;}}a=parseInt(o);p=parseInt(a+1<q?a+1:0);q=l[0];j=k[a];o=u.R;q.v.x=u.position.x+(o.col1.x*j.x+o.col2.x*j.y);
q.v.y=u.position.y+(o.col1.y*j.x+o.col2.y*j.y);q.id.features.referenceEdge=d;q.id.features.incidentEdge=a;q.id.features.incidentVertex=0;q=l[1];j=k[p];
o=u.R;q.v.x=u.position.x+(o.col1.x*j.x+o.col2.x*j.y);q.v.y=u.position.y+(o.col1.y*j.x+o.col2.y*j.y);q.id.features.referenceEdge=d;q.id.features.incidentEdge=p;
q.id.features.incidentVertex=1;};J.MakeClipPointVector=function(){var a=new Vector(2);a[0]=new az;a[1]=new az;return a;};J.CollidePolygons=function(q,o,n,g,a){var B;
q.m_pointCount=0;var z=o.m_radius+g.m_radius;B=0;J.s_edgeAO[0]=B;var A=J.FindMaxSeparation(J.s_edgeAO,o,n,g,a);B=J.s_edgeAO[0];if(!(A>z)){var y=0;J.s_edgeBO[0]=y;
var c=J.FindMaxSeparation(J.s_edgeBO,g,a,o,n);y=J.s_edgeBO[0];if(!(c>z)){var u=0,j=0;if(c>0.98*A+0.001){A=g;g=o;o=a;n=n;u=y;q.m_type=ae.e_faceB;j=1;}else{A=o;
g=g;o=n;n=a;u=B;q.m_type=ae.e_faceA;j=0;}B=J.s_incidentEdge;J.FindIncidentEdge(B,A,o,u,g,n);y=parseInt(A.m_vertexCount);a=A.m_vertices;A=a[u];var l;l=u+1<y?a[parseInt(u+1)]:a[0];
u=J.s_localTangent;u.Set(l.x-A.x,l.y-A.y);u.Normalize();a=J.s_localNormal;a.x=u.y;a.y=-u.x;g=J.s_planePoint;g.Set(0.5*(A.x+l.x),0.5*(A.y+l.y));c=J.s_tangent;
y=o.R;c.x=y.col1.x*u.x+y.col2.x*u.y;c.y=y.col1.y*u.x+y.col2.y*u.y;var d=J.s_tangent2;d.x=-c.x;d.y=-c.y;u=J.s_normal;u.x=c.y;u.y=-c.x;var k=J.s_v11,p=J.s_v12;
k.x=o.position.x+(y.col1.x*A.x+y.col2.x*A.y);k.y=o.position.y+(y.col1.y*A.x+y.col2.y*A.y);p.x=o.position.x+(y.col1.x*l.x+y.col2.x*l.y);p.y=o.position.y+(y.col1.y*l.x+y.col2.y*l.y);
o=u.x*k.x+u.y*k.y;y=c.x*p.x+c.y*p.y+z;l=J.s_clipPoints1;A=J.s_clipPoints2;p=0;p=J.ClipSegmentToLine(l,B,d,-c.x*k.x-c.y*k.y+z);if(!(p<2)){p=J.ClipSegmentToLine(A,l,c,y);
if(!(p<2)){q.m_localPlaneNormal.SetV(a);q.m_localPoint.SetV(g);for(g=a=0;g<ak.b2_maxManifoldPoints;++g){B=A[g];if(u.x*B.v.x+u.y*B.v.y-o<=z){c=q.m_points[a];
y=n.R;d=B.v.x-n.position.x;k=B.v.y-n.position.y;c.m_localPoint.x=d*y.col1.x+k*y.col1.y;c.m_localPoint.y=d*y.col2.x+k*y.col2.y;c.m_id.Set(B.id);c.m_id.features.flip=j;
++a;}}q.m_pointCount=a;}}}}};J.CollideCircles=function(c,n,l,a,k){c.m_pointCount=0;var j,d;j=l.R;d=n.m_p;var g=l.position.x+(j.col1.x*d.x+j.col2.x*d.y);
l=l.position.y+(j.col1.y*d.x+j.col2.y*d.y);j=k.R;d=a.m_p;g=k.position.x+(j.col1.x*d.x+j.col2.x*d.y)-g;k=k.position.y+(j.col1.y*d.x+j.col2.y*d.y)-l;j=n.m_radius+a.m_radius;
if(!(g*g+k*k>j*j)){c.m_type=ae.e_circles;c.m_localPoint.SetV(n.m_p);c.m_localPlaneNormal.SetZero();c.m_pointCount=1;c.m_points[0].m_localPoint.SetV(a.m_p);
c.m_points[0].m_id.key=0;}};J.CollidePolygonAndCircle=function(o,n,l,g,a){var z=o.m_pointCount=0,u=0,y,q;q=a.R;y=g.m_p;var c=a.position.y+(q.col1.y*y.x+q.col2.y*y.y);
z=a.position.x+(q.col1.x*y.x+q.col2.x*y.y)-l.position.x;u=c-l.position.y;q=l.R;l=z*q.col1.x+u*q.col1.y;q=z*q.col2.x+u*q.col2.y;var p=0;c=-Number.MAX_VALUE;
a=n.m_radius+g.m_radius;var j=parseInt(n.m_vertexCount),k=n.m_vertices;n=n.m_normals;for(var d=0;d<j;++d){y=k[d];z=l-y.x;u=q-y.y;y=n[d];z=y.x*z+y.y*u;if(z>a){return;
}if(z>c){c=z;p=d;}}z=parseInt(p);u=parseInt(z+1<j?z+1:0);y=k[z];k=k[u];if(c<Number.MIN_VALUE){o.m_pointCount=1;o.m_type=ae.e_faceA;o.m_localPlaneNormal.SetV(n[p]);
o.m_localPoint.x=0.5*(y.x+k.x);o.m_localPoint.y=0.5*(y.y+k.y);}else{c=(l-k.x)*(y.x-k.x)+(q-k.y)*(y.y-k.y);if((l-y.x)*(k.x-y.x)+(q-y.y)*(k.y-y.y)<=0){if((l-y.x)*(l-y.x)+(q-y.y)*(q-y.y)>a*a){return;
}o.m_pointCount=1;o.m_type=ae.e_faceA;o.m_localPlaneNormal.x=l-y.x;o.m_localPlaneNormal.y=q-y.y;o.m_localPlaneNormal.Normalize();o.m_localPoint.SetV(y);
}else{if(c<=0){if((l-k.x)*(l-k.x)+(q-k.y)*(q-k.y)>a*a){return;}o.m_pointCount=1;o.m_type=ae.e_faceA;o.m_localPlaneNormal.x=l-k.x;o.m_localPlaneNormal.y=q-k.y;
o.m_localPlaneNormal.Normalize();o.m_localPoint.SetV(k);}else{p=0.5*(y.x+k.x);y=0.5*(y.y+k.y);c=(l-p)*n[z].x+(q-y)*n[z].y;if(c>a){return;}o.m_pointCount=1;
o.m_type=ae.e_faceA;o.m_localPlaneNormal.x=n[z].x;o.m_localPlaneNormal.y=n[z].y;o.m_localPlaneNormal.Normalize();o.m_localPoint.Set(p,y);}}}o.m_points[0].m_localPoint.SetV(g.m_p);
o.m_points[0].m_id.key=0;};J.TestOverlap=function(c,l){var k=l.lowerBound,a=c.upperBound,j=k.x-a.x,g=k.y-a.y;k=c.lowerBound;a=l.upperBound;var d=k.y-a.y;
if(j>0||g>0){return false;}if(k.x-a.x>0||d>0){return false;}return true;};Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=J.MakeClipPointVector();
Box2D.Collision.b2Collision.s_clipPoints1=J.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints2=J.MakeClipPointVector();Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1);
Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_localTangent=new ao;Box2D.Collision.b2Collision.s_localNormal=new ao;
Box2D.Collision.b2Collision.s_planePoint=new ao;Box2D.Collision.b2Collision.s_normal=new ao;Box2D.Collision.b2Collision.s_tangent=new ao;Box2D.Collision.b2Collision.s_tangent2=new ao;
Box2D.Collision.b2Collision.s_v11=new ao;Box2D.Collision.b2Collision.s_v12=new ao;Box2D.Collision.b2Collision.b2CollidePolyTempVec=new ao;Box2D.Collision.b2Collision.b2_nullFeature=255;
});P.b2ContactID=function(){this.features=new ay;};P.prototype.b2ContactID=function(){this.features._m_id=this;};P.prototype.Set=function(a){this.key=a._key;
};P.prototype.Copy=function(){var a=new P;a.key=this.key;return a;};Object.defineProperty(P.prototype,"key",{enumerable:false,configurable:true,get:function(){return this._key;
}});Object.defineProperty(P.prototype,"key",{enumerable:false,configurable:true,set:function(a){if(a===undefined){a=0;}this._key=a;this.features._referenceEdge=this._key&255;
this.features._incidentEdge=(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&4278190080)>>24&255;
}});X.b2ContactPoint=function(){this.position=new ao;this.velocity=new ao;this.normal=new ao;this.id=new P;};f.b2Distance=function(){};f.Distance=function(q,o,n){++f.b2_gjkCalls;
var g=n.proxyA,a=n.proxyB,B=n.transformA,z=n.transformB,A=f.s_simplex;A.ReadCache(o,g,B,a,z);var y=A.m_vertices,c=f.s_saveA,u=f.s_saveB,j=0;A.GetClosestPoint().LengthSquared();
for(var l=0,d,k=0;k<20;){j=A.m_count;for(l=0;l<j;l++){c[l]=y[l].indexA;u[l]=y[l].indexB;}switch(A.m_count){case 1:break;case 2:A.Solve2();break;case 3:A.Solve3();
break;default:ak.b2Assert(false);}if(A.m_count==3){break;}d=A.GetClosestPoint();d.LengthSquared();l=A.GetSearchDirection();if(l.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE){break;
}d=y[A.m_count];d.indexA=g.GetSupport(al.MulTMV(B.R,l.GetNegative()));d.wA=al.MulX(B,g.GetVertex(d.indexA));d.indexB=a.GetSupport(al.MulTMV(z.R,l));d.wB=al.MulX(z,a.GetVertex(d.indexB));
d.w=al.SubtractVV(d.wB,d.wA);++k;++f.b2_gjkIters;var p=false;for(l=0;l<j;l++){if(d.indexA==c[l]&&d.indexB==u[l]){p=true;break;}}if(p){break;}++A.m_count;
}f.b2_gjkMaxIters=al.Max(f.b2_gjkMaxIters,k);A.GetWitnessPoints(q.pointA,q.pointB);q.distance=al.SubtractVV(q.pointA,q.pointB).Length();q.iterations=k;
A.WriteCache(o);if(n.useRadii){o=g.m_radius;a=a.m_radius;if(q.distance>o+a&&q.distance>Number.MIN_VALUE){q.distance-=o+a;n=al.SubtractVV(q.pointB,q.pointA);
n.Normalize();q.pointA.x+=o*n.x;q.pointA.y+=o*n.y;q.pointB.x-=a*n.x;q.pointB.y-=a*n.y;}else{d=new ao;d.x=0.5*(q.pointA.x+q.pointB.x);d.y=0.5*(q.pointA.y+q.pointB.y);
q.pointA.x=q.pointB.x=d.x;q.pointA.y=q.pointB.y=d.y;q.distance=0;}}};Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new av;Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3);
Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3);});e.b2DistanceInput=function(){};at.b2DistanceOutput=function(){this.pointA=new ao;this.pointB=new ao;
};aj.b2DistanceProxy=function(){};aj.prototype.Set=function(a){switch(a.GetType()){case T.e_circleShape:a=a instanceof ad?a:null;this.m_vertices=new Vector(1,true);
this.m_vertices[0]=a.m_p;this.m_count=1;this.m_radius=a.m_radius;break;case T.e_polygonShape:a=a instanceof ac?a:null;this.m_vertices=a.m_vertices;this.m_count=a.m_vertexCount;
this.m_radius=a.m_radius;break;default:ak.b2Assert(false);}};aj.prototype.GetSupport=function(c){for(var j=0,g=this.m_vertices[0].x*c.x+this.m_vertices[0].y*c.y,a=1;
a<this.m_count;++a){var d=this.m_vertices[a].x*c.x+this.m_vertices[a].y*c.y;if(d>g){j=a;g=d;}}return j;};aj.prototype.GetSupportVertex=function(c){for(var j=0,g=this.m_vertices[0].x*c.x+this.m_vertices[0].y*c.y,a=1;
a<this.m_count;++a){var d=this.m_vertices[a].x*c.x+this.m_vertices[a].y*c.y;if(d>g){j=a;g=d;}}return this.m_vertices[j];};aj.prototype.GetVertexCount=function(){return this.m_count;
};aj.prototype.GetVertex=function(a){if(a===undefined){a=0;}ak.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a];};am.b2DynamicTree=function(){};
am.prototype.b2DynamicTree=function(){this.m_freeList=this.m_root=null;this.m_insertionCount=this.m_path=0;};am.prototype.CreateProxy=function(c,j){var g=this.AllocateNode(),a=ak.b2_aabbExtension,d=ak.b2_aabbExtension;
g.aabb.lowerBound.x=c.lowerBound.x-a;g.aabb.lowerBound.y=c.lowerBound.y-d;g.aabb.upperBound.x=c.upperBound.x+a;g.aabb.upperBound.y=c.upperBound.y+d;g.userData=j;
this.InsertLeaf(g);return g;};am.prototype.DestroyProxy=function(a){this.RemoveLeaf(a);this.FreeNode(a);};am.prototype.MoveProxy=function(c,g,d){ak.b2Assert(c.IsLeaf());
if(c.aabb.Contains(g)){return false;}this.RemoveLeaf(c);var a=ak.b2_aabbExtension+ak.b2_aabbMultiplier*(d.x>0?d.x:-d.x);d=ak.b2_aabbExtension+ak.b2_aabbMultiplier*(d.y>0?d.y:-d.y);
c.aabb.lowerBound.x=g.lowerBound.x-a;c.aabb.lowerBound.y=g.lowerBound.y-d;c.aabb.upperBound.x=g.upperBound.x+a;c.aabb.upperBound.y=g.upperBound.y+d;this.InsertLeaf(c);
return true;};am.prototype.Rebalance=function(c){if(c===undefined){c=0;}if(this.m_root!=null){for(var g=0;g<c;g++){for(var d=this.m_root,a=0;d.IsLeaf()==false;
){d=this.m_path>>a&1?d.child2:d.child1;a=a+1&31;}++this.m_path;this.RemoveLeaf(d);this.InsertLeaf(d);}}};am.prototype.GetFatAABB=function(a){return a.aabb;
};am.prototype.GetUserData=function(a){return a.userData;};am.prototype.Query=function(c,j){if(this.m_root!=null){var g=new Vector,a=0;for(g[a++]=this.m_root;
a>0;){var d=g[--a];if(d.aabb.TestOverlap(j)){if(d.IsLeaf()){if(!c(d)){break;}}else{g[a++]=d.child1;g[a++]=d.child2;}}}}};am.prototype.RayCast=function(l,k){if(this.m_root!=null){var j=k.p1,d=k.p2,a=al.SubtractVV(j,d);
a.Normalize();a=al.CrossFV(1,a);var u=al.AbsV(a),p=k.maxFraction,q=new ag,o=0,c=0;o=j.x+p*(d.x-j.x);c=j.y+p*(d.y-j.y);q.lowerBound.x=Math.min(j.x,o);q.lowerBound.y=Math.min(j.y,c);
q.upperBound.x=Math.max(j.x,o);q.upperBound.y=Math.max(j.y,c);var n=new Vector,g=0;for(n[g++]=this.m_root;g>0;){p=n[--g];if(p.aabb.TestOverlap(q)!=false){o=p.aabb.GetCenter();
c=p.aabb.GetExtents();if(!(Math.abs(a.x*(j.x-o.x)+a.y*(j.y-o.y))-u.x*c.x-u.y*c.y>0)){if(p.IsLeaf()){o=new s;o.p1=k.p1;o.p2=k.p2;o.maxFraction=k.maxFraction;
p=l(o,p);if(p==0){break;}if(p>0){o=j.x+p*(d.x-j.x);c=j.y+p*(d.y-j.y);q.lowerBound.x=Math.min(j.x,o);q.lowerBound.y=Math.min(j.y,c);q.upperBound.x=Math.max(j.x,o);
q.upperBound.y=Math.max(j.y,c);}}else{n[g++]=p.child1;n[g++]=p.child2;}}}}}};am.prototype.AllocateNode=function(){if(this.m_freeList){var a=this.m_freeList;
this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;return a;}return new ab;};am.prototype.FreeNode=function(a){a.parent=this.m_freeList;
this.m_freeList=a;};am.prototype.InsertLeaf=function(c){++this.m_insertionCount;if(this.m_root==null){this.m_root=c;this.m_root.parent=null;}else{var g=c.aabb.GetCenter(),d=this.m_root;
if(d.IsLeaf()==false){do{var a=d.child1;d=d.child2;d=Math.abs((a.aabb.lowerBound.x+a.aabb.upperBound.x)/2-g.x)+Math.abs((a.aabb.lowerBound.y+a.aabb.upperBound.y)/2-g.y)<Math.abs((d.aabb.lowerBound.x+d.aabb.upperBound.x)/2-g.x)+Math.abs((d.aabb.lowerBound.y+d.aabb.upperBound.y)/2-g.y)?a:d;
}while(d.IsLeaf()==false);}g=d.parent;a=this.AllocateNode();a.parent=g;a.userData=null;a.aabb.Combine(c.aabb,d.aabb);if(g){if(d.parent.child1==d){g.child1=a;
}else{g.child2=a;}a.child1=d;a.child2=c;d.parent=a;c.parent=a;do{if(g.aabb.Contains(a.aabb)){break;}g.aabb.Combine(g.child1.aabb,g.child2.aabb);a=g;g=g.parent;
}while(g);}else{a.child1=d;a.child2=c;d.parent=a;this.m_root=c.parent=a;}}};am.prototype.RemoveLeaf=function(a){if(a==this.m_root){this.m_root=null;}else{var d=a.parent,c=d.parent;
a=d.child1==a?d.child2:d.child1;if(c){if(c.child1==d){c.child1=a;}else{c.child2=a;}a.parent=c;for(this.FreeNode(d);c;){d=c.aabb;c.aabb=ag.Combine(c.child1.aabb,c.child2.aabb);
if(d.Contains(c.aabb)){break;}c=c.parent;}}else{this.m_root=a;a.parent=null;this.FreeNode(d);}}};af.b2DynamicTreeBroadPhase=function(){this.m_tree=new am;
this.m_moveBuffer=new Vector;this.m_pairBuffer=new Vector;this.m_pairCount=0;};af.prototype.CreateProxy=function(a,d){var c=this.m_tree.CreateProxy(a,d);
++this.m_proxyCount;this.BufferMove(c);return c;};af.prototype.DestroyProxy=function(a){this.UnBufferMove(a);--this.m_proxyCount;this.m_tree.DestroyProxy(a);
};af.prototype.MoveProxy=function(a,d,c){this.m_tree.MoveProxy(a,d,c)&&this.BufferMove(a);};af.prototype.TestOverlap=function(c,g){var d=this.m_tree.GetFatAABB(c),a=this.m_tree.GetFatAABB(g);
return d.TestOverlap(a);};af.prototype.GetUserData=function(a){return this.m_tree.GetUserData(a);};af.prototype.GetFatAABB=function(a){return this.m_tree.GetFatAABB(a);
};af.prototype.GetProxyCount=function(){return this.m_proxyCount;};af.prototype.UpdatePairs=function(c){var l=this;var k=l.m_pairCount=0,a;for(k=0;k<l.m_moveBuffer.length;
++k){a=l.m_moveBuffer[k];var j=l.m_tree.GetFatAABB(a);l.m_tree.Query(function(o){if(o==a){return true;}if(l.m_pairCount==l.m_pairBuffer.length){l.m_pairBuffer[l.m_pairCount]=new x;
}var n=l.m_pairBuffer[l.m_pairCount];n.proxyA=o<a?o:a;n.proxyB=o>=a?o:a;++l.m_pairCount;return true;},j);}for(k=l.m_moveBuffer.length=0;k<l.m_pairCount;
){j=l.m_pairBuffer[k];var g=l.m_tree.GetUserData(j.proxyA),d=l.m_tree.GetUserData(j.proxyB);c(g,d);for(++k;k<l.m_pairCount;){g=l.m_pairBuffer[k];if(g.proxyA!=j.proxyA||g.proxyB!=j.proxyB){break;
}++k;}}};af.prototype.Query=function(a,c){this.m_tree.Query(a,c);};af.prototype.RayCast=function(a,c){this.m_tree.RayCast(a,c);};af.prototype.Validate=function(){};
af.prototype.Rebalance=function(a){if(a===undefined){a=0;}this.m_tree.Rebalance(a);};af.prototype.BufferMove=function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a;
};af.prototype.UnBufferMove=function(a){this.m_moveBuffer.splice(parseInt(this.m_moveBuffer.indexOf(a)),1);};af.prototype.ComparePairs=function(){return 0;
};af.__implements={};af.__implements[aw]=true;ab.b2DynamicTreeNode=function(){this.aabb=new ag;};ab.prototype.IsLeaf=function(){return this.child1==null;
};x.b2DynamicTreePair=function(){};ae.b2Manifold=function(){this.m_pointCount=0;};ae.prototype.b2Manifold=function(){this.m_points=new Vector(ak.b2_maxManifoldPoints);
for(var a=0;a<ak.b2_maxManifoldPoints;a++){this.m_points[a]=new t;}this.m_localPlaneNormal=new ao;this.m_localPoint=new ao;};ae.prototype.Reset=function(){for(var a=0;
a<ak.b2_maxManifoldPoints;a++){(this.m_points[a] instanceof t?this.m_points[a]:null).Reset();}this.m_localPlaneNormal.SetZero();this.m_localPoint.SetZero();
this.m_pointCount=this.m_type=0;};ae.prototype.Set=function(a){this.m_pointCount=a.m_pointCount;for(var c=0;c<ak.b2_maxManifoldPoints;c++){(this.m_points[c] instanceof t?this.m_points[c]:null).Set(a.m_points[c]);
}this.m_localPlaneNormal.SetV(a.m_localPlaneNormal);this.m_localPoint.SetV(a.m_localPoint);this.m_type=a.m_type;};ae.prototype.Copy=function(){var a=new ae;
a.Set(this);return a;};Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1;Box2D.Collision.b2Manifold.e_faceA=2;Box2D.Collision.b2Manifold.e_faceB=4;
});t.b2ManifoldPoint=function(){this.m_localPoint=new ao;this.m_id=new P;};t.prototype.b2ManifoldPoint=function(){this.Reset();};t.prototype.Reset=function(){this.m_localPoint.SetZero();
this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.key=0;};t.prototype.Set=function(a){this.m_localPoint.SetV(a.m_localPoint);this.m_normalImpulse=a.m_normalImpulse;
this.m_tangentImpulse=a.m_tangentImpulse;this.m_id.Set(a.m_id);};C.b2Point=function(){this.p=new ao;};C.prototype.Support=function(){return this.p;};C.prototype.GetFirstVertex=function(){return this.p;
};s.b2RayCastInput=function(){this.p1=new ao;this.p2=new ao;};s.prototype.b2RayCastInput=function(a,d,c){if(a===undefined){a=null;}if(d===undefined){d=null;
}if(c===undefined){c=1;}a&&this.p1.SetV(a);d&&this.p2.SetV(d);this.maxFraction=c;};ai.b2RayCastOutput=function(){this.normal=new ao;};b.b2Segment=function(){this.p1=new ao;
this.p2=new ao;};b.prototype.TestSegment=function(l,k,j,d){if(d===undefined){d=0;}var a=j.p1,u=j.p2.x-a.x,p=j.p2.y-a.y;j=this.p2.y-this.p1.y;var q=-(this.p2.x-this.p1.x),o=100*Number.MIN_VALUE,c=-(u*j+p*q);
if(c>o){var n=a.x-this.p1.x,g=a.y-this.p1.y;a=n*j+g*q;if(0<=a&&a<=d*c){d=-u*g+p*n;if(-o*c<=d&&d<=c*(1+o)){a/=c;d=Math.sqrt(j*j+q*q);j/=d;q/=d;l[0]=a;k.Set(j,q);
return true;}}}return false;};b.prototype.Extend=function(a){this.ExtendForward(a);this.ExtendBackward(a);};b.prototype.ExtendForward=function(a){var d=this.p2.x-this.p1.x,c=this.p2.y-this.p1.y;
a=Math.min(d>0?(a.upperBound.x-this.p1.x)/d:d<0?(a.lowerBound.x-this.p1.x)/d:Number.POSITIVE_INFINITY,c>0?(a.upperBound.y-this.p1.y)/c:c<0?(a.lowerBound.y-this.p1.y)/c:Number.POSITIVE_INFINITY);
this.p2.x=this.p1.x+d*a;this.p2.y=this.p1.y+c*a;};b.prototype.ExtendBackward=function(a){var d=-this.p2.x+this.p1.x,c=-this.p2.y+this.p1.y;a=Math.min(d>0?(a.upperBound.x-this.p2.x)/d:d<0?(a.lowerBound.x-this.p2.x)/d:Number.POSITIVE_INFINITY,c>0?(a.upperBound.y-this.p2.y)/c:c<0?(a.lowerBound.y-this.p2.y)/c:Number.POSITIVE_INFINITY);
this.p1.x=this.p2.x+d*a;this.p1.y=this.p2.y+c*a;};ax.b2SeparationFunction=function(){this.m_localPoint=new ao;this.m_axis=new ao;};ax.prototype.Initialize=function(l,k,j,d,a){this.m_proxyA=k;
this.m_proxyB=d;var u=parseInt(l.count);ak.b2Assert(0<u&&u<3);var p,q,o,c,n=c=o=d=k=0,g=0;n=0;if(u==1){this.m_type=ax.e_points;p=this.m_proxyA.GetVertex(l.indexA[0]);
q=this.m_proxyB.GetVertex(l.indexB[0]);u=p;l=j.R;k=j.position.x+(l.col1.x*u.x+l.col2.x*u.y);d=j.position.y+(l.col1.y*u.x+l.col2.y*u.y);u=q;l=a.R;o=a.position.x+(l.col1.x*u.x+l.col2.x*u.y);
c=a.position.y+(l.col1.y*u.x+l.col2.y*u.y);this.m_axis.x=o-k;this.m_axis.y=c-d;this.m_axis.Normalize();}else{if(l.indexB[0]==l.indexB[1]){this.m_type=ax.e_faceA;
k=this.m_proxyA.GetVertex(l.indexA[0]);d=this.m_proxyA.GetVertex(l.indexA[1]);q=this.m_proxyB.GetVertex(l.indexB[0]);this.m_localPoint.x=0.5*(k.x+d.x);
this.m_localPoint.y=0.5*(k.y+d.y);this.m_axis=al.CrossVF(al.SubtractVV(d,k),1);this.m_axis.Normalize();u=this.m_axis;l=j.R;n=l.col1.x*u.x+l.col2.x*u.y;
g=l.col1.y*u.x+l.col2.y*u.y;u=this.m_localPoint;l=j.R;k=j.position.x+(l.col1.x*u.x+l.col2.x*u.y);d=j.position.y+(l.col1.y*u.x+l.col2.y*u.y);u=q;l=a.R;o=a.position.x+(l.col1.x*u.x+l.col2.x*u.y);
c=a.position.y+(l.col1.y*u.x+l.col2.y*u.y);n=(o-k)*n+(c-d)*g;}else{if(l.indexA[0]==l.indexA[0]){this.m_type=ax.e_faceB;o=this.m_proxyB.GetVertex(l.indexB[0]);
c=this.m_proxyB.GetVertex(l.indexB[1]);p=this.m_proxyA.GetVertex(l.indexA[0]);this.m_localPoint.x=0.5*(o.x+c.x);this.m_localPoint.y=0.5*(o.y+c.y);this.m_axis=al.CrossVF(al.SubtractVV(c,o),1);
this.m_axis.Normalize();u=this.m_axis;l=a.R;n=l.col1.x*u.x+l.col2.x*u.y;g=l.col1.y*u.x+l.col2.y*u.y;u=this.m_localPoint;l=a.R;o=a.position.x+(l.col1.x*u.x+l.col2.x*u.y);
c=a.position.y+(l.col1.y*u.x+l.col2.y*u.y);u=p;l=j.R;k=j.position.x+(l.col1.x*u.x+l.col2.x*u.y);d=j.position.y+(l.col1.y*u.x+l.col2.y*u.y);n=(k-o)*n+(d-c)*g;
}else{k=this.m_proxyA.GetVertex(l.indexA[0]);d=this.m_proxyA.GetVertex(l.indexA[1]);o=this.m_proxyB.GetVertex(l.indexB[0]);c=this.m_proxyB.GetVertex(l.indexB[1]);
al.MulX(j,p);p=al.MulMV(j.R,al.SubtractVV(d,k));al.MulX(a,q);n=al.MulMV(a.R,al.SubtractVV(c,o));a=p.x*p.x+p.y*p.y;q=n.x*n.x+n.y*n.y;l=al.SubtractVV(n,p);
j=p.x*l.x+p.y*l.y;l=n.x*l.x+n.y*l.y;p=p.x*n.x+p.y*n.y;g=a*q-p*p;n=0;if(g!=0){n=al.Clamp((p*l-j*q)/g,0,1);}if((p*n+l)/q<0){n=al.Clamp((p-j)/a,0,1);}p=new ao;
p.x=k.x+n*(d.x-k.x);p.y=k.y+n*(d.y-k.y);q=new ao;q.x=o.x+n*(c.x-o.x);q.y=o.y+n*(c.y-o.y);if(n==0||n==1){this.m_type=ax.e_faceB;this.m_axis=al.CrossVF(al.SubtractVV(c,o),1);
this.m_axis.Normalize();this.m_localPoint=q;}else{this.m_type=ax.e_faceA;this.m_axis=al.CrossVF(al.SubtractVV(d,k),1);this.m_localPoint=p;}}}n<0&&this.m_axis.NegativeSelf();
}};ax.prototype.Evaluate=function(c,j){var g,a,d=0;switch(this.m_type){case ax.e_points:g=al.MulTMV(c.R,this.m_axis);a=al.MulTMV(j.R,this.m_axis.GetNegative());
g=this.m_proxyA.GetSupportVertex(g);a=this.m_proxyB.GetSupportVertex(a);g=al.MulX(c,g);a=al.MulX(j,a);return d=(a.x-g.x)*this.m_axis.x+(a.y-g.y)*this.m_axis.y;
case ax.e_faceA:d=al.MulMV(c.R,this.m_axis);g=al.MulX(c,this.m_localPoint);a=al.MulTMV(j.R,d.GetNegative());a=this.m_proxyB.GetSupportVertex(a);a=al.MulX(j,a);
return d=(a.x-g.x)*d.x+(a.y-g.y)*d.y;case ax.e_faceB:d=al.MulMV(j.R,this.m_axis);a=al.MulX(j,this.m_localPoint);g=al.MulTMV(c.R,d.GetNegative());g=this.m_proxyA.GetSupportVertex(g);
g=al.MulX(c,g);return d=(g.x-a.x)*d.x+(g.y-a.y)*d.y;default:ak.b2Assert(false);return 0;}};Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1;
Box2D.Collision.b2SeparationFunction.e_faceA=2;Box2D.Collision.b2SeparationFunction.e_faceB=4;});av.b2Simplex=function(){this.m_v1=new au;this.m_v2=new au;
this.m_v3=new au;this.m_vertices=new Vector(3);};av.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3;
};av.prototype.ReadCache=function(k,j,g,d,a){ak.b2Assert(0<=k.count&&k.count<=3);var p,n;this.m_count=k.count;for(var o=this.m_vertices,l=0;l<this.m_count;
l++){var c=o[l];c.indexA=k.indexA[l];c.indexB=k.indexB[l];p=j.GetVertex(c.indexA);n=d.GetVertex(c.indexB);c.wA=al.MulX(g,p);c.wB=al.MulX(a,n);c.w=al.SubtractVV(c.wB,c.wA);
c.a=0;}if(this.m_count>1){k=k.metric;p=this.GetMetric();if(p<0.5*k||2*k<p||p<Number.MIN_VALUE){this.m_count=0;}}if(this.m_count==0){c=o[0];c.indexA=0;c.indexB=0;
p=j.GetVertex(0);n=d.GetVertex(0);c.wA=al.MulX(g,p);c.wB=al.MulX(a,n);c.w=al.SubtractVV(c.wB,c.wA);this.m_count=1;}};av.prototype.WriteCache=function(a){a.metric=this.GetMetric();
a.count=Box2D.parseUInt(this.m_count);for(var d=this.m_vertices,c=0;c<this.m_count;c++){a.indexA[c]=Box2D.parseUInt(d[c].indexA);a.indexB[c]=Box2D.parseUInt(d[c].indexB);
}};av.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var a=al.SubtractVV(this.m_v2.w,this.m_v1.w);
return al.CrossVV(a,this.m_v1.w.GetNegative())>0?al.CrossFV(1,a):al.CrossVF(a,1);default:ak.b2Assert(false);return new ao;}};av.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:ak.b2Assert(false);
return new ao;case 1:return this.m_v1.w;case 2:return new ao(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);
default:ak.b2Assert(false);return new ao;}};av.prototype.GetWitnessPoints=function(a,c){switch(this.m_count){case 0:ak.b2Assert(false);break;case 1:a.SetV(this.m_v1.wA);
c.SetV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;c.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;
c.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:c.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;
c.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:ak.b2Assert(false);}};av.prototype.GetMetric=function(){switch(this.m_count){case 0:ak.b2Assert(false);
return 0;case 1:return 0;case 2:return al.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return al.CrossVV(al.SubtractVV(this.m_v2.w,this.m_v1.w),al.SubtractVV(this.m_v3.w,this.m_v1.w));
default:ak.b2Assert(false);return 0;}};av.prototype.Solve2=function(){var a=this.m_v1.w,d=this.m_v2.w,c=al.SubtractVV(d,a);a=-(a.x*c.x+a.y*c.y);if(a<=0){this.m_count=this.m_v1.a=1;
}else{d=d.x*c.x+d.y*c.y;if(d<=0){this.m_count=this.m_v2.a=1;this.m_v1.Set(this.m_v2);}else{c=1/(d+a);this.m_v1.a=d*c;this.m_v2.a=a*c;this.m_count=2;}}};
av.prototype.Solve3=function(){var k=this.m_v1.w,j=this.m_v2.w,g=this.m_v3.w,d=al.SubtractVV(j,k),a=al.Dot(k,d),q=al.Dot(j,d);a=-a;var o=al.SubtractVV(g,k),p=al.Dot(k,o),n=al.Dot(g,o);
p=-p;var c=al.SubtractVV(g,j),l=al.Dot(j,c);c=al.Dot(g,c);l=-l;o=al.CrossVV(d,o);d=o*al.CrossVV(j,g);g=o*al.CrossVV(g,k);k=o*al.CrossVV(k,j);if(a<=0&&p<=0){this.m_count=this.m_v1.a=1;
}else{if(q>0&&a>0&&k<=0){n=1/(q+a);this.m_v1.a=q*n;this.m_v2.a=a*n;this.m_count=2;}else{if(n>0&&p>0&&g<=0){q=1/(n+p);this.m_v1.a=n*q;this.m_v3.a=p*q;this.m_count=2;
this.m_v2.Set(this.m_v3);}else{if(q<=0&&l<=0){this.m_count=this.m_v2.a=1;this.m_v1.Set(this.m_v2);}else{if(n<=0&&c<=0){this.m_count=this.m_v3.a=1;this.m_v1.Set(this.m_v3);
}else{if(c>0&&l>0&&d<=0){q=1/(c+l);this.m_v2.a=c*q;this.m_v3.a=l*q;this.m_count=2;this.m_v1.Set(this.m_v3);}else{q=1/(d+g+k);this.m_v1.a=d*q;this.m_v2.a=g*q;
this.m_v3.a=k*q;this.m_count=3;}}}}}}};ar.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3);this.indexB=new Vector_a2j_Number(3);};au.b2SimplexVertex=function(){};
au.prototype.Set=function(a){this.wA.SetV(a.wA);this.wB.SetV(a.wB);this.w.SetV(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB;};ap.b2TimeOfImpact=function(){};
ap.TimeOfImpact=function(u){++ap.b2_toiCalls;var p=u.proxyA,o=u.proxyB,g=u.sweepA,a=u.sweepB;ak.b2Assert(g.t0==a.t0);ak.b2Assert(1-g.t0>Number.MIN_VALUE);
var D=p.m_radius+o.m_radius;u=u.tolerance;var A=0,B=0,z=0;ap.s_cache.count=0;for(ap.s_distanceInput.useRadii=false;;){g.GetTransform(ap.s_xfA,A);a.GetTransform(ap.s_xfB,A);
ap.s_distanceInput.proxyA=p;ap.s_distanceInput.proxyB=o;ap.s_distanceInput.transformA=ap.s_xfA;ap.s_distanceInput.transformB=ap.s_xfB;f.Distance(ap.s_distanceOutput,ap.s_cache,ap.s_distanceInput);
if(ap.s_distanceOutput.distance<=0){A=1;break;}ap.s_fcn.Initialize(ap.s_cache,p,ap.s_xfA,o,ap.s_xfB);var c=ap.s_fcn.Evaluate(ap.s_xfA,ap.s_xfB);if(c<=0){A=1;
break;}if(B==0){z=c>D?al.Max(D-u,0.75*D):al.Max(c-u,0.02*D);}if(c-z<0.5*u){if(B==0){A=1;break;}break;}var y=A,k=A,n=1;c=c;g.GetTransform(ap.s_xfA,n);a.GetTransform(ap.s_xfB,n);
var d=ap.s_fcn.Evaluate(ap.s_xfA,ap.s_xfB);if(d>=z){A=1;break;}for(var l=0;;){var q=0;q=l&1?k+(z-c)*(n-k)/(d-c):0.5*(k+n);g.GetTransform(ap.s_xfA,q);a.GetTransform(ap.s_xfB,q);
var j=ap.s_fcn.Evaluate(ap.s_xfA,ap.s_xfB);if(al.Abs(j-z)<0.025*u){y=q;break;}if(j>z){k=q;c=j;}else{n=q;d=j;}++l;++ap.b2_toiRootIters;if(l==50){break;}}ap.b2_toiMaxRootIters=al.Max(ap.b2_toiMaxRootIters,l);
if(y<(1+100*Number.MIN_VALUE)*A){break;}A=y;B++;++ap.b2_toiIters;if(B==1000){break;}}ap.b2_toiMaxIters=al.Max(ap.b2_toiMaxIters,B);return A;};Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0;
Box2D.Collision.b2TimeOfImpact.b2_toiIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0;
Box2D.Collision.b2TimeOfImpact.s_cache=new ar;Box2D.Collision.b2TimeOfImpact.s_distanceInput=new e;Box2D.Collision.b2TimeOfImpact.s_xfA=new r;Box2D.Collision.b2TimeOfImpact.s_xfB=new r;
Box2D.Collision.b2TimeOfImpact.s_fcn=new ax;Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new at;});an.b2TOIInput=function(){this.proxyA=new aj;this.proxyB=new aj;
this.sweepA=new ah;this.sweepB=new ah;};aq.b2WorldManifold=function(){this.m_normal=new ao;};aq.prototype.b2WorldManifold=function(){this.m_points=new Vector(ak.b2_maxManifoldPoints);
for(var a=0;a<ak.b2_maxManifoldPoints;a++){this.m_points[a]=new ao;}};aq.prototype.Initialize=function(n,l,k,d,a){if(k===undefined){k=0;}if(a===undefined){a=0;
}if(n.m_pointCount!=0){var y=0,q,u,p=0,c=0,o=0,g=0,j=0;q=0;switch(n.m_type){case ae.e_circles:u=l.R;q=n.m_localPoint;y=l.position.x+u.col1.x*q.x+u.col2.x*q.y;
l=l.position.y+u.col1.y*q.x+u.col2.y*q.y;u=d.R;q=n.m_points[0].m_localPoint;n=d.position.x+u.col1.x*q.x+u.col2.x*q.y;d=d.position.y+u.col1.y*q.x+u.col2.y*q.y;
q=n-y;u=d-l;p=q*q+u*u;if(p>Number.MIN_VALUE*Number.MIN_VALUE){p=Math.sqrt(p);this.m_normal.x=q/p;this.m_normal.y=u/p;}else{this.m_normal.x=1;this.m_normal.y=0;
}q=l+k*this.m_normal.y;d=d-a*this.m_normal.y;this.m_points[0].x=0.5*(y+k*this.m_normal.x+(n-a*this.m_normal.x));this.m_points[0].y=0.5*(q+d);break;case ae.e_faceA:u=l.R;
q=n.m_localPlaneNormal;p=u.col1.x*q.x+u.col2.x*q.y;c=u.col1.y*q.x+u.col2.y*q.y;u=l.R;q=n.m_localPoint;o=l.position.x+u.col1.x*q.x+u.col2.x*q.y;g=l.position.y+u.col1.y*q.x+u.col2.y*q.y;
this.m_normal.x=p;this.m_normal.y=c;for(y=0;y<n.m_pointCount;y++){u=d.R;q=n.m_points[y].m_localPoint;j=d.position.x+u.col1.x*q.x+u.col2.x*q.y;q=d.position.y+u.col1.y*q.x+u.col2.y*q.y;
this.m_points[y].x=j+0.5*(k-(j-o)*p-(q-g)*c-a)*p;this.m_points[y].y=q+0.5*(k-(j-o)*p-(q-g)*c-a)*c;}break;case ae.e_faceB:u=d.R;q=n.m_localPlaneNormal;p=u.col1.x*q.x+u.col2.x*q.y;
c=u.col1.y*q.x+u.col2.y*q.y;u=d.R;q=n.m_localPoint;o=d.position.x+u.col1.x*q.x+u.col2.x*q.y;g=d.position.y+u.col1.y*q.x+u.col2.y*q.y;this.m_normal.x=-p;
this.m_normal.y=-c;for(y=0;y<n.m_pointCount;y++){u=l.R;q=n.m_points[y].m_localPoint;j=l.position.x+u.col1.x*q.x+u.col2.x*q.y;q=l.position.y+u.col1.y*q.x+u.col2.y*q.y;
this.m_points[y].x=j+0.5*(a-(j-o)*p-(q-g)*c-k)*p;this.m_points[y].y=q+0.5*(a-(j-o)*p-(q-g)*c-k)*c;}}}};az.ClipVertex=function(){this.v=new ao;this.id=new P;
};az.prototype.Set=function(a){this.v.SetV(a.v);this.id.Set(a.id);};ay.Features=function(){};Object.defineProperty(ay.prototype,"referenceEdge",{enumerable:false,configurable:true,get:function(){return this._referenceEdge;
}});Object.defineProperty(ay.prototype,"referenceEdge",{enumerable:false,configurable:true,set:function(a){if(a===undefined){a=0;}this._referenceEdge=a;
this._m_id._key=this._m_id._key&4294967040|this._referenceEdge&255;}});Object.defineProperty(ay.prototype,"incidentEdge",{enumerable:false,configurable:true,get:function(){return this._incidentEdge;
}});Object.defineProperty(ay.prototype,"incidentEdge",{enumerable:false,configurable:true,set:function(a){if(a===undefined){a=0;}this._incidentEdge=a;this._m_id._key=this._m_id._key&4294902015|this._incidentEdge<<8&65280;
}});Object.defineProperty(ay.prototype,"incidentVertex",{enumerable:false,configurable:true,get:function(){return this._incidentVertex;}});Object.defineProperty(ay.prototype,"incidentVertex",{enumerable:false,configurable:true,set:function(a){if(a===undefined){a=0;
}this._incidentVertex=a;this._m_id._key=this._m_id._key&4278255615|this._incidentVertex<<16&16711680;}});Object.defineProperty(ay.prototype,"flip",{enumerable:false,configurable:true,get:function(){return this._flip;
}});Object.defineProperty(ay.prototype,"flip",{enumerable:false,configurable:true,set:function(a){if(a===undefined){a=0;}this._flip=a;this._m_id._key=this._m_id._key&16777215|this._flip<<24&4278190080;
}});})();(function(){var s=Box2D.Common.b2Settings,r=Box2D.Collision.Shapes.b2CircleShape,n=Box2D.Collision.Shapes.b2EdgeChainDef,m=Box2D.Collision.Shapes.b2EdgeShape,q=Box2D.Collision.Shapes.b2MassData,d=Box2D.Collision.Shapes.b2PolygonShape,g=Box2D.Collision.Shapes.b2Shape,c=Box2D.Common.Math.b2Mat22,b=Box2D.Common.Math.b2Math,j=Box2D.Common.Math.b2Transform,f=Box2D.Common.Math.b2Vec2,k=Box2D.Collision.b2Distance,l=Box2D.Collision.b2DistanceInput,o=Box2D.Collision.b2DistanceOutput,e=Box2D.Collision.b2DistanceProxy,a=Box2D.Collision.b2SimplexCache;
Box2D.inherit(r,Box2D.Collision.Shapes.b2Shape);r.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;r.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);
this.m_p=new f;};r.prototype.Copy=function(){var p=new r;p.Set(this);return p;};r.prototype.Set=function(p){this.__super.Set.call(this,p);if(Box2D.is(p,r)){this.m_p.SetV((p instanceof r?p:null).m_p);
}};r.prototype.TestPoint=function(p,x){var t=p.R,v=p.position.x+(t.col1.x*this.m_p.x+t.col2.x*this.m_p.y);t=p.position.y+(t.col1.y*this.m_p.x+t.col2.y*this.m_p.y);
v=x.x-v;t=x.y-t;return v*v+t*t<=this.m_radius*this.m_radius;};r.prototype.RayCast=function(t,A,C){var p=C.R,B=A.p1.x-(C.position.x+(p.col1.x*this.m_p.x+p.col2.x*this.m_p.y));
C=A.p1.y-(C.position.y+(p.col1.y*this.m_p.x+p.col2.y*this.m_p.y));p=A.p2.x-A.p1.x;var x=A.p2.y-A.p1.y,F=B*p+C*x,v=p*p+x*x,y=F*F-v*(B*B+C*C-this.m_radius*this.m_radius);
if(y<0||v<Number.MIN_VALUE){return false;}F=-(F+Math.sqrt(y));if(0<=F&&F<=A.maxFraction*v){F/=v;t.fraction=F;t.normal.x=B+F*p;t.normal.y=C+F*x;t.normal.Normalize();
return true;}return false;};r.prototype.ComputeAABB=function(p,x){var t=x.R,v=x.position.x+(t.col1.x*this.m_p.x+t.col2.x*this.m_p.y);t=x.position.y+(t.col1.y*this.m_p.x+t.col2.y*this.m_p.y);
p.lowerBound.Set(v-this.m_radius,t-this.m_radius);p.upperBound.Set(v+this.m_radius,t+this.m_radius);};r.prototype.ComputeMass=function(p,t){if(t===undefined){t=0;
}p.mass=t*s.b2_pi*this.m_radius*this.m_radius;p.center.SetV(this.m_p);p.I=p.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y));
};r.prototype.ComputeSubmergedArea=function(p,A,t,y){if(A===undefined){A=0;}t=b.MulX(t,this.m_p);var v=-(b.Dot(p,t)-A);if(v<-this.m_radius+Number.MIN_VALUE){return 0;
}if(v>this.m_radius){y.SetV(t);return Math.PI*this.m_radius*this.m_radius;}A=this.m_radius*this.m_radius;var x=v*v;v=A*(Math.asin(v/this.m_radius)+Math.PI/2)+v*Math.sqrt(A-x);
A=-2/3*Math.pow(A-x,1.5)/v;y.x=t.x+p.x*A;y.y=t.y+p.y*A;return v;};r.prototype.GetLocalPosition=function(){return this.m_p;};r.prototype.SetLocalPosition=function(p){this.m_p.SetV(p);
};r.prototype.GetRadius=function(){return this.m_radius;};r.prototype.SetRadius=function(p){if(p===undefined){p=0;}this.m_radius=p;};r.prototype.b2CircleShape=function(p){if(p===undefined){p=0;
}this.__super.b2Shape.call(this);this.m_type=g.e_circleShape;this.m_radius=p;};n.b2EdgeChainDef=function(){};n.prototype.b2EdgeChainDef=function(){this.vertexCount=0;
this.isALoop=true;this.vertices=[];};Box2D.inherit(m,Box2D.Collision.Shapes.b2Shape);m.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;m.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);
this.s_supportVec=new f;this.m_v1=new f;this.m_v2=new f;this.m_coreV1=new f;this.m_coreV2=new f;this.m_normal=new f;this.m_direction=new f;this.m_cornerDir1=new f;
this.m_cornerDir2=new f;};m.prototype.TestPoint=function(){return false;};m.prototype.RayCast=function(v,C,G){var t,F=C.p2.x-C.p1.x,A=C.p2.y-C.p1.y;t=G.R;
var I=G.position.x+(t.col1.x*this.m_v1.x+t.col2.x*this.m_v1.y),y=G.position.y+(t.col1.y*this.m_v1.x+t.col2.y*this.m_v1.y),B=G.position.y+(t.col1.y*this.m_v2.x+t.col2.y*this.m_v2.y)-y;
G=-(G.position.x+(t.col1.x*this.m_v2.x+t.col2.x*this.m_v2.y)-I);t=100*Number.MIN_VALUE;var x=-(F*B+A*G);if(x>t){I=C.p1.x-I;var p=C.p1.y-y;y=I*B+p*G;if(0<=y&&y<=C.maxFraction*x){C=-F*p+A*I;
if(-t*x<=C&&C<=x*(1+t)){y/=x;v.fraction=y;C=Math.sqrt(B*B+G*G);v.normal.x=B/C;v.normal.y=G/C;return true;}}}return false;};m.prototype.ComputeAABB=function(p,A){var t=A.R,y=A.position.x+(t.col1.x*this.m_v1.x+t.col2.x*this.m_v1.y),v=A.position.y+(t.col1.y*this.m_v1.x+t.col2.y*this.m_v1.y),x=A.position.x+(t.col1.x*this.m_v2.x+t.col2.x*this.m_v2.y);
t=A.position.y+(t.col1.y*this.m_v2.x+t.col2.y*this.m_v2.y);if(y<x){p.lowerBound.x=y;p.upperBound.x=x;}else{p.lowerBound.x=x;p.upperBound.x=y;}if(v<t){p.lowerBound.y=v;
p.upperBound.y=t;}else{p.lowerBound.y=t;p.upperBound.y=v;}};m.prototype.ComputeMass=function(p){p.mass=0;p.center.SetV(this.m_v1);p.I=0;};m.prototype.ComputeSubmergedArea=function(p,B,t,A){if(B===undefined){B=0;
}var v=new f(p.x*B,p.y*B),y=b.MulX(t,this.m_v1);t=b.MulX(t,this.m_v2);var x=b.Dot(p,y)-B;p=b.Dot(p,t)-B;if(x>0){if(p>0){return 0;}else{y.x=-p/(x-p)*y.x+x/(x-p)*t.x;
y.y=-p/(x-p)*y.y+x/(x-p)*t.y;}}else{if(p>0){t.x=-p/(x-p)*y.x+x/(x-p)*t.x;t.y=-p/(x-p)*y.y+x/(x-p)*t.y;}}A.x=(v.x+y.x+t.x)/3;A.y=(v.y+y.y+t.y)/3;return 0.5*((y.x-v.x)*(t.y-v.y)-(y.y-v.y)*(t.x-v.x));
};m.prototype.GetLength=function(){return this.m_length;};m.prototype.GetVertex1=function(){return this.m_v1;};m.prototype.GetVertex2=function(){return this.m_v2;
};m.prototype.GetCoreVertex1=function(){return this.m_coreV1;};m.prototype.GetCoreVertex2=function(){return this.m_coreV2;};m.prototype.GetNormalVector=function(){return this.m_normal;
};m.prototype.GetDirectionVector=function(){return this.m_direction;};m.prototype.GetCorner1Vector=function(){return this.m_cornerDir1;};m.prototype.GetCorner2Vector=function(){return this.m_cornerDir2;
};m.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1;};m.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2;};m.prototype.GetFirstVertex=function(p){var t=p.R;
return new f(p.position.x+(t.col1.x*this.m_coreV1.x+t.col2.x*this.m_coreV1.y),p.position.y+(t.col1.y*this.m_coreV1.x+t.col2.y*this.m_coreV1.y));};m.prototype.GetNextEdge=function(){return this.m_nextEdge;
};m.prototype.GetPrevEdge=function(){return this.m_prevEdge;};m.prototype.Support=function(p,B,t){if(B===undefined){B=0;}if(t===undefined){t=0;}var A=p.R,v=p.position.x+(A.col1.x*this.m_coreV1.x+A.col2.x*this.m_coreV1.y),y=p.position.y+(A.col1.y*this.m_coreV1.x+A.col2.y*this.m_coreV1.y),x=p.position.x+(A.col1.x*this.m_coreV2.x+A.col2.x*this.m_coreV2.y);
p=p.position.y+(A.col1.y*this.m_coreV2.x+A.col2.y*this.m_coreV2.y);if(v*B+y*t>x*B+p*t){this.s_supportVec.x=v;this.s_supportVec.y=y;}else{this.s_supportVec.x=x;
this.s_supportVec.y=p;}return this.s_supportVec;};m.prototype.b2EdgeShape=function(p,t){this.__super.b2Shape.call(this);this.m_type=g.e_edgeShape;this.m_nextEdge=this.m_prevEdge=null;
this.m_v1=p;this.m_v2=t;this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.Normalize();this.m_normal.Set(this.m_direction.y,-this.m_direction.x);
this.m_coreV1.Set(-s.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-s.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y);this.m_coreV2.Set(-s.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-s.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);
this.m_cornerDir1=this.m_normal;this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y);};m.prototype.SetPrevEdge=function(p,x,t,v){this.m_prevEdge=p;
this.m_coreV1=x;this.m_cornerDir1=t;this.m_cornerConvex1=v;};m.prototype.SetNextEdge=function(p,x,t,v){this.m_nextEdge=p;this.m_coreV2=x;this.m_cornerDir2=t;
this.m_cornerConvex2=v;};q.b2MassData=function(){this.mass=0;this.center=new f(0,0);this.I=0;};Box2D.inherit(d,Box2D.Collision.Shapes.b2Shape);d.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;
d.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);};d.prototype.Copy=function(){var p=new d;p.Set(this);return p;
};d.prototype.Set=function(p){this.__super.Set.call(this,p);if(Box2D.is(p,d)){p=p instanceof d?p:null;this.m_centroid.SetV(p.m_centroid);this.m_vertexCount=p.m_vertexCount;
this.Reserve(this.m_vertexCount);for(var t=0;t<this.m_vertexCount;t++){this.m_vertices[t].SetV(p.m_vertices[t]);this.m_normals[t].SetV(p.m_normals[t]);
}}};d.prototype.SetAsArray=function(p,y){if(y===undefined){y=0;}var t=new Vector,x=0,v;for(x=0;x<p.length;++x){v=p[x];t.push(v);}this.SetAsVector(t,y);
};d.AsArray=function(p,v){if(v===undefined){v=0;}var t=new d;t.SetAsArray(p,v);return t;};d.prototype.SetAsVector=function(p,y){if(y===undefined){y=0;}if(y==0){y=p.length;
}s.b2Assert(2<=y);this.m_vertexCount=y;this.Reserve(y);var t=0;for(t=0;t<this.m_vertexCount;t++){this.m_vertices[t].SetV(p[t]);}for(t=0;t<this.m_vertexCount;
++t){var x=parseInt(t),v=parseInt(t+1<this.m_vertexCount?t+1:0);x=b.SubtractVV(this.m_vertices[v],this.m_vertices[x]);s.b2Assert(x.LengthSquared()>Number.MIN_VALUE);
this.m_normals[t].SetV(b.CrossVF(x,1));this.m_normals[t].Normalize();}this.m_centroid=d.ComputeCentroid(this.m_vertices,this.m_vertexCount);};d.AsVector=function(p,v){if(v===undefined){v=0;
}var t=new d;t.SetAsVector(p,v);return t;};d.prototype.SetAsBox=function(p,t){if(p===undefined){p=0;}if(t===undefined){t=0;}this.m_vertexCount=4;this.Reserve(4);
this.m_vertices[0].Set(-p,-t);this.m_vertices[1].Set(p,-t);this.m_vertices[2].Set(p,t);this.m_vertices[3].Set(-p,t);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);
this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,0);this.m_centroid.SetZero();};d.AsBox=function(p,v){if(p===undefined){p=0;}if(v===undefined){v=0;}var t=new d;
t.SetAsBox(p,v);return t;};d.prototype.SetAsOrientedBox=function(p,x,t,v){if(p===undefined){p=0;}if(x===undefined){x=0;}if(t===undefined){t=null;}if(v===undefined){v=0;
}this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-p,-x);this.m_vertices[1].Set(p,-x);this.m_vertices[2].Set(p,x);this.m_vertices[3].Set(-p,x);
this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,0);this.m_centroid=t;p=new j;p.position=t;p.R.Set(v);
for(t=0;t<this.m_vertexCount;++t){this.m_vertices[t]=b.MulX(p,this.m_vertices[t]);this.m_normals[t]=b.MulMV(p.R,this.m_normals[t]);}};d.AsOrientedBox=function(p,y,t,x){if(p===undefined){p=0;
}if(y===undefined){y=0;}if(t===undefined){t=null;}if(x===undefined){x=0;}var v=new d;v.SetAsOrientedBox(p,y,t,x);return v;};d.prototype.SetAsEdge=function(p,t){this.m_vertexCount=2;
this.Reserve(2);this.m_vertices[0].SetV(p);this.m_vertices[1].SetV(t);this.m_centroid.x=0.5*(p.x+t.x);this.m_centroid.y=0.5*(p.y+t.y);this.m_normals[0]=b.CrossVF(b.SubtractVV(t,p),1);
this.m_normals[0].Normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y;};d.AsEdge=function(p,v){var t=new d;t.SetAsEdge(p,v);
return t;};d.prototype.TestPoint=function(p,C){var t;t=p.R;for(var B=C.x-p.position.x,v=C.y-p.position.y,A=B*t.col1.x+v*t.col1.y,y=B*t.col2.x+v*t.col2.y,x=0;
x<this.m_vertexCount;++x){t=this.m_vertices[x];B=A-t.x;v=y-t.y;t=this.m_normals[x];if(t.x*B+t.y*v>0){return false;}}return true;};d.prototype.RayCast=function(x,G,J){var t=0,I=G.maxFraction,B=0,K=0,A,C;
B=G.p1.x-J.position.x;K=G.p1.y-J.position.y;A=J.R;var y=B*A.col1.x+K*A.col1.y,p=B*A.col2.x+K*A.col2.y;B=G.p2.x-J.position.x;K=G.p2.y-J.position.y;A=J.R;
G=B*A.col1.x+K*A.col1.y-y;A=B*A.col2.x+K*A.col2.y-p;for(var v=parseInt(-1),F=0;F<this.m_vertexCount;++F){C=this.m_vertices[F];B=C.x-y;K=C.y-p;C=this.m_normals[F];
B=C.x*B+C.y*K;K=C.x*G+C.y*A;if(K==0){if(B<0){return false;}}else{if(K<0&&B<t*K){t=B/K;v=F;}else{if(K>0&&B<I*K){I=B/K;}}}if(I<t-Number.MIN_VALUE){return false;
}}if(v>=0){x.fraction=t;A=J.R;C=this.m_normals[v];x.normal.x=A.col1.x*C.x+A.col2.x*C.y;x.normal.y=A.col1.y*C.x+A.col2.y*C.y;return true;}return false;};
d.prototype.ComputeAABB=function(t,B){for(var F=B.R,p=this.m_vertices[0],C=B.position.x+(F.col1.x*p.x+F.col2.x*p.y),y=B.position.y+(F.col1.y*p.x+F.col2.y*p.y),G=C,x=y,A=1;
A<this.m_vertexCount;++A){p=this.m_vertices[A];var v=B.position.x+(F.col1.x*p.x+F.col2.x*p.y);p=B.position.y+(F.col1.y*p.x+F.col2.y*p.y);C=C<v?C:v;y=y<p?y:p;
G=G>v?G:v;x=x>p?x:p;}t.lowerBound.x=C-this.m_radius;t.lowerBound.y=y-this.m_radius;t.upperBound.x=G+this.m_radius;t.upperBound.y=x+this.m_radius;};d.prototype.ComputeMass=function(y,K){if(K===undefined){K=0;
}if(this.m_vertexCount==2){y.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x);y.center.y=0.5*(this.m_vertices[0].y+this.m_vertices[1].y);y.mass=0;
y.I=0;}else{for(var M=0,t=0,L=0,G=0,P=1/3,C=0;C<this.m_vertexCount;++C){var I=this.m_vertices[C],B=C+1<this.m_vertexCount?this.m_vertices[parseInt(C+1)]:this.m_vertices[0],p=I.x-0,v=I.y-0,J=B.x-0,F=B.y-0,x=p*F-v*J,A=0.5*x;
L+=A;M+=A*P*(0+I.x+B.x);t+=A*P*(0+I.y+B.y);I=p;v=v;J=J;F=F;G+=x*(P*(0.25*(I*I+J*I+J*J)+(0*I+0*J))+0+(P*(0.25*(v*v+F*v+F*F)+(0*v+0*F))+0));}y.mass=K*L;M*=1/L;
t*=1/L;y.center.Set(M,t);y.I=K*G;}};d.prototype.ComputeSubmergedArea=function(v,C,G,t){if(C===undefined){C=0;}var F=b.MulTMV(G.R,v),A=C-b.Dot(v,G.position),I=new Vector_a2j_Number,y=0,B=parseInt(-1);
C=parseInt(-1);var x=false;for(v=v=0;v<this.m_vertexCount;++v){I[v]=b.Dot(F,this.m_vertices[v])-A;var p=I[v]<-Number.MIN_VALUE;if(v>0){if(p){if(!x){B=v-1;
y++;}}else{if(x){C=v-1;y++;}}}x=p;}switch(y){case 0:if(x){v=new q;this.ComputeMass(v,1);t.SetV(b.MulX(G,v.center));return v.mass;}else{return 0;}case 1:if(B==-1){B=this.m_vertexCount-1;
}else{C=this.m_vertexCount-1;}}v=parseInt((B+1)%this.m_vertexCount);F=parseInt((C+1)%this.m_vertexCount);A=(0-I[B])/(I[v]-I[B]);I=(0-I[C])/(I[F]-I[C]);
B=new f(this.m_vertices[B].x*(1-A)+this.m_vertices[v].x*A,this.m_vertices[B].y*(1-A)+this.m_vertices[v].y*A);C=new f(this.m_vertices[C].x*(1-I)+this.m_vertices[F].x*I,this.m_vertices[C].y*(1-I)+this.m_vertices[F].y*I);
I=0;A=new f;y=this.m_vertices[v];for(v=v;v!=F;){v=(v+1)%this.m_vertexCount;x=v==F?C:this.m_vertices[v];p=0.5*((y.x-B.x)*(x.y-B.y)-(y.y-B.y)*(x.x-B.x));
I+=p;A.x+=p*(B.x+y.x+x.x)/3;A.y+=p*(B.y+y.y+x.y)/3;y=x;}A.Multiply(1/I);t.SetV(b.MulX(G,A));return I;};d.prototype.GetVertexCount=function(){return this.m_vertexCount;
};d.prototype.GetVertices=function(){return this.m_vertices;};d.prototype.GetNormals=function(){return this.m_normals;};d.prototype.GetSupport=function(p){for(var y=0,t=this.m_vertices[0].x*p.x+this.m_vertices[0].y*p.y,x=1;
x<this.m_vertexCount;++x){var v=this.m_vertices[x].x*p.x+this.m_vertices[x].y*p.y;if(v>t){y=x;t=v;}}return y;};d.prototype.GetSupportVertex=function(p){for(var y=0,t=this.m_vertices[0].x*p.x+this.m_vertices[0].y*p.y,x=1;
x<this.m_vertexCount;++x){var v=this.m_vertices[x].x*p.x+this.m_vertices[x].y*p.y;if(v>t){y=x;t=v;}}return this.m_vertices[y];};d.prototype.Validate=function(){return false;
};d.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this);this.m_type=g.e_polygonShape;this.m_centroid=new f;this.m_vertices=new Vector;this.m_normals=new Vector;
};d.prototype.Reserve=function(p){if(p===undefined){p=0;}for(var t=parseInt(this.m_vertices.length);t<p;t++){this.m_vertices[t]=new f;this.m_normals[t]=new f;
}};d.ComputeCentroid=function(t,A){if(A===undefined){A=0;}for(var C=new f,p=0,B=1/3,x=0;x<A;++x){var F=t[x],v=x+1<A?t[parseInt(x+1)]:t[0],y=0.5*((F.x-0)*(v.y-0)-(F.y-0)*(v.x-0));
p+=y;C.x+=y*B*(0+F.x+v.x);C.y+=y*B*(0+F.y+v.y);}C.x*=1/p;C.y*=1/p;return C;};d.ComputeOBB=function(L,A,C){if(C===undefined){C=0;}var G=0,B=new Vector(C+1);
for(G=0;G<C;++G){B[G]=A[G];}B[C]=B[0];A=Number.MAX_VALUE;for(G=1;G<=C;++G){var x=B[parseInt(G-1)],F=B[G].x-x.x,v=B[G].y-x.y,y=Math.sqrt(F*F+v*v);F/=y;v/=y;
for(var t=-v,T=F,p=y=Number.MAX_VALUE,Q=-Number.MAX_VALUE,P=-Number.MAX_VALUE,K=0;K<C;++K){var M=B[K].x-x.x,J=B[K].y-x.y,I=F*M+v*J;M=t*M+T*J;if(I<y){y=I;
}if(M<p){p=M;}if(I>Q){Q=I;}if(M>P){P=M;}}K=(Q-y)*(P-p);if(K<0.95*A){A=K;L.R.col1.x=F;L.R.col1.y=v;L.R.col2.x=t;L.R.col2.y=T;F=0.5*(y+Q);v=0.5*(p+P);t=L.R;
L.center.x=x.x+(t.col1.x*F+t.col2.x*v);L.center.y=x.y+(t.col1.y*F+t.col2.y*v);L.extents.x=0.5*(Q-y);L.extents.y=0.5*(P-p);}}};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new c;
});g.b2Shape=function(){};g.prototype.Copy=function(){return null;};g.prototype.Set=function(p){this.m_radius=p.m_radius;};g.prototype.GetType=function(){return this.m_type;
};g.prototype.TestPoint=function(){return false;};g.prototype.RayCast=function(){return false;};g.prototype.ComputeAABB=function(){};g.prototype.ComputeMass=function(){};
g.prototype.ComputeSubmergedArea=function(){return 0;};g.TestOverlap=function(p,y,t,x){var v=new l;v.proxyA=new e;v.proxyA.Set(p);v.proxyB=new e;v.proxyB.Set(t);
v.transformA=y;v.transformB=x;v.useRadii=true;p=new a;p.count=0;y=new o;k.Distance(y,p,v);return y.distance<10*Number.MIN_VALUE;};g.prototype.b2Shape=function(){this.m_type=g.e_unknownShape;
this.m_radius=s.b2_linearSlop;};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1);Box2D.Collision.Shapes.b2Shape.e_circleShape=0;
Box2D.Collision.Shapes.b2Shape.e_polygonShape=1;Box2D.Collision.Shapes.b2Shape.e_edgeShape=2;Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3;Box2D.Collision.Shapes.b2Shape.e_hitCollide=1;
Box2D.Collision.Shapes.b2Shape.e_missCollide=0;Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1);});})();(function(){var c=Box2D.Common.b2Color,b=Box2D.Common.b2Settings,a=Box2D.Common.Math.b2Math;
c.b2Color=function(){this._b=this._g=this._r=0;};c.prototype.b2Color=function(f,e,d){if(f===undefined){f=0;}if(e===undefined){e=0;}if(d===undefined){d=0;
}this._r=Box2D.parseUInt(255*a.Clamp(f,0,1));this._g=Box2D.parseUInt(255*a.Clamp(e,0,1));this._b=Box2D.parseUInt(255*a.Clamp(d,0,1));};c.prototype.Set=function(f,e,d){if(f===undefined){f=0;
}if(e===undefined){e=0;}if(d===undefined){d=0;}this._r=Box2D.parseUInt(255*a.Clamp(f,0,1));this._g=Box2D.parseUInt(255*a.Clamp(e,0,1));this._b=Box2D.parseUInt(255*a.Clamp(d,0,1));
};Object.defineProperty(c.prototype,"r",{enumerable:false,configurable:true,set:function(d){if(d===undefined){d=0;}this._r=Box2D.parseUInt(255*a.Clamp(d,0,1));
}});Object.defineProperty(c.prototype,"g",{enumerable:false,configurable:true,set:function(d){if(d===undefined){d=0;}this._g=Box2D.parseUInt(255*a.Clamp(d,0,1));
}});Object.defineProperty(c.prototype,"b",{enumerable:false,configurable:true,set:function(d){if(d===undefined){d=0;}this._b=Box2D.parseUInt(255*a.Clamp(d,0,1));
}});Object.defineProperty(c.prototype,"color",{enumerable:false,configurable:true,get:function(){return this._r<<16|this._g<<8|this._b;}});b.b2Settings=function(){};
b.b2MixFriction=function(e,d){if(e===undefined){e=0;}if(d===undefined){d=0;}return Math.sqrt(e*d);};b.b2MixRestitution=function(e,d){if(e===undefined){e=0;
}if(d===undefined){d=0;}return e>d?e:d;};b.b2Assert=function(d){if(!d){throw"Assertion Failed";}};Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha";
Box2D.Common.b2Settings.USHRT_MAX=65535;Box2D.Common.b2Settings.b2_pi=Math.PI;Box2D.Common.b2Settings.b2_maxManifoldPoints=2;Box2D.Common.b2Settings.b2_aabbExtension=0.1;
Box2D.Common.b2Settings.b2_aabbMultiplier=2;Box2D.Common.b2Settings.b2_polygonRadius=2*b.b2_linearSlop;Box2D.Common.b2Settings.b2_linearSlop=0.005;Box2D.Common.b2Settings.b2_angularSlop=2/180*b.b2_pi;
Box2D.Common.b2Settings.b2_toiSlop=8*b.b2_linearSlop;Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32;Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32;
Box2D.Common.b2Settings.b2_velocityThreshold=1;Box2D.Common.b2Settings.b2_maxLinearCorrection=0.2;Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*b.b2_pi;
Box2D.Common.b2Settings.b2_maxTranslation=2;Box2D.Common.b2Settings.b2_maxTranslationSquared=b.b2_maxTranslation*b.b2_maxTranslation;Box2D.Common.b2Settings.b2_maxRotation=0.5*b.b2_pi;
Box2D.Common.b2Settings.b2_maxRotationSquared=b.b2_maxRotation*b.b2_maxRotation;Box2D.Common.b2Settings.b2_contactBaumgarte=0.2;Box2D.Common.b2Settings.b2_timeToSleep=0.5;
Box2D.Common.b2Settings.b2_linearSleepTolerance=0.01;Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*b.b2_pi;});})();(function(){var f=Box2D.Common.Math.b2Mat22,e=Box2D.Common.Math.b2Mat33,c=Box2D.Common.Math.b2Math,g=Box2D.Common.Math.b2Sweep,b=Box2D.Common.Math.b2Transform,a=Box2D.Common.Math.b2Vec2,d=Box2D.Common.Math.b2Vec3;
f.b2Mat22=function(){this.col1=new a;this.col2=new a;};f.prototype.b2Mat22=function(){this.SetIdentity();};f.FromAngle=function(j){if(j===undefined){j=0;
}var k=new f;k.Set(j);return k;};f.FromVV=function(k,l){var j=new f;j.SetVV(k,l);return j;};f.prototype.Set=function(j){if(j===undefined){j=0;}var k=Math.cos(j);
j=Math.sin(j);this.col1.x=k;this.col2.x=-j;this.col1.y=j;this.col2.y=k;};f.prototype.SetVV=function(j,k){this.col1.SetV(j);this.col2.SetV(k);};f.prototype.Copy=function(){var j=new f;
j.SetM(this);return j;};f.prototype.SetM=function(j){this.col1.SetV(j.col1);this.col2.SetV(j.col2);};f.prototype.AddM=function(j){this.col1.x+=j.col1.x;
this.col1.y+=j.col1.y;this.col2.x+=j.col2.x;this.col2.y+=j.col2.y;};f.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1;
};f.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0;};f.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x);
};f.prototype.GetInverse=function(m){var o=this.col1.x,l=this.col2.x,k=this.col1.y,n=this.col2.y,j=o*n-l*k;if(j!=0){j=1/j;}m.col1.x=j*n;m.col2.x=-j*l;m.col1.y=-j*k;
m.col2.y=j*o;return m;};f.prototype.Solve=function(o,r,n){if(r===undefined){r=0;}if(n===undefined){n=0;}var l=this.col1.x,q=this.col2.x,k=this.col1.y,m=this.col2.y,j=l*m-q*k;
if(j!=0){j=1/j;}o.x=j*(m*r-q*n);o.y=j*(l*n-k*r);return o;};f.prototype.Abs=function(){this.col1.Abs();this.col2.Abs();};e.b2Mat33=function(){this.col1=new d;
this.col2=new d;this.col3=new d;};e.prototype.b2Mat33=function(k,l,j){if(k===undefined){k=null;}if(l===undefined){l=null;}if(j===undefined){j=null;}if(!k&&!l&&!j){this.col1.SetZero();
this.col2.SetZero();this.col3.SetZero();}else{this.col1.SetV(k);this.col2.SetV(l);this.col3.SetV(j);}};e.prototype.SetVVV=function(k,l,j){this.col1.SetV(k);
this.col2.SetV(l);this.col3.SetV(j);};e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3);};e.prototype.SetM=function(j){this.col1.SetV(j.col1);
this.col2.SetV(j.col2);this.col3.SetV(j.col3);};e.prototype.AddM=function(j){this.col1.x+=j.col1.x;this.col1.y+=j.col1.y;this.col1.z+=j.col1.z;this.col2.x+=j.col2.x;
this.col2.y+=j.col2.y;this.col2.z+=j.col2.z;this.col3.x+=j.col3.x;this.col3.y+=j.col3.y;this.col3.z+=j.col3.z;};e.prototype.SetIdentity=function(){this.col1.x=1;
this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=1;};e.prototype.SetZero=function(){this.col1.x=0;
this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0;};e.prototype.Solve22=function(o,r,n){if(r===undefined){r=0;
}if(n===undefined){n=0;}var l=this.col1.x,q=this.col2.x,k=this.col1.y,m=this.col2.y,j=l*m-q*k;if(j!=0){j=1/j;}o.x=j*(m*r-q*n);o.y=j*(l*n-k*r);return o;
};e.prototype.Solve33=function(n,m,s,q){if(m===undefined){m=0;}if(s===undefined){s=0;}if(q===undefined){q=0;}var t=this.col1.x,x=this.col1.y,y=this.col1.z,o=this.col2.x,l=this.col2.y,r=this.col2.z,v=this.col3.x,C=this.col3.y,j=this.col3.z,A=t*(l*j-r*C)+x*(r*v-o*j)+y*(o*C-l*v);
if(A!=0){A=1/A;}n.x=A*(m*(l*j-r*C)+s*(r*v-o*j)+q*(o*C-l*v));n.y=A*(t*(s*j-q*C)+x*(q*v-m*j)+y*(m*C-s*v));n.z=A*(t*(l*q-r*s)+x*(r*m-o*q)+y*(o*s-l*m));return n;
};c.b2Math=function(){};c.IsValid=function(j){if(j===undefined){j=0;}return isFinite(j);};c.Dot=function(j,k){return j.x*k.x+j.y*k.y;};c.CrossVV=function(j,k){return j.x*k.y-j.y*k.x;
};c.CrossVF=function(j,k){if(k===undefined){k=0;}return new a(k*j.y,-k*j.x);};c.CrossFV=function(j,k){if(j===undefined){j=0;}return new a(-j*k.y,j*k.x);
};c.MulMV=function(j,k){return new a(j.col1.x*k.x+j.col2.x*k.y,j.col1.y*k.x+j.col2.y*k.y);};c.MulTMV=function(j,k){return new a(c.Dot(k,j.col1),c.Dot(k,j.col2));
};c.MulX=function(k,l){var j=c.MulMV(k.R,l);j.x+=k.position.x;j.y+=k.position.y;return j;};c.MulXT=function(l,m){var k=c.SubtractVV(m,l.position),j=k.x*l.R.col1.x+k.y*l.R.col1.y;
k.y=k.x*l.R.col2.x+k.y*l.R.col2.y;k.x=j;return k;};c.AddVV=function(j,k){return new a(j.x+k.x,j.y+k.y);};c.SubtractVV=function(j,k){return new a(j.x-k.x,j.y-k.y);
};c.Distance=function(l,m){var k=l.x-m.x,j=l.y-m.y;return Math.sqrt(k*k+j*j);};c.DistanceSquared=function(l,m){var k=l.x-m.x,j=l.y-m.y;return k*k+j*j;};
c.MulFV=function(j,k){if(j===undefined){j=0;}return new a(j*k.x,j*k.y);};c.AddMM=function(j,k){return f.FromVV(c.AddVV(j.col1,k.col1),c.AddVV(j.col2,k.col2));
};c.MulMM=function(j,k){return f.FromVV(c.MulMV(j,k.col1),c.MulMV(j,k.col2));};c.MulTMM=function(l,m){var k=new a(c.Dot(l.col1,m.col1),c.Dot(l.col2,m.col1)),j=new a(c.Dot(l.col1,m.col2),c.Dot(l.col2,m.col2));
return f.FromVV(k,j);};c.Abs=function(j){if(j===undefined){j=0;}return j>0?j:-j;};c.AbsV=function(j){return new a(c.Abs(j.x),c.Abs(j.y));};c.AbsM=function(j){return f.FromVV(c.AbsV(j.col1),c.AbsV(j.col2));
};c.Min=function(j,k){if(j===undefined){j=0;}if(k===undefined){k=0;}return j<k?j:k;};c.MinV=function(j,k){return new a(c.Min(j.x,k.x),c.Min(j.y,k.y));};
c.Max=function(j,k){if(j===undefined){j=0;}if(k===undefined){k=0;}return j>k?j:k;};c.MaxV=function(j,k){return new a(c.Max(j.x,k.x),c.Max(j.y,k.y));};c.Clamp=function(k,l,j){if(k===undefined){k=0;
}if(l===undefined){l=0;}if(j===undefined){j=0;}return k<l?l:k>j?j:k;};c.ClampV=function(k,l,j){return c.MaxV(l,c.MinV(k,j));};c.Swap=function(k,l){var j=k[0];
k[0]=l[0];l[0]=j;};c.Random=function(){return Math.random()*2-1;};c.RandomRange=function(k,l){if(k===undefined){k=0;}if(l===undefined){l=0;}var j=Math.random();
return j=(l-k)*j+k;};c.NextPowerOfTwo=function(j){if(j===undefined){j=0;}j|=j>>1&2147483647;j|=j>>2&1073741823;j|=j>>4&268435455;j|=j>>8&16777215;j|=j>>16&65535;
return j+1;};c.IsPowerOfTwo=function(j){if(j===undefined){j=0;}return j>0&&(j&j-1)==0;};Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new a(0,0);
Box2D.Common.Math.b2Math.b2Mat22_identity=f.FromVV(new a(1,0),new a(0,1));Box2D.Common.Math.b2Math.b2Transform_identity=new b(c.b2Vec2_zero,c.b2Mat22_identity);
});g.b2Sweep=function(){this.localCenter=new a;this.c0=new a;this.c=new a;};g.prototype.Set=function(j){this.localCenter.SetV(j.localCenter);this.c0.SetV(j.c0);
this.c.SetV(j.c);this.a0=j.a0;this.a=j.a;this.t0=j.t0;};g.prototype.Copy=function(){var j=new g;j.localCenter.SetV(this.localCenter);j.c0.SetV(this.c0);
j.c.SetV(this.c);j.a0=this.a0;j.a=this.a;j.t0=this.t0;return j;};g.prototype.GetTransform=function(k,l){if(l===undefined){l=0;}k.position.x=(1-l)*this.c0.x+l*this.c.x;
k.position.y=(1-l)*this.c0.y+l*this.c.y;k.R.Set((1-l)*this.a0+l*this.a);var j=k.R;k.position.x-=j.col1.x*this.localCenter.x+j.col2.x*this.localCenter.y;
k.position.y-=j.col1.y*this.localCenter.x+j.col2.y*this.localCenter.y;};g.prototype.Advance=function(j){if(j===undefined){j=0;}if(this.t0<j&&1-this.t0>Number.MIN_VALUE){var k=(j-this.t0)/(1-this.t0);
this.c0.x=(1-k)*this.c0.x+k*this.c.x;this.c0.y=(1-k)*this.c0.y+k*this.c.y;this.a0=(1-k)*this.a0+k*this.a;this.t0=j;}};b.b2Transform=function(){this.position=new a;
this.R=new f;};b.prototype.b2Transform=function(j,k){if(j===undefined){j=null;}if(k===undefined){k=null;}if(j){this.position.SetV(j);this.R.SetM(k);}};
b.prototype.Initialize=function(j,k){this.position.SetV(j);this.R.SetM(k);};b.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity();
};b.prototype.Set=function(j){this.position.SetV(j.position);this.R.SetM(j.R);};b.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x);
};a.b2Vec2=function(){};a.prototype.b2Vec2=function(j,k){if(j===undefined){j=0;}if(k===undefined){k=0;}this.x=j;this.y=k;};a.prototype.SetZero=function(){this.y=this.x=0;
};a.prototype.Set=function(j,k){if(j===undefined){j=0;}if(k===undefined){k=0;}this.x=j;this.y=k;};a.prototype.SetV=function(j){this.x=j.x;this.y=j.y;};
a.prototype.GetNegative=function(){return new a(-this.x,-this.y);};a.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y;};a.Make=function(j,k){if(j===undefined){j=0;
}if(k===undefined){k=0;}return new a(j,k);};a.prototype.Copy=function(){return new a(this.x,this.y);};a.prototype.Add=function(j){this.x+=j.x;this.y+=j.y;
};a.prototype.Subtract=function(j){this.x-=j.x;this.y-=j.y;};a.prototype.Multiply=function(j){if(j===undefined){j=0;}this.x*=j;this.y*=j;};a.prototype.MulM=function(j){var k=this.x;
this.x=j.col1.x*k+j.col2.x*this.y;this.y=j.col1.y*k+j.col2.y*this.y;};a.prototype.MulTM=function(j){var k=c.Dot(this,j.col1);this.y=c.Dot(this,j.col2);
this.x=k;};a.prototype.CrossVF=function(j){if(j===undefined){j=0;}var k=this.x;this.x=j*this.y;this.y=-j*k;};a.prototype.CrossFV=function(j){if(j===undefined){j=0;
}var k=this.x;this.x=-j*this.y;this.y=j*k;};a.prototype.MinV=function(j){this.x=this.x<j.x?this.x:j.x;this.y=this.y<j.y?this.y:j.y;};a.prototype.MaxV=function(j){this.x=this.x>j.x?this.x:j.x;
this.y=this.y>j.y?this.y:j.y;};a.prototype.Abs=function(){if(this.x<0){this.x=-this.x;}if(this.y<0){this.y=-this.y;}};a.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y);
};a.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y;};a.prototype.Normalize=function(){var j=Math.sqrt(this.x*this.x+this.y*this.y);
if(j<Number.MIN_VALUE){return 0;}var k=1/j;this.x*=k;this.y*=k;return j;};a.prototype.IsValid=function(){return c.IsValid(this.x)&&c.IsValid(this.y);};
d.b2Vec3=function(){};d.prototype.b2Vec3=function(k,l,j){if(k===undefined){k=0;}if(l===undefined){l=0;}if(j===undefined){j=0;}this.x=k;this.y=l;this.z=j;
};d.prototype.SetZero=function(){this.x=this.y=this.z=0;};d.prototype.Set=function(k,l,j){if(k===undefined){k=0;}if(l===undefined){l=0;}if(j===undefined){j=0;
}this.x=k;this.y=l;this.z=j;};d.prototype.SetV=function(j){this.x=j.x;this.y=j.y;this.z=j.z;};d.prototype.GetNegative=function(){return new d(-this.x,-this.y,-this.z);
};d.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;};d.prototype.Copy=function(){return new d(this.x,this.y,this.z);};d.prototype.Add=function(j){this.x+=j.x;
this.y+=j.y;this.z+=j.z;};d.prototype.Subtract=function(j){this.x-=j.x;this.y-=j.y;this.z-=j.z;};d.prototype.Multiply=function(j){if(j===undefined){j=0;
}this.x*=j;this.y*=j;this.z*=j;};})();(function(){var ae=Box2D.Common.Math.b2Math,ac=Box2D.Common.Math.b2Sweep,J=Box2D.Common.Math.b2Transform,P=Box2D.Common.Math.b2Vec2,ab=Box2D.Common.b2Color,aj=Box2D.Common.b2Settings,f=Box2D.Collision.b2AABB,ak=Box2D.Collision.b2ContactPoint,ai=Box2D.Collision.b2DynamicTreeBroadPhase,r=Box2D.Collision.b2RayCastInput,e=Box2D.Collision.b2RayCastOutput,v=Box2D.Collision.Shapes.b2CircleShape,x=Box2D.Collision.Shapes.b2EdgeShape,T=Box2D.Collision.Shapes.b2MassData,c=Box2D.Collision.Shapes.b2PolygonShape,b=Box2D.Collision.Shapes.b2Shape,ao=Box2D.Dynamics.b2Body,C=Box2D.Dynamics.b2BodyDef,ad=Box2D.Dynamics.b2ContactFilter,ag=Box2D.Dynamics.b2ContactImpulse,X=Box2D.Dynamics.b2ContactListener,s=Box2D.Dynamics.b2ContactManager,af=Box2D.Dynamics.b2DebugDraw,m=Box2D.Dynamics.b2DestructionListener,t=Box2D.Dynamics.b2FilterData,g=Box2D.Dynamics.b2Fixture,at=Box2D.Dynamics.b2FixtureDef,a=Box2D.Dynamics.b2Island,ar=Box2D.Dynamics.b2TimeStep,aq=Box2D.Dynamics.b2World,an=Box2D.Dynamics.Contacts.b2Contact,ap=Box2D.Dynamics.Contacts.b2ContactFactory,al=Box2D.Dynamics.Contacts.b2ContactSolver,ah=Box2D.Dynamics.Joints.b2Joint,am=Box2D.Dynamics.Joints.b2PulleyJoint;
ao.b2Body=function(){this.m_xf=new J;this.m_sweep=new ac;this.m_linearVelocity=new P;this.m_force=new P;};ao.prototype.connectEdges=function(j,o,k){if(k===undefined){k=0;
}var d=Math.atan2(o.GetDirectionVector().y,o.GetDirectionVector().x);k=ae.MulFV(Math.tan((d-k)*0.5),o.GetDirectionVector());k=ae.SubtractVV(k,o.GetNormalVector());
k=ae.MulFV(aj.b2_toiSlop,k);k=ae.AddVV(k,o.GetVertex1());var n=ae.AddVV(j.GetDirectionVector(),o.GetDirectionVector());n.Normalize();var l=ae.Dot(j.GetDirectionVector(),o.GetNormalVector())>0;
j.SetNextEdge(o,k,n,l);o.SetPrevEdge(j,k,n,l);return d;};ao.prototype.CreateFixture=function(d){if(this.m_world.IsLocked()==true){return null;}var j=new g;
j.Create(this,this.m_xf,d);this.m_flags&ao.e_activeFlag&&j.CreateProxy(this.m_world.m_contactManager.m_broadPhase,this.m_xf);j.m_next=this.m_fixtureList;
this.m_fixtureList=j;++this.m_fixtureCount;j.m_body=this;j.m_density>0&&this.ResetMassData();this.m_world.m_flags|=aq.e_newFixture;return j;};ao.prototype.CreateFixture2=function(d,k){if(k===undefined){k=0;
}var j=new at;j.shape=d;j.density=k;return this.CreateFixture(j);};ao.prototype.DestroyFixture=function(j){if(this.m_world.IsLocked()!=true){for(var n=this.m_fixtureList,k=null;
n!=null;){if(n==j){if(k){k.m_next=j.m_next;}else{this.m_fixtureList=j.m_next;}break;}k=n;n=n.m_next;}for(n=this.m_contactList;n;){k=n.contact;n=n.next;
var d=k.GetFixtureA(),l=k.GetFixtureB();if(j==d||j==l){this.m_world.m_contactManager.Destroy(k);}}this.m_flags&ao.e_activeFlag&&j.DestroyProxy(this.m_world.m_contactManager.m_broadPhase);
j.Destroy();j.m_body=null;j.m_next=null;--this.m_fixtureCount;this.ResetMassData();}};ao.prototype.SetPositionAndAngle=function(j,l){if(l===undefined){l=0;
}var k;if(this.m_world.IsLocked()!=true){this.m_xf.R.Set(l);this.m_xf.position.SetV(j);k=this.m_xf.R;var d=this.m_sweep.localCenter;this.m_sweep.c.x=k.col1.x*d.x+k.col2.x*d.y;
this.m_sweep.c.y=k.col1.y*d.x+k.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);
this.m_sweep.a0=this.m_sweep.a=l;d=this.m_world.m_contactManager.m_broadPhase;for(k=this.m_fixtureList;k;k=k.m_next){k.Synchronize(d,this.m_xf,this.m_xf);
}this.m_world.m_contactManager.FindNewContacts();}};ao.prototype.SetTransform=function(d){this.SetPositionAndAngle(d.position,d.GetAngle());};ao.prototype.GetTransform=function(){return this.m_xf;
};ao.prototype.GetPosition=function(){return this.m_xf.position;};ao.prototype.SetPosition=function(d){this.SetPositionAndAngle(d,this.GetAngle());};ao.prototype.GetAngle=function(){return this.m_sweep.a;
};ao.prototype.SetAngle=function(d){if(d===undefined){d=0;}this.SetPositionAndAngle(this.GetPosition(),d);};ao.prototype.GetWorldCenter=function(){return this.m_sweep.c;
};ao.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter;};ao.prototype.SetLinearVelocity=function(d){this.m_type!=ao.b2_staticBody&&this.m_linearVelocity.SetV(d);
};ao.prototype.GetLinearVelocity=function(){return this.m_linearVelocity;};ao.prototype.SetAngularVelocity=function(d){if(d===undefined){d=0;}if(this.m_type!=ao.b2_staticBody){this.m_angularVelocity=d;
}};ao.prototype.GetAngularVelocity=function(){return this.m_angularVelocity;};ao.prototype.GetDefinition=function(){var d=new C;d.type=this.GetType();d.allowSleep=(this.m_flags&ao.e_allowSleepFlag)==ao.e_allowSleepFlag;
d.angle=this.GetAngle();d.angularDamping=this.m_angularDamping;d.angularVelocity=this.m_angularVelocity;d.fixedRotation=(this.m_flags&ao.e_fixedRotationFlag)==ao.e_fixedRotationFlag;
d.bullet=(this.m_flags&ao.e_bulletFlag)==ao.e_bulletFlag;d.awake=(this.m_flags&ao.e_awakeFlag)==ao.e_awakeFlag;d.linearDamping=this.m_linearDamping;d.linearVelocity.SetV(this.GetLinearVelocity());
d.position=this.GetPosition();d.userData=this.GetUserData();return d;};ao.prototype.ApplyForce=function(d,j){if(this.m_type==ao.b2_dynamicBody){this.IsAwake()==false&&this.SetAwake(true);
this.m_force.x+=d.x;this.m_force.y+=d.y;this.m_torque+=(j.x-this.m_sweep.c.x)*d.y-(j.y-this.m_sweep.c.y)*d.x;}};ao.prototype.ApplyTorque=function(d){if(d===undefined){d=0;
}if(this.m_type==ao.b2_dynamicBody){this.IsAwake()==false&&this.SetAwake(true);this.m_torque+=d;}};ao.prototype.ApplyImpulse=function(d,j){if(this.m_type==ao.b2_dynamicBody){this.IsAwake()==false&&this.SetAwake(true);
this.m_linearVelocity.x+=this.m_invMass*d.x;this.m_linearVelocity.y+=this.m_invMass*d.y;this.m_angularVelocity+=this.m_invI*((j.x-this.m_sweep.c.x)*d.y-(j.y-this.m_sweep.c.y)*d.x);
}};ao.prototype.Split=function(k){for(var q=this.GetLinearVelocity().Copy(),n=this.GetAngularVelocity(),j=this.GetWorldCenter(),p=this.m_world.CreateBody(this.GetDefinition()),o,d=this.m_fixtureList;
d;){if(k(d)){var l=d.m_next;if(o){o.m_next=l;}else{this.m_fixtureList=l;}this.m_fixtureCount--;d.m_next=p.m_fixtureList;p.m_fixtureList=d;p.m_fixtureCount++;
d.m_body=p;d=l;}else{o=d;d=d.m_next;}}this.ResetMassData();p.ResetMassData();o=this.GetWorldCenter();k=p.GetWorldCenter();o=ae.AddVV(q,ae.CrossFV(n,ae.SubtractVV(o,j)));
q=ae.AddVV(q,ae.CrossFV(n,ae.SubtractVV(k,j)));this.SetLinearVelocity(o);p.SetLinearVelocity(q);this.SetAngularVelocity(n);p.SetAngularVelocity(n);this.SynchronizeFixtures();
p.SynchronizeFixtures();return p;};ao.prototype.Merge=function(j){var n;for(n=j.m_fixtureList;n;){var k=n.m_next;j.m_fixtureCount--;n.m_next=this.m_fixtureList;
this.m_fixtureList=n;this.m_fixtureCount++;n.m_body=l;n=k;}d.m_fixtureCount=0;var d=this,l=j;d.GetWorldCenter();l.GetWorldCenter();d.GetLinearVelocity().Copy();
l.GetLinearVelocity().Copy();d.GetAngularVelocity();l.GetAngularVelocity();d.ResetMassData();this.SynchronizeFixtures();};ao.prototype.GetMass=function(){return this.m_mass;
};ao.prototype.GetInertia=function(){return this.m_I;};ao.prototype.GetMassData=function(d){d.mass=this.m_mass;d.I=this.m_I;d.center.SetV(this.m_sweep.localCenter);
};ao.prototype.SetMassData=function(d){aj.b2Assert(this.m_world.IsLocked()==false);if(this.m_world.IsLocked()!=true){if(this.m_type==ao.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;
this.m_mass=d.mass;if(this.m_mass<=0){this.m_mass=1;}this.m_invMass=1/this.m_mass;if(d.I>0&&(this.m_flags&ao.e_fixedRotationFlag)==0){this.m_I=d.I-this.m_mass*(d.center.x*d.center.x+d.center.y*d.center.y);
this.m_invI=1/this.m_I;}var j=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(d.center);this.m_sweep.c0.SetV(ae.MulX(this.m_xf,this.m_sweep.localCenter));
this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-j.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-j.x);
}}};ao.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(!(this.m_type==ao.b2_staticBody||this.m_type==ao.b2_kinematicBody)){for(var d=P.Make(0,0),k=this.m_fixtureList;
k;k=k.m_next){if(k.m_density!=0){var j=k.GetMassData();this.m_mass+=j.mass;d.x+=j.center.x*j.mass;d.y+=j.center.y*j.mass;this.m_I+=j.I;}}if(this.m_mass>0){this.m_invMass=1/this.m_mass;
d.x*=this.m_invMass;d.y*=this.m_invMass;}else{this.m_invMass=this.m_mass=1;}if(this.m_I>0&&(this.m_flags&ao.e_fixedRotationFlag)==0){this.m_I-=this.m_mass*(d.x*d.x+d.y*d.y);
this.m_I*=this.m_inertiaScale;aj.b2Assert(this.m_I>0);this.m_invI=1/this.m_I;}else{this.m_invI=this.m_I=0;}k=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(d);
this.m_sweep.c0.SetV(ae.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-k.y);
this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-k.x);}};ao.prototype.GetWorldPoint=function(d){var j=this.m_xf.R;d=new P(j.col1.x*d.x+j.col2.x*d.y,j.col1.y*d.x+j.col2.y*d.y);
d.x+=this.m_xf.position.x;d.y+=this.m_xf.position.y;return d;};ao.prototype.GetWorldVector=function(d){return ae.MulMV(this.m_xf.R,d);};ao.prototype.GetLocalPoint=function(d){return ae.MulXT(this.m_xf,d);
};ao.prototype.GetLocalVector=function(d){return ae.MulTMV(this.m_xf.R,d);};ao.prototype.GetLinearVelocityFromWorldPoint=function(d){return new P(this.m_linearVelocity.x-this.m_angularVelocity*(d.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(d.x-this.m_sweep.c.x));
};ao.prototype.GetLinearVelocityFromLocalPoint=function(d){var j=this.m_xf.R;d=new P(j.col1.x*d.x+j.col2.x*d.y,j.col1.y*d.x+j.col2.y*d.y);d.x+=this.m_xf.position.x;
d.y+=this.m_xf.position.y;return new P(this.m_linearVelocity.x-this.m_angularVelocity*(d.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(d.x-this.m_sweep.c.x));
};ao.prototype.GetLinearDamping=function(){return this.m_linearDamping;};ao.prototype.SetLinearDamping=function(d){if(d===undefined){d=0;}this.m_linearDamping=d;
};ao.prototype.GetAngularDamping=function(){return this.m_angularDamping;};ao.prototype.SetAngularDamping=function(d){if(d===undefined){d=0;}this.m_angularDamping=d;
};ao.prototype.SetType=function(d){if(d===undefined){d=0;}if(this.m_type!=d){this.m_type=d;this.ResetMassData();if(this.m_type==ao.b2_staticBody){this.m_linearVelocity.SetZero();
this.m_angularVelocity=0;}this.SetAwake(true);this.m_force.SetZero();this.m_torque=0;for(d=this.m_contactList;d;d=d.next){d.contact.FlagForFiltering();
}}};ao.prototype.GetType=function(){return this.m_type;};ao.prototype.SetBullet=function(d){if(d){this.m_flags|=ao.e_bulletFlag;}else{this.m_flags&=~ao.e_bulletFlag;
}};ao.prototype.IsBullet=function(){return(this.m_flags&ao.e_bulletFlag)==ao.e_bulletFlag;};ao.prototype.SetSleepingAllowed=function(d){if(d){this.m_flags|=ao.e_allowSleepFlag;
}else{this.m_flags&=~ao.e_allowSleepFlag;this.SetAwake(true);}};ao.prototype.SetAwake=function(d){if(d){this.m_flags|=ao.e_awakeFlag;this.m_sleepTime=0;
}else{this.m_flags&=~ao.e_awakeFlag;this.m_sleepTime=0;this.m_linearVelocity.SetZero();this.m_angularVelocity=0;this.m_force.SetZero();this.m_torque=0;
}};ao.prototype.IsAwake=function(){return(this.m_flags&ao.e_awakeFlag)==ao.e_awakeFlag;};ao.prototype.SetFixedRotation=function(d){if(d){this.m_flags|=ao.e_fixedRotationFlag;
}else{this.m_flags&=~ao.e_fixedRotationFlag;}this.ResetMassData();};ao.prototype.IsFixedRotation=function(){return(this.m_flags&ao.e_fixedRotationFlag)==ao.e_fixedRotationFlag;
};ao.prototype.SetActive=function(d){if(d!=this.IsActive()){var j;if(d){this.m_flags|=ao.e_activeFlag;d=this.m_world.m_contactManager.m_broadPhase;for(j=this.m_fixtureList;
j;j=j.m_next){j.CreateProxy(d,this.m_xf);}}else{this.m_flags&=~ao.e_activeFlag;d=this.m_world.m_contactManager.m_broadPhase;for(j=this.m_fixtureList;j;
j=j.m_next){j.DestroyProxy(d);}for(d=this.m_contactList;d;){j=d;d=d.next;this.m_world.m_contactManager.Destroy(j.contact);}this.m_contactList=null;}}};
ao.prototype.IsActive=function(){return(this.m_flags&ao.e_activeFlag)==ao.e_activeFlag;};ao.prototype.IsSleepingAllowed=function(){return(this.m_flags&ao.e_allowSleepFlag)==ao.e_allowSleepFlag;
};ao.prototype.GetFixtureList=function(){return this.m_fixtureList;};ao.prototype.GetJointList=function(){return this.m_jointList;};ao.prototype.GetControllerList=function(){return this.m_controllerList;
};ao.prototype.GetContactList=function(){return this.m_contactList;};ao.prototype.GetNext=function(){return this.m_next;};ao.prototype.GetUserData=function(){return this.m_userData;
};ao.prototype.SetUserData=function(d){this.m_userData=d;};ao.prototype.GetWorld=function(){return this.m_world;};ao.prototype.b2Body=function(j,l){this.m_flags=0;
if(j.bullet){this.m_flags|=ao.e_bulletFlag;}if(j.fixedRotation){this.m_flags|=ao.e_fixedRotationFlag;}if(j.allowSleep){this.m_flags|=ao.e_allowSleepFlag;
}if(j.awake){this.m_flags|=ao.e_awakeFlag;}if(j.active){this.m_flags|=ao.e_activeFlag;}this.m_world=l;this.m_xf.position.SetV(j.position);this.m_xf.R.Set(j.angle);
this.m_sweep.localCenter.SetZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=j.angle;var k=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=k.col1.x*d.x+k.col2.x*d.y;
this.m_sweep.c.y=k.col1.y*d.x+k.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);
this.m_contactList=this.m_controllerList=this.m_jointList=null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.SetV(j.linearVelocity);
this.m_angularVelocity=j.angularVelocity;this.m_linearDamping=j.linearDamping;this.m_angularDamping=j.angularDamping;this.m_force.Set(0,0);this.m_sleepTime=this.m_torque=0;
this.m_type=j.type;if(this.m_type==ao.b2_dynamicBody){this.m_invMass=this.m_mass=1;}else{this.m_invMass=this.m_mass=0;}this.m_invI=this.m_I=0;this.m_inertiaScale=j.inertiaScale;
this.m_userData=j.userData;this.m_fixtureList=null;this.m_fixtureCount=0;};ao.prototype.SynchronizeFixtures=function(){var d=ao.s_xf1;d.R.Set(this.m_sweep.a0);
var k=d.R,j=this.m_sweep.localCenter;d.position.x=this.m_sweep.c0.x-(k.col1.x*j.x+k.col2.x*j.y);d.position.y=this.m_sweep.c0.y-(k.col1.y*j.x+k.col2.y*j.y);
j=this.m_world.m_contactManager.m_broadPhase;for(k=this.m_fixtureList;k;k=k.m_next){k.Synchronize(j,d,this.m_xf);}};ao.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);
var d=this.m_xf.R,j=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(d.col1.x*j.x+d.col2.x*j.y);this.m_xf.position.y=this.m_sweep.c.y-(d.col1.y*j.x+d.col2.y*j.y);
};ao.prototype.ShouldCollide=function(d){if(this.m_type!=ao.b2_dynamicBody&&d.m_type!=ao.b2_dynamicBody){return false;}for(var j=this.m_jointList;j;j=j.next){if(j.other==d){if(j.joint.m_collideConnected==false){return false;
}}}return true;};ao.prototype.Advance=function(d){if(d===undefined){d=0;}this.m_sweep.Advance(d);this.m_sweep.c.SetV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;
this.SynchronizeTransform();};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new J;Box2D.Dynamics.b2Body.e_islandFlag=1;Box2D.Dynamics.b2Body.e_awakeFlag=2;
Box2D.Dynamics.b2Body.e_allowSleepFlag=4;Box2D.Dynamics.b2Body.e_bulletFlag=8;Box2D.Dynamics.b2Body.e_fixedRotationFlag=16;Box2D.Dynamics.b2Body.e_activeFlag=32;
Box2D.Dynamics.b2Body.b2_staticBody=0;Box2D.Dynamics.b2Body.b2_kinematicBody=1;Box2D.Dynamics.b2Body.b2_dynamicBody=2;});C.b2BodyDef=function(){this.position=new P;
this.linearVelocity=new P;};C.prototype.b2BodyDef=function(){this.userData=null;this.position.Set(0,0);this.angle=0;this.linearVelocity.Set(0,0);this.angularDamping=this.linearDamping=this.angularVelocity=0;
this.awake=this.allowSleep=true;this.bullet=this.fixedRotation=false;this.type=ao.b2_staticBody;this.active=true;this.inertiaScale=1;};ad.b2ContactFilter=function(){};
ad.prototype.ShouldCollide=function(j,l){var k=j.GetFilterData(),d=l.GetFilterData();if(k.groupIndex==d.groupIndex&&k.groupIndex!=0){return k.groupIndex>0;
}return(k.maskBits&d.categoryBits)!=0&&(k.categoryBits&d.maskBits)!=0;};ad.prototype.RayCollide=function(d,j){if(!d){return true;}return this.ShouldCollide(d instanceof g?d:null,j);
};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new ad;});ag.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(aj.b2_maxManifoldPoints);
this.tangentImpulses=new Vector_a2j_Number(aj.b2_maxManifoldPoints);};X.b2ContactListener=function(){};X.prototype.BeginContact=function(){};X.prototype.EndContact=function(){};
X.prototype.PreSolve=function(){};X.prototype.PostSolve=function(){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new X;
});s.b2ContactManager=function(){};s.prototype.b2ContactManager=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=ad.b2_defaultFilter;
this.m_contactListener=X.b2_defaultListener;this.m_contactFactory=new ap(this.m_allocator);this.m_broadPhase=new ai;};s.prototype.AddPair=function(q,o){var k=q instanceof g?q:null,p=o instanceof g?o:null,n=k.GetBody(),l=p.GetBody();
if(n!=l){for(var j=l.GetContactList();j;){if(j.other==n){var d=j.contact.GetFixtureA(),u=j.contact.GetFixtureB();if(d==k&&u==p){return;}if(d==p&&u==k){return;
}}j=j.next;}if(l.ShouldCollide(n)!=false){if(this.m_contactFilter.ShouldCollide(k,p)!=false){j=this.m_contactFactory.Create(k,p);k=j.GetFixtureA();p=j.GetFixtureB();
n=k.m_body;l=p.m_body;j.m_prev=null;j.m_next=this.m_world.m_contactList;if(this.m_world.m_contactList!=null){this.m_world.m_contactList.m_prev=j;}this.m_world.m_contactList=j;
j.m_nodeA.contact=j;j.m_nodeA.other=l;j.m_nodeA.prev=null;j.m_nodeA.next=n.m_contactList;if(n.m_contactList!=null){n.m_contactList.prev=j.m_nodeA;}n.m_contactList=j.m_nodeA;
j.m_nodeB.contact=j;j.m_nodeB.other=n;j.m_nodeB.prev=null;j.m_nodeB.next=l.m_contactList;if(l.m_contactList!=null){l.m_contactList.prev=j.m_nodeB;}l.m_contactList=j.m_nodeB;
++this.m_world.m_contactCount;}}}};s.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair));};s.prototype.Destroy=function(d){var k=d.GetFixtureA(),j=d.GetFixtureB();
k=k.GetBody();j=j.GetBody();d.IsTouching()&&this.m_contactListener.EndContact(d);if(d.m_prev){d.m_prev.m_next=d.m_next;}if(d.m_next){d.m_next.m_prev=d.m_prev;
}if(d==this.m_world.m_contactList){this.m_world.m_contactList=d.m_next;}if(d.m_nodeA.prev){d.m_nodeA.prev.next=d.m_nodeA.next;}if(d.m_nodeA.next){d.m_nodeA.next.prev=d.m_nodeA.prev;
}if(d.m_nodeA==k.m_contactList){k.m_contactList=d.m_nodeA.next;}if(d.m_nodeB.prev){d.m_nodeB.prev.next=d.m_nodeB.next;}if(d.m_nodeB.next){d.m_nodeB.next.prev=d.m_nodeB.prev;
}if(d.m_nodeB==j.m_contactList){j.m_contactList=d.m_nodeB.next;}this.m_contactFactory.Destroy(d);--this.m_contactCount;};s.prototype.Collide=function(){for(var j=this.m_world.m_contactList;
j;){var n=j.GetFixtureA(),k=j.GetFixtureB(),d=n.GetBody(),l=k.GetBody();if(d.IsAwake()==false&&l.IsAwake()==false){j=j.GetNext();}else{if(j.m_flags&an.e_filterFlag){if(l.ShouldCollide(d)==false){n=j;
j=n.GetNext();this.Destroy(n);continue;}if(this.m_contactFilter.ShouldCollide(n,k)==false){n=j;j=n.GetNext();this.Destroy(n);continue;}j.m_flags&=~an.e_filterFlag;
}if(this.m_broadPhase.TestOverlap(n.m_proxy,k.m_proxy)==false){n=j;j=n.GetNext();this.Destroy(n);}else{j.Update(this.m_contactListener);j=j.GetNext();}}}};
Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new ak;});af.b2DebugDraw=function(){};af.prototype.b2DebugDraw=function(){};af.prototype.SetFlags=function(){};
af.prototype.GetFlags=function(){};af.prototype.AppendFlags=function(){};af.prototype.ClearFlags=function(){};af.prototype.SetSprite=function(){};af.prototype.GetSprite=function(){};
af.prototype.SetDrawScale=function(){};af.prototype.GetDrawScale=function(){};af.prototype.SetLineThickness=function(){};af.prototype.GetLineThickness=function(){};
af.prototype.SetAlpha=function(){};af.prototype.GetAlpha=function(){};af.prototype.SetFillAlpha=function(){};af.prototype.GetFillAlpha=function(){};af.prototype.SetXFormScale=function(){};
af.prototype.GetXFormScale=function(){};af.prototype.DrawPolygon=function(){};af.prototype.DrawSolidPolygon=function(){};af.prototype.DrawCircle=function(){};
af.prototype.DrawSolidCircle=function(){};af.prototype.DrawSegment=function(){};af.prototype.DrawTransform=function(){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1;
Box2D.Dynamics.b2DebugDraw.e_jointBit=2;Box2D.Dynamics.b2DebugDraw.e_aabbBit=4;Box2D.Dynamics.b2DebugDraw.e_pairBit=8;Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16;
Box2D.Dynamics.b2DebugDraw.e_controllerBit=32;});m.b2DestructionListener=function(){};m.prototype.SayGoodbyeJoint=function(){};m.prototype.SayGoodbyeFixture=function(){};
t.b2FilterData=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0;};t.prototype.Copy=function(){var d=new t;d.categoryBits=this.categoryBits;
d.maskBits=this.maskBits;d.groupIndex=this.groupIndex;return d;};g.b2Fixture=function(){this.m_filter=new t;};g.prototype.GetType=function(){return this.m_shape.GetType();
};g.prototype.GetShape=function(){return this.m_shape;};g.prototype.SetSensor=function(j){if(this.m_isSensor!=j){this.m_isSensor=j;if(this.m_body!=null){for(j=this.m_body.GetContactList();
j;){var l=j.contact,k=l.GetFixtureA(),d=l.GetFixtureB();if(k==this||d==this){l.SetSensor(k.IsSensor()||d.IsSensor());}j=j.next;}}}};g.prototype.IsSensor=function(){return this.m_isSensor;
};g.prototype.SetFilterData=function(j){this.m_filter=j.Copy();if(!this.m_body){for(j=this.m_body.GetContactList();j;){var l=j.contact,k=l.GetFixtureA(),d=l.GetFixtureB();
if(k==this||d==this){l.FlagForFiltering();}j=j.next;}}};g.prototype.GetFilterData=function(){return this.m_filter.Copy();};g.prototype.GetBody=function(){return this.m_body;
};g.prototype.GetNext=function(){return this.m_next;};g.prototype.GetUserData=function(){return this.m_userData;};g.prototype.SetUserData=function(d){this.m_userData=d;
};g.prototype.TestPoint=function(d){return this.m_shape.TestPoint(this.m_body.GetTransform(),d);};g.prototype.RayCast=function(d,j){return this.m_shape.RayCast(d,j,this.m_body.GetTransform());
};g.prototype.GetMassData=function(d){if(d===undefined){d=null;}if(d==null){d=new T;}this.m_shape.ComputeMass(d,this.m_density);return d;};g.prototype.SetDensity=function(d){if(d===undefined){d=0;
}this.m_density=d;};g.prototype.GetDensity=function(){return this.m_density;};g.prototype.GetFriction=function(){return this.m_friction;};g.prototype.SetFriction=function(d){if(d===undefined){d=0;
}this.m_friction=d;};g.prototype.GetRestitution=function(){return this.m_restitution;};g.prototype.SetRestitution=function(d){if(d===undefined){d=0;}this.m_restitution=d;
};g.prototype.GetAABB=function(){return this.m_aabb;};g.prototype.b2Fixture=function(){this.m_aabb=new f;this.m_shape=this.m_next=this.m_body=this.m_userData=null;
this.m_restitution=this.m_friction=this.m_density=0;};g.prototype.Create=function(d,k,j){this.m_userData=j.userData;this.m_friction=j.friction;this.m_restitution=j.restitution;
this.m_body=d;this.m_next=null;this.m_filter=j.filter.Copy();this.m_isSensor=j.isSensor;this.m_shape=j.shape.Copy();this.m_density=j.density;};g.prototype.Destroy=function(){this.m_shape=null;
};g.prototype.CreateProxy=function(d,j){this.m_shape.ComputeAABB(this.m_aabb,j);this.m_proxy=d.CreateProxy(this.m_aabb,this);};g.prototype.DestroyProxy=function(d){if(this.m_proxy!=null){d.DestroyProxy(this.m_proxy);
this.m_proxy=null;}};g.prototype.Synchronize=function(j,n,k){if(this.m_proxy){var d=new f,l=new f;this.m_shape.ComputeAABB(d,n);this.m_shape.ComputeAABB(l,k);
this.m_aabb.Combine(d,l);n=ae.SubtractVV(k.position,n.position);j.MoveProxy(this.m_proxy,this.m_aabb,n);}};at.b2FixtureDef=function(){this.filter=new t;
};at.prototype.b2FixtureDef=function(){this.userData=this.shape=null;this.friction=0.2;this.density=this.restitution=0;this.filter.categoryBits=1;this.filter.maskBits=65535;
this.filter.groupIndex=0;this.isSensor=false;};a.b2Island=function(){};a.prototype.b2Island=function(){this.m_bodies=new Vector;this.m_contacts=new Vector;
this.m_joints=new Vector;};a.prototype.Initialize=function(k,p,l,j,o,n){if(k===undefined){k=0;}if(p===undefined){p=0;}if(l===undefined){l=0;}var d=0;this.m_bodyCapacity=k;
this.m_contactCapacity=p;this.m_jointCapacity=l;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=j;this.m_listener=o;this.m_contactSolver=n;
for(d=this.m_bodies.length;d<k;d++){this.m_bodies[d]=null;}for(d=this.m_contacts.length;d<p;d++){this.m_contacts[d]=null;}for(d=this.m_joints.length;d<l;
d++){this.m_joints[d]=null;}};a.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;};a.prototype.Solve=function(k,q,n){var j=0,p=0,o;
for(j=0;j<this.m_bodyCount;++j){p=this.m_bodies[j];if(p.GetType()==ao.b2_dynamicBody){p.m_linearVelocity.x+=k.dt*(q.x+p.m_invMass*p.m_force.x);p.m_linearVelocity.y+=k.dt*(q.y+p.m_invMass*p.m_force.y);
p.m_angularVelocity+=k.dt*p.m_invI*p.m_torque;p.m_linearVelocity.Multiply(ae.Clamp(1-k.dt*p.m_linearDamping,0,1));p.m_angularVelocity*=ae.Clamp(1-k.dt*p.m_angularDamping,0,1);
}}this.m_contactSolver.Initialize(k,this.m_contacts,this.m_contactCount,this.m_allocator);q=this.m_contactSolver;q.InitVelocityConstraints(k);for(j=0;j<this.m_jointCount;
++j){o=this.m_joints[j];o.InitVelocityConstraints(k);}for(j=0;j<k.velocityIterations;++j){for(p=0;p<this.m_jointCount;++p){o=this.m_joints[p];o.SolveVelocityConstraints(k);
}q.SolveVelocityConstraints();}for(j=0;j<this.m_jointCount;++j){o=this.m_joints[j];o.FinalizeVelocityConstraints();}q.FinalizeVelocityConstraints();for(j=0;
j<this.m_bodyCount;++j){p=this.m_bodies[j];if(p.GetType()!=ao.b2_staticBody){var d=k.dt*p.m_linearVelocity.x,l=k.dt*p.m_linearVelocity.y;if(d*d+l*l>aj.b2_maxTranslationSquared){p.m_linearVelocity.Normalize();
p.m_linearVelocity.x*=aj.b2_maxTranslation*k.inv_dt;p.m_linearVelocity.y*=aj.b2_maxTranslation*k.inv_dt;}d=k.dt*p.m_angularVelocity;if(d*d>aj.b2_maxRotationSquared){p.m_angularVelocity=p.m_angularVelocity<0?-aj.b2_maxRotation*k.inv_dt:aj.b2_maxRotation*k.inv_dt;
}p.m_sweep.c0.SetV(p.m_sweep.c);p.m_sweep.a0=p.m_sweep.a;p.m_sweep.c.x+=k.dt*p.m_linearVelocity.x;p.m_sweep.c.y+=k.dt*p.m_linearVelocity.y;p.m_sweep.a+=k.dt*p.m_angularVelocity;
p.SynchronizeTransform();}}for(j=0;j<k.positionIterations;++j){d=q.SolvePositionConstraints(aj.b2_contactBaumgarte);l=true;for(p=0;p<this.m_jointCount;
++p){o=this.m_joints[p];o=o.SolvePositionConstraints(aj.b2_contactBaumgarte);l=l&&o;}if(d&&l){break;}}this.Report(q.m_constraints);if(n){n=Number.MAX_VALUE;
q=aj.b2_linearSleepTolerance*aj.b2_linearSleepTolerance;d=aj.b2_angularSleepTolerance*aj.b2_angularSleepTolerance;for(j=0;j<this.m_bodyCount;++j){p=this.m_bodies[j];
if(p.GetType()!=ao.b2_staticBody){if((p.m_flags&ao.e_allowSleepFlag)==0){n=p.m_sleepTime=0;}if((p.m_flags&ao.e_allowSleepFlag)==0||p.m_angularVelocity*p.m_angularVelocity>d||ae.Dot(p.m_linearVelocity,p.m_linearVelocity)>q){n=p.m_sleepTime=0;
}else{p.m_sleepTime+=k.dt;n=ae.Min(n,p.m_sleepTime);}}}if(n>=aj.b2_timeToSleep){for(j=0;j<this.m_bodyCount;++j){p=this.m_bodies[j];p.SetAwake(false);}}}};
a.prototype.SolveTOI=function(k){var p=0,l=0;this.m_contactSolver.Initialize(k,this.m_contacts,this.m_contactCount,this.m_allocator);var j=this.m_contactSolver;
for(p=0;p<this.m_jointCount;++p){this.m_joints[p].InitVelocityConstraints(k);}for(p=0;p<k.velocityIterations;++p){j.SolveVelocityConstraints();for(l=0;
l<this.m_jointCount;++l){this.m_joints[l].SolveVelocityConstraints(k);}}for(p=0;p<this.m_bodyCount;++p){l=this.m_bodies[p];if(l.GetType()!=ao.b2_staticBody){var o=k.dt*l.m_linearVelocity.x,n=k.dt*l.m_linearVelocity.y;
if(o*o+n*n>aj.b2_maxTranslationSquared){l.m_linearVelocity.Normalize();l.m_linearVelocity.x*=aj.b2_maxTranslation*k.inv_dt;l.m_linearVelocity.y*=aj.b2_maxTranslation*k.inv_dt;
}o=k.dt*l.m_angularVelocity;if(o*o>aj.b2_maxRotationSquared){l.m_angularVelocity=l.m_angularVelocity<0?-aj.b2_maxRotation*k.inv_dt:aj.b2_maxRotation*k.inv_dt;
}l.m_sweep.c0.SetV(l.m_sweep.c);l.m_sweep.a0=l.m_sweep.a;l.m_sweep.c.x+=k.dt*l.m_linearVelocity.x;l.m_sweep.c.y+=k.dt*l.m_linearVelocity.y;l.m_sweep.a+=k.dt*l.m_angularVelocity;
l.SynchronizeTransform();}}for(p=0;p<k.positionIterations;++p){o=j.SolvePositionConstraints(0.75);n=true;for(l=0;l<this.m_jointCount;++l){var d=this.m_joints[l].SolvePositionConstraints(aj.b2_contactBaumgarte);
n=n&&d;}if(o&&n){break;}}this.Report(j.m_constraints);};a.prototype.Report=function(j){if(this.m_listener!=null){for(var n=0;n<this.m_contactCount;++n){for(var k=this.m_contacts[n],d=j[n],l=0;
l<d.pointCount;++l){a.s_impulse.normalImpulses[l]=d.points[l].normalImpulse;a.s_impulse.tangentImpulses[l]=d.points[l].tangentImpulse;}this.m_listener.PostSolve(k,a.s_impulse);
}}};a.prototype.AddBody=function(d){d.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=d;};a.prototype.AddContact=function(d){this.m_contacts[this.m_contactCount++]=d;
};a.prototype.AddJoint=function(d){this.m_joints[this.m_jointCount++]=d;};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new ag;});ar.b2TimeStep=function(){};
ar.prototype.Set=function(d){this.dt=d.dt;this.inv_dt=d.inv_dt;this.positionIterations=d.positionIterations;this.velocityIterations=d.velocityIterations;
this.warmStarting=d.warmStarting;};aq.b2World=function(){this.s_stack=new Vector;this.m_contactManager=new s;this.m_contactSolver=new al;this.m_island=new a;
};aq.prototype.b2World=function(d,j){this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;
this.m_controllerCount=this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;aq.m_warmStarting=true;aq.m_continuousPhysics=true;this.m_allowSleep=j;
this.m_gravity=d;this.m_inv_dt0=0;this.m_contactManager.m_world=this;this.m_groundBody=this.CreateBody(new C);};aq.prototype.SetDestructionListener=function(d){this.m_destructionListener=d;
};aq.prototype.SetContactFilter=function(d){this.m_contactManager.m_contactFilter=d;};aq.prototype.SetContactListener=function(d){this.m_contactManager.m_contactListener=d;
};aq.prototype.SetDebugDraw=function(d){this.m_debugDraw=d;};aq.prototype.SetBroadPhase=function(j){var l=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=j;
for(var k=this.m_bodyList;k;k=k.m_next){for(var d=k.m_fixtureList;d;d=d.m_next){d.m_proxy=j.CreateProxy(l.GetFatAABB(d.m_proxy),d);}}};aq.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate();
};aq.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount();};aq.prototype.CreateBody=function(d){if(this.IsLocked()==true){return null;
}d=new ao(d,this);d.m_prev=null;if(d.m_next=this.m_bodyList){this.m_bodyList.m_prev=d;}this.m_bodyList=d;++this.m_bodyCount;return d;};aq.prototype.DestroyBody=function(d){if(this.IsLocked()!=true){for(var k=d.m_jointList;
k;){var j=k;k=k.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(j.joint);this.DestroyJoint(j.joint);}for(k=d.m_controllerList;
k;){j=k;k=k.nextController;j.controller.RemoveBody(d);}for(k=d.m_contactList;k;){j=k;k=k.next;this.m_contactManager.Destroy(j.contact);}d.m_contactList=null;
for(k=d.m_fixtureList;k;){j=k;k=k.m_next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(j);j.DestroyProxy(this.m_contactManager.m_broadPhase);
j.Destroy();}d.m_fixtureList=null;d.m_fixtureCount=0;if(d.m_prev){d.m_prev.m_next=d.m_next;}if(d.m_next){d.m_next.m_prev=d.m_prev;}if(d==this.m_bodyList){this.m_bodyList=d.m_next;
}--this.m_bodyCount;}};aq.prototype.CreateJoint=function(j){var l=ah.Create(j,null);l.m_prev=null;if(l.m_next=this.m_jointList){this.m_jointList.m_prev=l;
}this.m_jointList=l;++this.m_jointCount;l.m_edgeA.joint=l;l.m_edgeA.other=l.m_bodyB;l.m_edgeA.prev=null;if(l.m_edgeA.next=l.m_bodyA.m_jointList){l.m_bodyA.m_jointList.prev=l.m_edgeA;
}l.m_bodyA.m_jointList=l.m_edgeA;l.m_edgeB.joint=l;l.m_edgeB.other=l.m_bodyA;l.m_edgeB.prev=null;if(l.m_edgeB.next=l.m_bodyB.m_jointList){l.m_bodyB.m_jointList.prev=l.m_edgeB;
}l.m_bodyB.m_jointList=l.m_edgeB;var k=j.bodyA,d=j.bodyB;if(j.collideConnected==false){for(j=d.GetContactList();j;){j.other==k&&j.contact.FlagForFiltering();
j=j.next;}}return l;};aq.prototype.DestroyJoint=function(j){var l=j.m_collideConnected;if(j.m_prev){j.m_prev.m_next=j.m_next;}if(j.m_next){j.m_next.m_prev=j.m_prev;
}if(j==this.m_jointList){this.m_jointList=j.m_next;}var k=j.m_bodyA,d=j.m_bodyB;k.SetAwake(true);d.SetAwake(true);if(j.m_edgeA.prev){j.m_edgeA.prev.next=j.m_edgeA.next;
}if(j.m_edgeA.next){j.m_edgeA.next.prev=j.m_edgeA.prev;}if(j.m_edgeA==k.m_jointList){k.m_jointList=j.m_edgeA.next;}j.m_edgeA.prev=null;j.m_edgeA.next=null;
if(j.m_edgeB.prev){j.m_edgeB.prev.next=j.m_edgeB.next;}if(j.m_edgeB.next){j.m_edgeB.next.prev=j.m_edgeB.prev;}if(j.m_edgeB==d.m_jointList){d.m_jointList=j.m_edgeB.next;
}j.m_edgeB.prev=null;j.m_edgeB.next=null;ah.Destroy(j,null);--this.m_jointCount;if(l==false){for(j=d.GetContactList();j;){j.other==k&&j.contact.FlagForFiltering();
j=j.next;}}};aq.prototype.AddController=function(d){d.m_next=this.m_controllerList;d.m_prev=null;this.m_controllerList=d;d.m_world=this;this.m_controllerCount++;
return d;};aq.prototype.RemoveController=function(d){if(d.m_prev){d.m_prev.m_next=d.m_next;}if(d.m_next){d.m_next.m_prev=d.m_prev;}if(this.m_controllerList==d){this.m_controllerList=d.m_next;
}this.m_controllerCount--;};aq.prototype.CreateController=function(d){if(d.m_world!=this){throw Error("Controller can only be a member of one world");}d.m_next=this.m_controllerList;
d.m_prev=null;if(this.m_controllerList){this.m_controllerList.m_prev=d;}this.m_controllerList=d;++this.m_controllerCount;d.m_world=this;return d;};aq.prototype.DestroyController=function(d){d.Clear();
if(d.m_next){d.m_next.m_prev=d.m_prev;}if(d.m_prev){d.m_prev.m_next=d.m_next;}if(d==this.m_controllerList){this.m_controllerList=d.m_next;}--this.m_controllerCount;
};aq.prototype.SetWarmStarting=function(d){aq.m_warmStarting=d;};aq.prototype.SetContinuousPhysics=function(d){aq.m_continuousPhysics=d;};aq.prototype.GetBodyCount=function(){return this.m_bodyCount;
};aq.prototype.GetJointCount=function(){return this.m_jointCount;};aq.prototype.GetContactCount=function(){return this.m_contactCount;};aq.prototype.SetGravity=function(d){this.m_gravity=d;
};aq.prototype.GetGravity=function(){return this.m_gravity;};aq.prototype.GetGroundBody=function(){return this.m_groundBody;};aq.prototype.Step=function(j,l,k){if(j===undefined){j=0;
}if(l===undefined){l=0;}if(k===undefined){k=0;}if(this.m_flags&aq.e_newFixture){this.m_contactManager.FindNewContacts();this.m_flags&=~aq.e_newFixture;
}this.m_flags|=aq.e_locked;var d=aq.s_timestep2;d.dt=j;d.velocityIterations=l;d.positionIterations=k;d.inv_dt=j>0?1/j:0;d.dtRatio=this.m_inv_dt0*j;d.warmStarting=aq.m_warmStarting;
this.m_contactManager.Collide();d.dt>0&&this.Solve(d);aq.m_continuousPhysics&&d.dt>0&&this.SolveTOI(d);if(d.dt>0){this.m_inv_dt0=d.inv_dt;}this.m_flags&=~aq.e_locked;
};aq.prototype.ClearForces=function(){for(var d=this.m_bodyList;d;d=d.m_next){d.m_force.SetZero();d.m_torque=0;}};aq.prototype.DrawDebugData=function(){if(this.m_debugDraw!=null){this.m_debugDraw.m_sprite.graphics.clear();
var k=this.m_debugDraw.GetFlags(),p,l,j;new P;new P;new P;var o;new f;new f;o=[new P,new P,new P,new P];var n=new ab(0,0,0);if(k&af.e_shapeBit){for(p=this.m_bodyList;
p;p=p.m_next){o=p.m_xf;for(l=p.GetFixtureList();l;l=l.m_next){j=l.GetShape();if(p.IsActive()==false){n.Set(0.5,0.5,0.3);}else{if(p.GetType()==ao.b2_staticBody){n.Set(0.5,0.9,0.5);
}else{if(p.GetType()==ao.b2_kinematicBody){n.Set(0.5,0.5,0.9);}else{p.IsAwake()==false?n.Set(0.6,0.6,0.6):n.Set(0.9,0.7,0.7);}}}this.DrawShape(j,o,n);}}}if(k&af.e_jointBit){for(p=this.m_jointList;
p;p=p.m_next){this.DrawJoint(p);}}if(k&af.e_controllerBit){for(p=this.m_controllerList;p;p=p.m_next){p.Draw(this.m_debugDraw);}}if(k&af.e_pairBit){n.Set(0.3,0.9,0.9);
for(p=this.m_contactManager.m_contactList;p;p=p.GetNext()){j=p.GetFixtureA();l=p.GetFixtureB();j=j.GetAABB().GetCenter();l=l.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(j,l,n);
}}if(k&af.e_aabbBit){j=this.m_contactManager.m_broadPhase;o=[new P,new P,new P,new P];for(p=this.m_bodyList;p;p=p.GetNext()){if(p.IsActive()!=false){for(l=p.GetFixtureList();
l;l=l.GetNext()){var d=j.GetFatAABB(l.m_proxy);o[0].Set(d.lowerBound.x,d.lowerBound.y);o[1].Set(d.upperBound.x,d.lowerBound.y);o[2].Set(d.upperBound.x,d.upperBound.y);
o[3].Set(d.lowerBound.x,d.upperBound.y);this.m_debugDraw.DrawPolygon(o,4,n);}}}}if(k&af.e_centerOfMassBit){for(p=this.m_bodyList;p;p=p.m_next){o=aq.s_xf;
o.R=p.m_xf.R;o.position=p.GetWorldCenter();this.m_debugDraw.DrawTransform(o);}}}};aq.prototype.QueryAABB=function(d,k){var j=this.m_contactManager.m_broadPhase;
j.Query(function(l){return d(j.GetUserData(l));},k);};aq.prototype.QueryShape=function(j,n,k){if(k===undefined){k=null;}if(k==null){k=new J;k.SetIdentity();
}var d=this.m_contactManager.m_broadPhase,l=new f;n.ComputeAABB(l,k);d.Query(function(o){o=d.GetUserData(o) instanceof g?d.GetUserData(o):null;if(b.TestOverlap(n,k,o.GetShape(),o.GetBody().GetTransform())){return j(o);
}return true;},l);};aq.prototype.QueryPoint=function(j,l){var k=this.m_contactManager.m_broadPhase,d=new f;d.lowerBound.Set(l.x-aj.b2_linearSlop,l.y-aj.b2_linearSlop);
d.upperBound.Set(l.x+aj.b2_linearSlop,l.y+aj.b2_linearSlop);k.Query(function(n){n=k.GetUserData(n) instanceof g?k.GetUserData(n):null;if(n.TestPoint(l)){return j(n);
}return true;},d);};aq.prototype.RayCast=function(j,o,k){var d=this.m_contactManager.m_broadPhase,n=new e,l=new r(o,k);d.RayCast(function(p,z){var y=d.GetUserData(z);
y=y instanceof g?y:null;if(y.RayCast(n,p)){var q=n.fraction,u=new P((1-q)*o.x+q*k.x,(1-q)*o.y+q*k.y);return j(y,u,n.normal,q);}return p.maxFraction;},l);
};aq.prototype.RayCastOne=function(d,k){var j;this.RayCast(function(n,p,o,l){if(l===undefined){l=0;}j=n;return l;},d,k);return j;};aq.prototype.RayCastAll=function(d,k){var j=new Vector;
this.RayCast(function(l){j[j.length]=l;return 1;},d,k);return j;};aq.prototype.GetBodyList=function(){return this.m_bodyList;};aq.prototype.GetJointList=function(){return this.m_jointList;
};aq.prototype.GetContactList=function(){return this.m_contactList;};aq.prototype.IsLocked=function(){return(this.m_flags&aq.e_locked)>0;};aq.prototype.Solve=function(k){for(var q,n=this.m_controllerList;
n;n=n.m_next){n.Step(k);}n=this.m_island;n.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);
for(q=this.m_bodyList;q;q=q.m_next){q.m_flags&=~ao.e_islandFlag;}for(var j=this.m_contactList;j;j=j.m_next){j.m_flags&=~an.e_islandFlag;}for(j=this.m_jointList;
j;j=j.m_next){j.m_islandFlag=false;}parseInt(this.m_bodyCount);j=this.s_stack;for(var p=this.m_bodyList;p;p=p.m_next){if(!(p.m_flags&ao.e_islandFlag)){if(!(p.IsAwake()==false||p.IsActive()==false)){if(p.GetType()!=ao.b2_staticBody){n.Clear();
var o=0;j[o++]=p;for(p.m_flags|=ao.e_islandFlag;o>0;){q=j[--o];n.AddBody(q);q.IsAwake()==false&&q.SetAwake(true);if(q.GetType()!=ao.b2_staticBody){for(var d,l=q.m_contactList;
l;l=l.next){if(!(l.contact.m_flags&an.e_islandFlag)){if(!(l.contact.IsSensor()==true||l.contact.IsEnabled()==false||l.contact.IsTouching()==false)){n.AddContact(l.contact);
l.contact.m_flags|=an.e_islandFlag;d=l.other;if(!(d.m_flags&ao.e_islandFlag)){j[o++]=d;d.m_flags|=ao.e_islandFlag;}}}}for(q=q.m_jointList;q;q=q.next){if(q.joint.m_islandFlag!=true){d=q.other;
if(d.IsActive()!=false){n.AddJoint(q.joint);q.joint.m_islandFlag=true;if(!(d.m_flags&ao.e_islandFlag)){j[o++]=d;d.m_flags|=ao.e_islandFlag;}}}}}}n.Solve(k,this.m_gravity,this.m_allowSleep);
for(o=0;o<n.m_bodyCount;++o){q=n.m_bodies[o];if(q.GetType()==ao.b2_staticBody){q.m_flags&=~ao.e_islandFlag;}}}}}}for(o=0;o<j.length;++o){if(!j[o]){break;
}j[o]=null;}for(q=this.m_bodyList;q;q=q.m_next){q.IsAwake()==false||q.IsActive()==false||q.GetType()!=ao.b2_staticBody&&q.SynchronizeFixtures();}this.m_contactManager.FindNewContacts();
};aq.prototype.SolveTOI=function(q){var o,k,p,n=this.m_island;n.Initialize(this.m_bodyCount,aj.b2_maxTOIContactsPerIsland,aj.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);
var l=aq.s_queue;for(o=this.m_bodyList;o;o=o.m_next){o.m_flags&=~ao.e_islandFlag;o.m_sweep.t0=0;}for(p=this.m_contactList;p;p=p.m_next){p.m_flags&=~(an.e_toiFlag|an.e_islandFlag);
}for(p=this.m_jointList;p;p=p.m_next){p.m_islandFlag=false;}for(;;){var j=null,d=1;for(p=this.m_contactList;p;p=p.m_next){if(!(p.IsSensor()==true||p.IsEnabled()==false||p.IsContinuous()==false)){o=1;
if(p.m_flags&an.e_toiFlag){o=p.m_toi;}else{o=p.m_fixtureA;k=p.m_fixtureB;o=o.m_body;k=k.m_body;if((o.GetType()!=ao.b2_dynamicBody||o.IsAwake()==false)&&(k.GetType()!=ao.b2_dynamicBody||k.IsAwake()==false)){continue;
}var u=o.m_sweep.t0;if(o.m_sweep.t0<k.m_sweep.t0){u=k.m_sweep.t0;o.m_sweep.Advance(u);}else{if(k.m_sweep.t0<o.m_sweep.t0){u=o.m_sweep.t0;k.m_sweep.Advance(u);
}}o=p.ComputeTOI(o.m_sweep,k.m_sweep);aj.b2Assert(0<=o&&o<=1);if(o>0&&o<1){o=(1-o)*u+o;if(o>1){o=1;}}p.m_toi=o;p.m_flags|=an.e_toiFlag;}if(Number.MIN_VALUE<o&&o<d){j=p;
d=o;}}}if(j==null||1-100*Number.MIN_VALUE<d){break;}o=j.m_fixtureA;k=j.m_fixtureB;o=o.m_body;k=k.m_body;aq.s_backupA.Set(o.m_sweep);aq.s_backupB.Set(k.m_sweep);
o.Advance(d);k.Advance(d);j.Update(this.m_contactManager.m_contactListener);j.m_flags&=~an.e_toiFlag;if(j.IsSensor()==true||j.IsEnabled()==false){o.m_sweep.Set(aq.s_backupA);
k.m_sweep.Set(aq.s_backupB);o.SynchronizeTransform();k.SynchronizeTransform();}else{if(j.IsTouching()!=false){o=o;if(o.GetType()!=ao.b2_dynamicBody){o=k;
}n.Clear();j=p=0;l[p+j++]=o;for(o.m_flags|=ao.e_islandFlag;j>0;){o=l[p++];--j;n.AddBody(o);o.IsAwake()==false&&o.SetAwake(true);if(o.GetType()==ao.b2_dynamicBody){for(k=o.m_contactList;
k;k=k.next){if(n.m_contactCount==n.m_contactCapacity){break;}if(!(k.contact.m_flags&an.e_islandFlag)){if(!(k.contact.IsSensor()==true||k.contact.IsEnabled()==false||k.contact.IsTouching()==false)){n.AddContact(k.contact);
k.contact.m_flags|=an.e_islandFlag;u=k.other;if(!(u.m_flags&ao.e_islandFlag)){if(u.GetType()!=ao.b2_staticBody){u.Advance(d);u.SetAwake(true);}l[p+j]=u;
++j;u.m_flags|=ao.e_islandFlag;}}}}for(o=o.m_jointList;o;o=o.next){if(n.m_jointCount!=n.m_jointCapacity){if(o.joint.m_islandFlag!=true){u=o.other;if(u.IsActive()!=false){n.AddJoint(o.joint);
o.joint.m_islandFlag=true;if(!(u.m_flags&ao.e_islandFlag)){if(u.GetType()!=ao.b2_staticBody){u.Advance(d);u.SetAwake(true);}l[p+j]=u;++j;u.m_flags|=ao.e_islandFlag;
}}}}}}}p=aq.s_timestep;p.warmStarting=false;p.dt=(1-d)*q.dt;p.inv_dt=1/p.dt;p.dtRatio=0;p.velocityIterations=q.velocityIterations;p.positionIterations=q.positionIterations;
n.SolveTOI(p);for(d=d=0;d<n.m_bodyCount;++d){o=n.m_bodies[d];o.m_flags&=~ao.e_islandFlag;if(o.IsAwake()!=false){if(o.GetType()==ao.b2_dynamicBody){o.SynchronizeFixtures();
for(k=o.m_contactList;k;k=k.next){k.contact.m_flags&=~an.e_toiFlag;}}}}for(d=0;d<n.m_contactCount;++d){p=n.m_contacts[d];p.m_flags&=~(an.e_toiFlag|an.e_islandFlag);
}for(d=0;d<n.m_jointCount;++d){p=n.m_joints[d];p.m_islandFlag=false;}this.m_contactManager.FindNewContacts();}}}};aq.prototype.DrawJoint=function(k){var q=k.GetBodyA(),n=k.GetBodyB(),j=q.m_xf.position,p=n.m_xf.position,o=k.GetAnchorA(),d=k.GetAnchorB(),l=aq.s_jointColor;
switch(k.m_type){case ah.e_distanceJoint:this.m_debugDraw.DrawSegment(o,d,l);break;case ah.e_pulleyJoint:q=k instanceof am?k:null;k=q.GetGroundAnchorA();
q=q.GetGroundAnchorB();this.m_debugDraw.DrawSegment(k,o,l);this.m_debugDraw.DrawSegment(q,d,l);this.m_debugDraw.DrawSegment(k,q,l);break;case ah.e_mouseJoint:this.m_debugDraw.DrawSegment(o,d,l);
break;default:q!=this.m_groundBody&&this.m_debugDraw.DrawSegment(j,o,l);this.m_debugDraw.DrawSegment(o,d,l);n!=this.m_groundBody&&this.m_debugDraw.DrawSegment(p,d,l);
}};aq.prototype.DrawShape=function(j,o,k){switch(j.m_type){case b.e_circleShape:var d=j instanceof v?j:null;this.m_debugDraw.DrawSolidCircle(ae.MulX(o,d.m_p),d.m_radius,o.R.col1,k);
break;case b.e_polygonShape:d=0;d=j instanceof c?j:null;j=parseInt(d.GetVertexCount());var n=d.GetVertices(),l=new Vector(j);for(d=0;d<j;++d){l[d]=ae.MulX(o,n[d]);
}this.m_debugDraw.DrawSolidPolygon(l,j,k);break;case b.e_edgeShape:d=j instanceof x?j:null;this.m_debugDraw.DrawSegment(ae.MulX(o,d.GetVertex1()),ae.MulX(o,d.GetVertex2()),k);
}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new ar;Box2D.Dynamics.b2World.s_xf=new J;Box2D.Dynamics.b2World.s_backupA=new ac;Box2D.Dynamics.b2World.s_backupB=new ac;
Box2D.Dynamics.b2World.s_timestep=new ar;Box2D.Dynamics.b2World.s_queue=new Vector;Box2D.Dynamics.b2World.s_jointColor=new ab(0.5,0.8,0.8);Box2D.Dynamics.b2World.e_newFixture=1;
Box2D.Dynamics.b2World.e_locked=2;});})();(function(){var X=Box2D.Collision.Shapes.b2CircleShape,P=Box2D.Collision.Shapes.b2EdgeShape,t=Box2D.Collision.Shapes.b2PolygonShape,v=Box2D.Collision.Shapes.b2Shape,J=Box2D.Dynamics.Contacts.b2CircleContact,ae=Box2D.Dynamics.Contacts.b2Contact,f=Box2D.Dynamics.Contacts.b2ContactConstraint,af=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,ad=Box2D.Dynamics.Contacts.b2ContactEdge,m=Box2D.Dynamics.Contacts.b2ContactFactory,e=Box2D.Dynamics.Contacts.b2ContactRegister,q=Box2D.Dynamics.Contacts.b2ContactResult,r=Box2D.Dynamics.Contacts.b2ContactSolver,x=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,c=Box2D.Dynamics.Contacts.b2NullContact,b=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,ah=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,s=Box2D.Dynamics.Contacts.b2PolygonContact,T=Box2D.Dynamics.Contacts.b2PositionSolverManifold,ac=Box2D.Dynamics.b2Body,C=Box2D.Dynamics.b2TimeStep,n=Box2D.Common.b2Settings,ab=Box2D.Common.Math.b2Mat22,j=Box2D.Common.Math.b2Math,o=Box2D.Common.Math.b2Vec2,g=Box2D.Collision.b2Collision,ak=Box2D.Collision.b2ContactID,a=Box2D.Collision.b2Manifold,aj=Box2D.Collision.b2TimeOfImpact,ai=Box2D.Collision.b2TOIInput,ag=Box2D.Collision.b2WorldManifold;
Box2D.inherit(J,Box2D.Dynamics.Contacts.b2Contact);J.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;J.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments);
};J.Create=function(){return new J;};J.Destroy=function(){};J.prototype.Reset=function(d,k){this.__super.Reset.call(this,d,k);};J.prototype.Evaluate=function(){var d=this.m_fixtureA.GetBody(),k=this.m_fixtureB.GetBody();
g.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape() instanceof X?this.m_fixtureA.GetShape():null,d.m_xf,this.m_fixtureB.GetShape() instanceof X?this.m_fixtureB.GetShape():null,k.m_xf);
};ae.b2Contact=function(){this.m_nodeA=new ad;this.m_nodeB=new ad;this.m_manifold=new a;this.m_oldManifold=new a;};ae.prototype.GetManifold=function(){return this.m_manifold;
};ae.prototype.GetWorldManifold=function(k){var p=this.m_fixtureA.GetBody(),l=this.m_fixtureB.GetBody(),u=this.m_fixtureA.GetShape(),d=this.m_fixtureB.GetShape();
k.Initialize(this.m_manifold,p.GetTransform(),u.m_radius,l.GetTransform(),d.m_radius);};ae.prototype.IsTouching=function(){return(this.m_flags&ae.e_touchingFlag)==ae.e_touchingFlag;
};ae.prototype.IsContinuous=function(){return(this.m_flags&ae.e_continuousFlag)==ae.e_continuousFlag;};ae.prototype.SetSensor=function(d){if(d){this.m_flags|=ae.e_sensorFlag;
}else{this.m_flags&=~ae.e_sensorFlag;}};ae.prototype.IsSensor=function(){return(this.m_flags&ae.e_sensorFlag)==ae.e_sensorFlag;};ae.prototype.SetEnabled=function(d){if(d){this.m_flags|=ae.e_enabledFlag;
}else{this.m_flags&=~ae.e_enabledFlag;}};ae.prototype.IsEnabled=function(){return(this.m_flags&ae.e_enabledFlag)==ae.e_enabledFlag;};ae.prototype.GetNext=function(){return this.m_next;
};ae.prototype.GetFixtureA=function(){return this.m_fixtureA;};ae.prototype.GetFixtureB=function(){return this.m_fixtureB;};ae.prototype.FlagForFiltering=function(){this.m_flags|=ae.e_filterFlag;
};ae.prototype.b2Contact=function(){};ae.prototype.Reset=function(d,l){if(d===undefined){d=null;}if(l===undefined){l=null;}this.m_flags=ae.e_enabledFlag;
if(!d||!l){this.m_fixtureB=this.m_fixtureA=null;}else{if(d.IsSensor()||l.IsSensor()){this.m_flags|=ae.e_sensorFlag;}var k=d.GetBody(),p=l.GetBody();if(k.GetType()!=ac.b2_dynamicBody||k.IsBullet()||p.GetType()!=ac.b2_dynamicBody||p.IsBullet()){this.m_flags|=ae.e_continuousFlag;
}this.m_fixtureA=d;this.m_fixtureB=l;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;
this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null;}};ae.prototype.Update=function(p){var k=this.m_oldManifold;
this.m_oldManifold=this.m_manifold;this.m_manifold=k;this.m_flags|=ae.e_enabledFlag;var d=false;k=(this.m_flags&ae.e_touchingFlag)==ae.e_touchingFlag;var l=this.m_fixtureA.m_body,D=this.m_fixtureB.m_body,A=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);
if(this.m_flags&ae.e_sensorFlag){if(A){d=this.m_fixtureA.GetShape();A=this.m_fixtureB.GetShape();l=l.GetTransform();D=D.GetTransform();d=v.TestOverlap(d,l,A,D);
}this.m_manifold.m_pointCount=0;}else{if(l.GetType()!=ac.b2_dynamicBody||l.IsBullet()||D.GetType()!=ac.b2_dynamicBody||D.IsBullet()){this.m_flags|=ae.e_continuousFlag;
}else{this.m_flags&=~ae.e_continuousFlag;}if(A){this.Evaluate();d=this.m_manifold.m_pointCount>0;for(A=0;A<this.m_manifold.m_pointCount;++A){var u=this.m_manifold.m_points[A];
u.m_normalImpulse=0;u.m_tangentImpulse=0;for(var B=u.m_id,z=0;z<this.m_oldManifold.m_pointCount;++z){var y=this.m_oldManifold.m_points[z];if(y.m_id.key==B.key){u.m_normalImpulse=y.m_normalImpulse;
u.m_tangentImpulse=y.m_tangentImpulse;break;}}}}else{this.m_manifold.m_pointCount=0;}if(d!=k){l.SetAwake(true);D.SetAwake(true);}}if(d){this.m_flags|=ae.e_touchingFlag;
}else{this.m_flags&=~ae.e_touchingFlag;}k==false&&d==true&&p.BeginContact(this);k==true&&d==false&&p.EndContact(this);(this.m_flags&ae.e_sensorFlag)==0&&p.PreSolve(this,this.m_oldManifold);
};ae.prototype.Evaluate=function(){};ae.prototype.ComputeTOI=function(d,k){ae.s_input.proxyA.Set(this.m_fixtureA.GetShape());ae.s_input.proxyB.Set(this.m_fixtureB.GetShape());
ae.s_input.sweepA=d;ae.s_input.sweepB=k;ae.s_input.tolerance=n.b2_linearSlop;return aj.TimeOfImpact(ae.s_input);};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1;
Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2;Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4;Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8;Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16;
Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32;Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64;Box2D.Dynamics.Contacts.b2Contact.s_input=new ai;});
f.b2ContactConstraint=function(){this.localPlaneNormal=new o;this.localPoint=new o;this.normal=new o;this.normalMass=new ab;this.K=new ab;};f.prototype.b2ContactConstraint=function(){this.points=new Vector(n.b2_maxManifoldPoints);
for(var d=0;d<n.b2_maxManifoldPoints;d++){this.points[d]=new af;}};af.b2ContactConstraintPoint=function(){this.localPoint=new o;this.rA=new o;this.rB=new o;
};ad.b2ContactEdge=function(){};m.b2ContactFactory=function(){};m.prototype.b2ContactFactory=function(d){this.m_allocator=d;this.InitializeRegisters();
};m.prototype.AddType=function(d,l,k,p){if(k===undefined){k=0;}if(p===undefined){p=0;}this.m_registers[k][p].createFcn=d;this.m_registers[k][p].destroyFcn=l;
this.m_registers[k][p].primary=true;if(k!=p){this.m_registers[p][k].createFcn=d;this.m_registers[p][k].destroyFcn=l;this.m_registers[p][k].primary=false;
}};m.prototype.InitializeRegisters=function(){this.m_registers=new Vector(v.e_shapeTypeCount);for(var d=0;d<v.e_shapeTypeCount;d++){this.m_registers[d]=new Vector(v.e_shapeTypeCount);
for(var k=0;k<v.e_shapeTypeCount;k++){this.m_registers[d][k]=new e;}}this.AddType(J.Create,J.Destroy,v.e_circleShape,v.e_circleShape);this.AddType(b.Create,b.Destroy,v.e_polygonShape,v.e_circleShape);
this.AddType(s.Create,s.Destroy,v.e_polygonShape,v.e_polygonShape);this.AddType(x.Create,x.Destroy,v.e_edgeShape,v.e_circleShape);this.AddType(ah.Create,ah.Destroy,v.e_polygonShape,v.e_edgeShape);
};m.prototype.Create=function(d,l){var k=parseInt(d.GetType()),p=parseInt(l.GetType());k=this.m_registers[k][p];if(k.pool){p=k.pool;k.pool=p.m_next;k.poolCount--;
p.Reset(d,l);return p;}p=k.createFcn;if(p!=null){if(k.primary){p=p(this.m_allocator);p.Reset(d,l);}else{p=p(this.m_allocator);p.Reset(l,d);}return p;}else{return null;
}};m.prototype.Destroy=function(d){if(d.m_manifold.m_pointCount>0){d.m_fixtureA.m_body.SetAwake(true);d.m_fixtureB.m_body.SetAwake(true);}var l=parseInt(d.m_fixtureA.GetType()),k=parseInt(d.m_fixtureB.GetType());
l=this.m_registers[l][k];l.poolCount++;d.m_next=l.pool;l.pool=d;l=l.destroyFcn;l(d,this.m_allocator);};e.b2ContactRegister=function(){};q.b2ContactResult=function(){this.position=new o;
this.normal=new o;this.id=new ak;};r.b2ContactSolver=function(){this.m_step=new C;this.m_constraints=new Vector;};r.prototype.b2ContactSolver=function(){};
r.prototype.Initialize=function(M,I,G,K){if(G===undefined){G=0;}var U;this.m_step.Set(M);this.m_allocator=K;M=0;for(this.m_constraintCount=G;this.m_constraints.length<this.m_constraintCount;
){this.m_constraints[this.m_constraints.length]=new f;}for(M=0;M<G;++M){U=I[M];K=U.m_fixtureA;var R=U.m_fixtureB,N=K.m_shape.m_radius,S=R.m_shape.m_radius,Q=K.m_body,O=R.m_body,L=U.GetManifold(),F=n.b2MixFriction(K.GetFriction(),R.GetFriction()),D=n.b2MixRestitution(K.GetRestitution(),R.GetRestitution()),A=Q.m_linearVelocity.x,B=Q.m_linearVelocity.y,z=O.m_linearVelocity.x,E=O.m_linearVelocity.y,y=Q.m_angularVelocity,k=O.m_angularVelocity;
n.b2Assert(L.m_pointCount>0);r.s_worldManifold.Initialize(L,Q.m_xf,N,O.m_xf,S);R=r.s_worldManifold.m_normal.x;U=r.s_worldManifold.m_normal.y;K=this.m_constraints[M];
K.bodyA=Q;K.bodyB=O;K.manifold=L;K.normal.x=R;K.normal.y=U;K.pointCount=L.m_pointCount;K.friction=F;K.restitution=D;K.localPlaneNormal.x=L.m_localPlaneNormal.x;
K.localPlaneNormal.y=L.m_localPlaneNormal.y;K.localPoint.x=L.m_localPoint.x;K.localPoint.y=L.m_localPoint.y;K.radius=N+S;K.type=L.m_type;for(N=0;N<K.pointCount;
++N){F=L.m_points[N];S=K.points[N];S.normalImpulse=F.m_normalImpulse;S.tangentImpulse=F.m_tangentImpulse;S.localPoint.SetV(F.m_localPoint);F=S.rA.x=r.s_worldManifold.m_points[N].x-Q.m_sweep.c.x;
D=S.rA.y=r.s_worldManifold.m_points[N].y-Q.m_sweep.c.y;var u=S.rB.x=r.s_worldManifold.m_points[N].x-O.m_sweep.c.x,d=S.rB.y=r.s_worldManifold.m_points[N].y-O.m_sweep.c.y,l=F*U-D*R,p=u*U-d*R;
l*=l;p*=p;S.normalMass=1/(Q.m_invMass+O.m_invMass+Q.m_invI*l+O.m_invI*p);var H=Q.m_mass*Q.m_invMass+O.m_mass*O.m_invMass;H+=Q.m_mass*Q.m_invI*l+O.m_mass*O.m_invI*p;
S.equalizedMass=1/H;p=U;H=-R;l=F*H-D*p;p=u*H-d*p;l*=l;p*=p;S.tangentMass=1/(Q.m_invMass+O.m_invMass+Q.m_invI*l+O.m_invI*p);S.velocityBias=0;F=K.normal.x*(z+-k*d-A- -y*D)+K.normal.y*(E+k*u-B-y*F);
if(F<-n.b2_velocityThreshold){S.velocityBias+=-K.restitution*F;}}if(K.pointCount==2){E=K.points[0];z=K.points[1];L=Q.m_invMass;Q=Q.m_invI;A=O.m_invMass;
O=O.m_invI;B=E.rA.x*U-E.rA.y*R;E=E.rB.x*U-E.rB.y*R;y=z.rA.x*U-z.rA.y*R;z=z.rB.x*U-z.rB.y*R;R=L+A+Q*B*B+O*E*E;U=L+A+Q*y*y+O*z*z;O=L+A+Q*B*y+O*E*z;if(R*R<100*(R*U-O*O)){K.K.col1.Set(R,O);
K.K.col2.Set(O,U);K.K.GetInverse(K.normalMass);}else{K.pointCount=1;}}}};r.prototype.InitVelocityConstraints=function(F){for(var B=0;B<this.m_constraintCount;
++B){var A=this.m_constraints[B],D=A.bodyA,M=A.bodyB,K=D.m_invMass,G=D.m_invI,L=M.m_invMass,I=M.m_invI,H=A.normal.x,E=A.normal.y,z=E,u=-H,l=0,p=0;if(F.warmStarting){p=A.pointCount;
for(l=0;l<p;++l){var k=A.points[l];k.normalImpulse*=F.dtRatio;k.tangentImpulse*=F.dtRatio;var y=k.normalImpulse*H+k.tangentImpulse*z,d=k.normalImpulse*E+k.tangentImpulse*u;
D.m_angularVelocity-=G*(k.rA.x*d-k.rA.y*y);D.m_linearVelocity.x-=K*y;D.m_linearVelocity.y-=K*d;M.m_angularVelocity+=I*(k.rB.x*d-k.rB.y*y);M.m_linearVelocity.x+=L*y;
M.m_linearVelocity.y+=L*d;}}else{p=A.pointCount;for(l=0;l<p;++l){D=A.points[l];D.normalImpulse=0;D.tangentImpulse=0;}}}};r.prototype.SolveVelocityConstraints=function(){for(var M=0,I,G=0,K=0,U=0,R=K=K=G=G=0,N=G=G=0,S=G=U=0,Q=0,O,L=0;
L<this.m_constraintCount;++L){U=this.m_constraints[L];var F=U.bodyA,D=U.bodyB,A=F.m_angularVelocity,B=D.m_angularVelocity,z=F.m_linearVelocity,E=D.m_linearVelocity,y=F.m_invMass,k=F.m_invI,u=D.m_invMass,d=D.m_invI;
S=U.normal.x;var l=Q=U.normal.y;O=-S;N=U.friction;for(M=0;M<U.pointCount;M++){I=U.points[M];G=E.x-B*I.rB.y-z.x+A*I.rA.y;K=E.y+B*I.rB.x-z.y-A*I.rA.x;G=G*l+K*O;
G=I.tangentMass*-G;K=N*I.normalImpulse;K=j.Clamp(I.tangentImpulse+G,-K,K);G=K-I.tangentImpulse;R=G*l;G=G*O;z.x-=y*R;z.y-=y*G;A-=k*(I.rA.x*G-I.rA.y*R);E.x+=u*R;
E.y+=u*G;B+=d*(I.rB.x*G-I.rB.y*R);I.tangentImpulse=K;}parseInt(U.pointCount);if(U.pointCount==1){I=U.points[0];G=E.x+-B*I.rB.y-z.x- -A*I.rA.y;K=E.y+B*I.rB.x-z.y-A*I.rA.x;
U=G*S+K*Q;G=-I.normalMass*(U-I.velocityBias);K=I.normalImpulse+G;K=K>0?K:0;G=K-I.normalImpulse;R=G*S;G=G*Q;z.x-=y*R;z.y-=y*G;A-=k*(I.rA.x*G-I.rA.y*R);E.x+=u*R;
E.y+=u*G;B+=d*(I.rB.x*G-I.rB.y*R);I.normalImpulse=K;}else{I=U.points[0];M=U.points[1];G=I.normalImpulse;N=M.normalImpulse;var p=(E.x-B*I.rB.y-z.x+A*I.rA.y)*S+(E.y+B*I.rB.x-z.y-A*I.rA.x)*Q,H=(E.x-B*M.rB.y-z.x+A*M.rA.y)*S+(E.y+B*M.rB.x-z.y-A*M.rA.x)*Q;
K=p-I.velocityBias;R=H-M.velocityBias;O=U.K;K-=O.col1.x*G+O.col2.x*N;for(R-=O.col1.y*G+O.col2.y*N;;){O=U.normalMass;l=-(O.col1.x*K+O.col2.x*R);O=-(O.col1.y*K+O.col2.y*R);
if(l>=0&&O>=0){G=l-G;N=O-N;U=G*S;G=G*Q;S=N*S;Q=N*Q;z.x-=y*(U+S);z.y-=y*(G+Q);A-=k*(I.rA.x*G-I.rA.y*U+M.rA.x*Q-M.rA.y*S);E.x+=u*(U+S);E.y+=u*(G+Q);B+=d*(I.rB.x*G-I.rB.y*U+M.rB.x*Q-M.rB.y*S);
I.normalImpulse=l;M.normalImpulse=O;break;}l=-I.normalMass*K;O=0;H=U.K.col1.y*l+R;if(l>=0&&H>=0){G=l-G;N=O-N;U=G*S;G=G*Q;S=N*S;Q=N*Q;z.x-=y*(U+S);z.y-=y*(G+Q);
A-=k*(I.rA.x*G-I.rA.y*U+M.rA.x*Q-M.rA.y*S);E.x+=u*(U+S);E.y+=u*(G+Q);B+=d*(I.rB.x*G-I.rB.y*U+M.rB.x*Q-M.rB.y*S);I.normalImpulse=l;M.normalImpulse=O;break;
}l=0;O=-M.normalMass*R;p=U.K.col2.x*O+K;if(O>=0&&p>=0){G=l-G;N=O-N;U=G*S;G=G*Q;S=N*S;Q=N*Q;z.x-=y*(U+S);z.y-=y*(G+Q);A-=k*(I.rA.x*G-I.rA.y*U+M.rA.x*Q-M.rA.y*S);
E.x+=u*(U+S);E.y+=u*(G+Q);B+=d*(I.rB.x*G-I.rB.y*U+M.rB.x*Q-M.rB.y*S);I.normalImpulse=l;M.normalImpulse=O;break;}O=l=0;p=K;H=R;if(p>=0&&H>=0){G=l-G;N=O-N;
U=G*S;G=G*Q;S=N*S;Q=N*Q;z.x-=y*(U+S);z.y-=y*(G+Q);A-=k*(I.rA.x*G-I.rA.y*U+M.rA.x*Q-M.rA.y*S);E.x+=u*(U+S);E.y+=u*(G+Q);B+=d*(I.rB.x*G-I.rB.y*U+M.rB.x*Q-M.rB.y*S);
I.normalImpulse=l;M.normalImpulse=O;break;}break;}}F.m_angularVelocity=A;D.m_angularVelocity=B;}};r.prototype.FinalizeVelocityConstraints=function(){for(var k=0;
k<this.m_constraintCount;++k){for(var p=this.m_constraints[k],l=p.manifold,y=0;y<p.pointCount;++y){var d=l.m_points[y],u=p.points[y];d.m_normalImpulse=u.normalImpulse;
d.m_tangentImpulse=u.tangentImpulse;}}};r.prototype.SolvePositionConstraints=function(F){if(F===undefined){F=0;}for(var B=0,A=0;A<this.m_constraintCount;
A++){var D=this.m_constraints[A],M=D.bodyA,K=D.bodyB,G=M.m_mass*M.m_invMass,L=M.m_mass*M.m_invI,I=K.m_mass*K.m_invMass,H=K.m_mass*K.m_invI;r.s_psm.Initialize(D);
for(var E=r.s_psm.m_normal,z=0;z<D.pointCount;z++){var u=D.points[z],l=r.s_psm.m_points[z],p=r.s_psm.m_separations[z],k=l.x-M.m_sweep.c.x,y=l.y-M.m_sweep.c.y,d=l.x-K.m_sweep.c.x;
l=l.y-K.m_sweep.c.y;B=B<p?B:p;p=j.Clamp(F*(p+n.b2_linearSlop),-n.b2_maxLinearCorrection,0);p=-u.equalizedMass*p;u=p*E.x;p=p*E.y;M.m_sweep.c.x-=G*u;M.m_sweep.c.y-=G*p;
M.m_sweep.a-=L*(k*p-y*u);M.SynchronizeTransform();K.m_sweep.c.x+=I*u;K.m_sweep.c.y+=I*p;K.m_sweep.a+=H*(d*p-l*u);K.SynchronizeTransform();}}return B>-1.5*n.b2_linearSlop;
};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new ag;Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new T;});
Box2D.inherit(x,Box2D.Dynamics.Contacts.b2Contact);x.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;x.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments);
};x.Create=function(){return new x;};x.Destroy=function(){};x.prototype.Reset=function(d,k){this.__super.Reset.call(this,d,k);};x.prototype.Evaluate=function(){var d=this.m_fixtureA.GetBody(),k=this.m_fixtureB.GetBody();
this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape() instanceof P?this.m_fixtureA.GetShape():null,d.m_xf,this.m_fixtureB.GetShape() instanceof X?this.m_fixtureB.GetShape():null,k.m_xf);
};x.prototype.b2CollideEdgeAndCircle=function(){};Box2D.inherit(c,Box2D.Dynamics.Contacts.b2Contact);c.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
c.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments);};c.prototype.b2NullContact=function(){this.__super.b2Contact.call(this);
};c.prototype.Evaluate=function(){};Box2D.inherit(b,Box2D.Dynamics.Contacts.b2Contact);b.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
b.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments);};b.Create=function(){return new b;};b.Destroy=function(){};
b.prototype.Reset=function(d,k){this.__super.Reset.call(this,d,k);n.b2Assert(d.GetType()==v.e_polygonShape);n.b2Assert(k.GetType()==v.e_circleShape);};
b.prototype.Evaluate=function(){var d=this.m_fixtureA.m_body,k=this.m_fixtureB.m_body;g.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape() instanceof t?this.m_fixtureA.GetShape():null,d.m_xf,this.m_fixtureB.GetShape() instanceof X?this.m_fixtureB.GetShape():null,k.m_xf);
};Box2D.inherit(ah,Box2D.Dynamics.Contacts.b2Contact);ah.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;ah.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments);
};ah.Create=function(){return new ah;};ah.Destroy=function(){};ah.prototype.Reset=function(d,k){this.__super.Reset.call(this,d,k);n.b2Assert(d.GetType()==v.e_polygonShape);
n.b2Assert(k.GetType()==v.e_edgeShape);};ah.prototype.Evaluate=function(){var d=this.m_fixtureA.GetBody(),k=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape() instanceof t?this.m_fixtureA.GetShape():null,d.m_xf,this.m_fixtureB.GetShape() instanceof P?this.m_fixtureB.GetShape():null,k.m_xf);
};ah.prototype.b2CollidePolyAndEdge=function(){};Box2D.inherit(s,Box2D.Dynamics.Contacts.b2Contact);s.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
s.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments);};s.Create=function(){return new s;};s.Destroy=function(){};
s.prototype.Reset=function(d,k){this.__super.Reset.call(this,d,k);};s.prototype.Evaluate=function(){var d=this.m_fixtureA.GetBody(),k=this.m_fixtureB.GetBody();
g.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape() instanceof t?this.m_fixtureA.GetShape():null,d.m_xf,this.m_fixtureB.GetShape() instanceof t?this.m_fixtureB.GetShape():null,k.m_xf);
};T.b2PositionSolverManifold=function(){};T.prototype.b2PositionSolverManifold=function(){this.m_normal=new o;this.m_separations=new Vector_a2j_Number(n.b2_maxManifoldPoints);
this.m_points=new Vector(n.b2_maxManifoldPoints);for(var d=0;d<n.b2_maxManifoldPoints;d++){this.m_points[d]=new o;}};T.prototype.Initialize=function(l){n.b2Assert(l.pointCount>0);
var y=0,u=0,A=0,k,z=0,p=0;switch(l.type){case a.e_circles:k=l.bodyA.m_xf.R;A=l.localPoint;y=l.bodyA.m_xf.position.x+(k.col1.x*A.x+k.col2.x*A.y);u=l.bodyA.m_xf.position.y+(k.col1.y*A.x+k.col2.y*A.y);
k=l.bodyB.m_xf.R;A=l.points[0].localPoint;z=l.bodyB.m_xf.position.x+(k.col1.x*A.x+k.col2.x*A.y);k=l.bodyB.m_xf.position.y+(k.col1.y*A.x+k.col2.y*A.y);A=z-y;
p=k-u;var d=A*A+p*p;if(d>Number.MIN_VALUE*Number.MIN_VALUE){d=Math.sqrt(d);this.m_normal.x=A/d;this.m_normal.y=p/d;}else{this.m_normal.x=1;this.m_normal.y=0;
}this.m_points[0].x=0.5*(y+z);this.m_points[0].y=0.5*(u+k);this.m_separations[0]=A*this.m_normal.x+p*this.m_normal.y-l.radius;break;case a.e_faceA:k=l.bodyA.m_xf.R;
A=l.localPlaneNormal;this.m_normal.x=k.col1.x*A.x+k.col2.x*A.y;this.m_normal.y=k.col1.y*A.x+k.col2.y*A.y;k=l.bodyA.m_xf.R;A=l.localPoint;z=l.bodyA.m_xf.position.x+(k.col1.x*A.x+k.col2.x*A.y);
p=l.bodyA.m_xf.position.y+(k.col1.y*A.x+k.col2.y*A.y);k=l.bodyB.m_xf.R;for(y=0;y<l.pointCount;++y){A=l.points[y].localPoint;u=l.bodyB.m_xf.position.x+(k.col1.x*A.x+k.col2.x*A.y);
A=l.bodyB.m_xf.position.y+(k.col1.y*A.x+k.col2.y*A.y);this.m_separations[y]=(u-z)*this.m_normal.x+(A-p)*this.m_normal.y-l.radius;this.m_points[y].x=u;this.m_points[y].y=A;
}break;case a.e_faceB:k=l.bodyB.m_xf.R;A=l.localPlaneNormal;this.m_normal.x=k.col1.x*A.x+k.col2.x*A.y;this.m_normal.y=k.col1.y*A.x+k.col2.y*A.y;k=l.bodyB.m_xf.R;
A=l.localPoint;z=l.bodyB.m_xf.position.x+(k.col1.x*A.x+k.col2.x*A.y);p=l.bodyB.m_xf.position.y+(k.col1.y*A.x+k.col2.y*A.y);k=l.bodyA.m_xf.R;for(y=0;y<l.pointCount;
++y){A=l.points[y].localPoint;u=l.bodyA.m_xf.position.x+(k.col1.x*A.x+k.col2.x*A.y);A=l.bodyA.m_xf.position.y+(k.col1.y*A.x+k.col2.y*A.y);this.m_separations[y]=(u-z)*this.m_normal.x+(A-p)*this.m_normal.y-l.radius;
this.m_points[y].Set(u,A);}this.m_normal.x*=-1;this.m_normal.y*=-1;}};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new o;
Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new o;});})();(function(){var m=Box2D.Common.Math.b2Mat22,l=Box2D.Common.Math.b2Math,j=Box2D.Common.Math.b2Vec2,g=Box2D.Common.b2Color,k=Box2D.Dynamics.Controllers.b2BuoyancyController,c=Box2D.Dynamics.Controllers.b2ConstantAccelController,e=Box2D.Dynamics.Controllers.b2ConstantForceController,b=Box2D.Dynamics.Controllers.b2Controller,a=Box2D.Dynamics.Controllers.b2ControllerEdge,f=Box2D.Dynamics.Controllers.b2GravityController,d=Box2D.Dynamics.Controllers.b2TensorDampingController;
Box2D.inherit(k,Box2D.Dynamics.Controllers.b2Controller);k.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;k.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);
this.normal=new j(0,-1);this.density=this.offset=0;this.velocity=new j(0,0);this.linearDrag=2;this.angularDrag=1;this.useDensity=false;this.useWorldGravity=true;
this.gravity=null;};k.prototype.Step=function(){if(this.m_bodyList){if(this.useWorldGravity){this.gravity=this.GetWorld().GetGravity().Copy();}for(var r=this.m_bodyList;
r;r=r.nextBody){var t=r.body;if(t.IsAwake()!=false){for(var v=new j,p=new j,o=0,q=0,s=t.GetFixtureList();s;s=s.GetNext()){var y=new j,n=s.GetShape().ComputeSubmergedArea(this.normal,this.offset,t.GetTransform(),y);
o+=n;v.x+=n*y.x;v.y+=n*y.y;var x=0;x=1;q+=n*x;p.x+=n*y.x*x;p.y+=n*y.y*x;}v.x/=o;v.y/=o;p.x/=q;p.y/=q;if(!(o<Number.MIN_VALUE)){q=this.gravity.GetNegative();
q.Multiply(this.density*o);t.ApplyForce(q,p);p=t.GetLinearVelocityFromWorldPoint(v);p.Subtract(this.velocity);p.Multiply(-this.linearDrag*o);t.ApplyForce(p,v);
t.ApplyTorque(-t.GetInertia()/t.GetMass()*o*t.GetAngularVelocity()*this.angularDrag);}}}}};k.prototype.Draw=function(q){var o=new j,p=new j;o.x=this.normal.x*this.offset+this.normal.y*1000;
o.y=this.normal.y*this.offset-this.normal.x*1000;p.x=this.normal.x*this.offset-this.normal.y*1000;p.y=this.normal.y*this.offset+this.normal.x*1000;var n=new g(0,0,1);
q.DrawSegment(o,p,n);};Box2D.inherit(c,Box2D.Dynamics.Controllers.b2Controller);c.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;c.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);
this.A=new j(0,0);};c.prototype.Step=function(p){p=new j(this.A.x*p.dt,this.A.y*p.dt);for(var n=this.m_bodyList;n;n=n.nextBody){var o=n.body;o.IsAwake()&&o.SetLinearVelocity(new j(o.GetLinearVelocity().x+p.x,o.GetLinearVelocity().y+p.y));
}};Box2D.inherit(e,Box2D.Dynamics.Controllers.b2Controller);e.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;e.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);
this.F=new j(0,0);};e.prototype.Step=function(){for(var o=this.m_bodyList;o;o=o.nextBody){var n=o.body;n.IsAwake()&&n.ApplyForce(this.F,n.GetWorldCenter());
}};b.b2Controller=function(){};b.prototype.Step=function(){};b.prototype.Draw=function(){};b.prototype.AddBody=function(o){var n=new a;n.controller=this;
n.body=o;n.nextBody=this.m_bodyList;n.prevBody=null;this.m_bodyList=n;if(n.nextBody){n.nextBody.prevBody=n;}this.m_bodyCount++;n.nextController=o.m_controllerList;
n.prevController=null;o.m_controllerList=n;if(n.nextController){n.nextController.prevController=n;}o.m_controllerCount++;};b.prototype.RemoveBody=function(o){for(var n=o.m_controllerList;
n&&n.controller!=this;){n=n.nextController;}if(n.prevBody){n.prevBody.nextBody=n.nextBody;}if(n.nextBody){n.nextBody.prevBody=n.prevBody;}if(n.nextController){n.nextController.prevController=n.prevController;
}if(n.prevController){n.prevController.nextController=n.nextController;}if(this.m_bodyList==n){this.m_bodyList=n.nextBody;}if(o.m_controllerList==n){o.m_controllerList=n.nextController;
}o.m_controllerCount--;this.m_bodyCount--;};b.prototype.Clear=function(){for(;this.m_bodyList;){this.RemoveBody(this.m_bodyList.body);}};b.prototype.GetNext=function(){return this.m_next;
};b.prototype.GetWorld=function(){return this.m_world;};b.prototype.GetBodyList=function(){return this.m_bodyList;};a.b2ControllerEdge=function(){};Box2D.inherit(f,Box2D.Dynamics.Controllers.b2Controller);
f.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;f.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);
this.G=1;this.invSqr=true;};f.prototype.Step=function(){var r=null,t=null,v=null,p=0,o=null,q=null,s=null,y=0,n=0,x=0;y=null;if(this.invSqr){for(r=this.m_bodyList;
r;r=r.nextBody){t=r.body;v=t.GetWorldCenter();p=t.GetMass();for(o=this.m_bodyList;o!=r;o=o.nextBody){q=o.body;s=q.GetWorldCenter();y=s.x-v.x;n=s.y-v.y;
x=y*y+n*n;if(!(x<Number.MIN_VALUE)){y=new j(y,n);y.Multiply(this.G/x/Math.sqrt(x)*p*q.GetMass());t.IsAwake()&&t.ApplyForce(y,v);y.Multiply(-1);q.IsAwake()&&q.ApplyForce(y,s);
}}}}else{for(r=this.m_bodyList;r;r=r.nextBody){t=r.body;v=t.GetWorldCenter();p=t.GetMass();for(o=this.m_bodyList;o!=r;o=o.nextBody){q=o.body;s=q.GetWorldCenter();
y=s.x-v.x;n=s.y-v.y;x=y*y+n*n;if(!(x<Number.MIN_VALUE)){y=new j(y,n);y.Multiply(this.G/x*p*q.GetMass());t.IsAwake()&&t.ApplyForce(y,v);y.Multiply(-1);q.IsAwake()&&q.ApplyForce(y,s);
}}}}};Box2D.inherit(d,Box2D.Dynamics.Controllers.b2Controller);d.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;d.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);
this.T=new m;this.maxTimestep=0;};d.prototype.SetAxisAligned=function(o,n){if(o===undefined){o=0;}if(n===undefined){n=0;}this.T.col1.x=-o;this.T.col1.y=0;
this.T.col2.x=0;this.T.col2.y=-n;this.maxTimestep=o>0||n>0?1/Math.max(o,n):0;};d.prototype.Step=function(q){q=q.dt;if(!(q<=Number.MIN_VALUE)){if(q>this.maxTimestep&&this.maxTimestep>0){q=this.maxTimestep;
}for(var o=this.m_bodyList;o;o=o.nextBody){var p=o.body;if(p.IsAwake()){var n=p.GetWorldVector(l.MulMV(this.T,p.GetLocalVector(p.GetLinearVelocity())));
p.SetLinearVelocity(new j(p.GetLinearVelocity().x+n.x*q,p.GetLinearVelocity().y+n.y*q));}}}};})();(function(){var P=Box2D.Common.b2Settings,C=Box2D.Common.Math.b2Mat22,r=Box2D.Common.Math.b2Mat33,s=Box2D.Common.Math.b2Math,x=Box2D.Common.Math.b2Vec2,ac=Box2D.Common.Math.b2Vec3,e=Box2D.Dynamics.Joints.b2DistanceJoint,ad=Box2D.Dynamics.Joints.b2DistanceJointDef,ab=Box2D.Dynamics.Joints.b2FrictionJoint,j=Box2D.Dynamics.Joints.b2FrictionJointDef,d=Box2D.Dynamics.Joints.b2GearJoint,n=Box2D.Dynamics.Joints.b2GearJointDef,o=Box2D.Dynamics.Joints.b2Jacobian,t=Box2D.Dynamics.Joints.b2Joint,c=Box2D.Dynamics.Joints.b2JointDef,b=Box2D.Dynamics.Joints.b2JointEdge,ae=Box2D.Dynamics.Joints.b2LineJoint,q=Box2D.Dynamics.Joints.b2LineJointDef,J=Box2D.Dynamics.Joints.b2MouseJoint,X=Box2D.Dynamics.Joints.b2MouseJointDef,v=Box2D.Dynamics.Joints.b2PrismaticJoint,l=Box2D.Dynamics.Joints.b2PrismaticJointDef,T=Box2D.Dynamics.Joints.b2PulleyJoint,g=Box2D.Dynamics.Joints.b2PulleyJointDef,m=Box2D.Dynamics.Joints.b2RevoluteJoint,f=Box2D.Dynamics.Joints.b2RevoluteJointDef,af=Box2D.Dynamics.Joints.b2WeldJoint,a=Box2D.Dynamics.Joints.b2WeldJointDef;
Box2D.inherit(e,Box2D.Dynamics.Joints.b2Joint);e.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;e.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);
this.m_localAnchor1=new x;this.m_localAnchor2=new x;this.m_u=new x;};e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
};e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);};e.prototype.GetReactionForce=function(k){if(k===undefined){k=0;
}return new x(k*this.m_impulse*this.m_u.x,k*this.m_impulse*this.m_u.y);};e.prototype.GetReactionTorque=function(){return 0;};e.prototype.GetLength=function(){return this.m_length;
};e.prototype.SetLength=function(k){if(k===undefined){k=0;}this.m_length=k;};e.prototype.GetFrequency=function(){return this.m_frequencyHz;};e.prototype.SetFrequency=function(k){if(k===undefined){k=0;
}this.m_frequencyHz=k;};e.prototype.GetDampingRatio=function(){return this.m_dampingRatio;};e.prototype.SetDampingRatio=function(k){if(k===undefined){k=0;
}this.m_dampingRatio=k;};e.prototype.b2DistanceJoint=function(k){this.__super.b2Joint.call(this,k);this.m_localAnchor1.SetV(k.localAnchorA);this.m_localAnchor2.SetV(k.localAnchorB);
this.m_length=k.length;this.m_frequencyHz=k.frequencyHz;this.m_dampingRatio=k.dampingRatio;this.m_bias=this.m_gamma=this.m_impulse=0;};e.prototype.InitVelocityConstraints=function(D){var A,y=0,z=this.m_bodyA,p=this.m_bodyB;
A=z.m_xf.R;var k=this.m_localAnchor1.x-z.m_sweep.localCenter.x,u=this.m_localAnchor1.y-z.m_sweep.localCenter.y;y=A.col1.x*k+A.col2.x*u;u=A.col1.y*k+A.col2.y*u;
k=y;A=p.m_xf.R;var G=this.m_localAnchor2.x-p.m_sweep.localCenter.x,E=this.m_localAnchor2.y-p.m_sweep.localCenter.y;y=A.col1.x*G+A.col2.x*E;E=A.col1.y*G+A.col2.y*E;
G=y;this.m_u.x=p.m_sweep.c.x+G-z.m_sweep.c.x-k;this.m_u.y=p.m_sweep.c.y+E-z.m_sweep.c.y-u;y=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);y>P.b2_linearSlop?this.m_u.Multiply(1/y):this.m_u.SetZero();
A=k*this.m_u.y-u*this.m_u.x;var B=G*this.m_u.y-E*this.m_u.x;A=z.m_invMass+z.m_invI*A*A+p.m_invMass+p.m_invI*B*B;this.m_mass=A!=0?1/A:0;if(this.m_frequencyHz>0){y=y-this.m_length;
B=2*Math.PI*this.m_frequencyHz;var F=this.m_mass*B*B;this.m_gamma=D.dt*(2*this.m_mass*this.m_dampingRatio*B+D.dt*F);this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;
this.m_bias=y*D.dt*F*this.m_gamma;this.m_mass=A+this.m_gamma;this.m_mass=this.m_mass!=0?1/this.m_mass:0;}if(D.warmStarting){this.m_impulse*=D.dtRatio;D=this.m_impulse*this.m_u.x;
A=this.m_impulse*this.m_u.y;z.m_linearVelocity.x-=z.m_invMass*D;z.m_linearVelocity.y-=z.m_invMass*A;z.m_angularVelocity-=z.m_invI*(k*A-u*D);p.m_linearVelocity.x+=p.m_invMass*D;
p.m_linearVelocity.y+=p.m_invMass*A;p.m_angularVelocity+=p.m_invI*(G*A-E*D);}else{this.m_impulse=0;}};e.prototype.SolveVelocityConstraints=function(){var B,y=this.m_bodyA,p=this.m_bodyB;
B=y.m_xf.R;var u=this.m_localAnchor1.x-y.m_sweep.localCenter.x,A=this.m_localAnchor1.y-y.m_sweep.localCenter.y,z=B.col1.x*u+B.col2.x*A;A=B.col1.y*u+B.col2.y*A;
u=z;B=p.m_xf.R;var D=this.m_localAnchor2.x-p.m_sweep.localCenter.x,k=this.m_localAnchor2.y-p.m_sweep.localCenter.y;z=B.col1.x*D+B.col2.x*k;k=B.col1.y*D+B.col2.y*k;
D=z;z=-this.m_mass*(this.m_u.x*(p.m_linearVelocity.x+-p.m_angularVelocity*k-(y.m_linearVelocity.x+-y.m_angularVelocity*A))+this.m_u.y*(p.m_linearVelocity.y+p.m_angularVelocity*D-(y.m_linearVelocity.y+y.m_angularVelocity*u))+this.m_bias+this.m_gamma*this.m_impulse);
this.m_impulse+=z;B=z*this.m_u.x;z=z*this.m_u.y;y.m_linearVelocity.x-=y.m_invMass*B;y.m_linearVelocity.y-=y.m_invMass*z;y.m_angularVelocity-=y.m_invI*(u*z-A*B);
p.m_linearVelocity.x+=p.m_invMass*B;p.m_linearVelocity.y+=p.m_invMass*z;p.m_angularVelocity+=p.m_invI*(D*z-k*B);};e.prototype.SolvePositionConstraints=function(){var D;
if(this.m_frequencyHz>0){return true;}var A=this.m_bodyA,y=this.m_bodyB;D=A.m_xf.R;var z=this.m_localAnchor1.x-A.m_sweep.localCenter.x,p=this.m_localAnchor1.y-A.m_sweep.localCenter.y,k=D.col1.x*z+D.col2.x*p;
p=D.col1.y*z+D.col2.y*p;z=k;D=y.m_xf.R;var u=this.m_localAnchor2.x-y.m_sweep.localCenter.x,F=this.m_localAnchor2.y-y.m_sweep.localCenter.y;k=D.col1.x*u+D.col2.x*F;
F=D.col1.y*u+D.col2.y*F;u=k;k=y.m_sweep.c.x+u-A.m_sweep.c.x-z;var E=y.m_sweep.c.y+F-A.m_sweep.c.y-p;D=Math.sqrt(k*k+E*E);k/=D;E/=D;D=D-this.m_length;D=s.Clamp(D,-P.b2_maxLinearCorrection,P.b2_maxLinearCorrection);
var B=-this.m_mass*D;this.m_u.Set(k,E);k=B*this.m_u.x;E=B*this.m_u.y;A.m_sweep.c.x-=A.m_invMass*k;A.m_sweep.c.y-=A.m_invMass*E;A.m_sweep.a-=A.m_invI*(z*E-p*k);
y.m_sweep.c.x+=y.m_invMass*k;y.m_sweep.c.y+=y.m_invMass*E;y.m_sweep.a+=y.m_invI*(u*E-F*k);A.SynchronizeTransform();y.SynchronizeTransform();return s.Abs(D)<P.b2_linearSlop;
};Box2D.inherit(ad,Box2D.Dynamics.Joints.b2JointDef);ad.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;ad.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);
this.localAnchorA=new x;this.localAnchorB=new x;};ad.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this);this.type=t.e_distanceJoint;
this.length=1;this.dampingRatio=this.frequencyHz=0;};ad.prototype.Initialize=function(y,u,k,p){this.bodyA=y;this.bodyB=u;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(k));
this.localAnchorB.SetV(this.bodyB.GetLocalPoint(p));y=p.x-k.x;k=p.y-k.y;this.length=Math.sqrt(y*y+k*k);this.dampingRatio=this.frequencyHz=0;};Box2D.inherit(ab,Box2D.Dynamics.Joints.b2Joint);
ab.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;ab.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);
this.m_localAnchorA=new x;this.m_localAnchorB=new x;this.m_linearMass=new C;this.m_linearImpulse=new x;};ab.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
};ab.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);};ab.prototype.GetReactionForce=function(k){if(k===undefined){k=0;
}return new x(k*this.m_linearImpulse.x,k*this.m_linearImpulse.y);};ab.prototype.GetReactionTorque=function(k){if(k===undefined){k=0;}return k*this.m_angularImpulse;
};ab.prototype.SetMaxForce=function(k){if(k===undefined){k=0;}this.m_maxForce=k;};ab.prototype.GetMaxForce=function(){return this.m_maxForce;};ab.prototype.SetMaxTorque=function(k){if(k===undefined){k=0;
}this.m_maxTorque=k;};ab.prototype.GetMaxTorque=function(){return this.m_maxTorque;};ab.prototype.b2FrictionJoint=function(k){this.__super.b2Joint.call(this,k);
this.m_localAnchorA.SetV(k.localAnchorA);this.m_localAnchorB.SetV(k.localAnchorB);this.m_linearMass.SetZero();this.m_angularMass=0;this.m_linearImpulse.SetZero();
this.m_angularImpulse=0;this.m_maxForce=k.maxForce;this.m_maxTorque=k.maxTorque;};ab.prototype.InitVelocityConstraints=function(E){var A,y=0,z=this.m_bodyA,p=this.m_bodyB;
A=z.m_xf.R;var k=this.m_localAnchorA.x-z.m_sweep.localCenter.x,u=this.m_localAnchorA.y-z.m_sweep.localCenter.y;y=A.col1.x*k+A.col2.x*u;u=A.col1.y*k+A.col2.y*u;
k=y;A=p.m_xf.R;var H=this.m_localAnchorB.x-p.m_sweep.localCenter.x,F=this.m_localAnchorB.y-p.m_sweep.localCenter.y;y=A.col1.x*H+A.col2.x*F;F=A.col1.y*H+A.col2.y*F;
H=y;A=z.m_invMass;y=p.m_invMass;var B=z.m_invI,G=p.m_invI,D=new C;D.col1.x=A+y;D.col2.x=0;D.col1.y=0;D.col2.y=A+y;D.col1.x+=B*u*u;D.col2.x+=-B*k*u;D.col1.y+=-B*k*u;
D.col2.y+=B*k*k;D.col1.x+=G*F*F;D.col2.x+=-G*H*F;D.col1.y+=-G*H*F;D.col2.y+=G*H*H;D.GetInverse(this.m_linearMass);this.m_angularMass=B+G;if(this.m_angularMass>0){this.m_angularMass=1/this.m_angularMass;
}if(E.warmStarting){this.m_linearImpulse.x*=E.dtRatio;this.m_linearImpulse.y*=E.dtRatio;this.m_angularImpulse*=E.dtRatio;E=this.m_linearImpulse;z.m_linearVelocity.x-=A*E.x;
z.m_linearVelocity.y-=A*E.y;z.m_angularVelocity-=B*(k*E.y-u*E.x+this.m_angularImpulse);p.m_linearVelocity.x+=y*E.x;p.m_linearVelocity.y+=y*E.y;p.m_angularVelocity+=G*(H*E.y-F*E.x+this.m_angularImpulse);
}else{this.m_linearImpulse.SetZero();this.m_angularImpulse=0;}};ab.prototype.SolveVelocityConstraints=function(L){var G,E=0,F=this.m_bodyA,A=this.m_bodyB,z=F.m_linearVelocity,B=F.m_angularVelocity,O=A.m_linearVelocity,M=A.m_angularVelocity,H=F.m_invMass,N=A.m_invMass,K=F.m_invI,I=A.m_invI;
G=F.m_xf.R;var D=this.m_localAnchorA.x-F.m_sweep.localCenter.x,y=this.m_localAnchorA.y-F.m_sweep.localCenter.y;E=G.col1.x*D+G.col2.x*y;y=G.col1.y*D+G.col2.y*y;
D=E;G=A.m_xf.R;var u=this.m_localAnchorB.x-A.m_sweep.localCenter.x,k=this.m_localAnchorB.y-A.m_sweep.localCenter.y;E=G.col1.x*u+G.col2.x*k;k=G.col1.y*u+G.col2.y*k;
u=E;G=0;E=-this.m_angularMass*(M-B);var p=this.m_angularImpulse;G=L.dt*this.m_maxTorque;this.m_angularImpulse=s.Clamp(this.m_angularImpulse+E,-G,G);E=this.m_angularImpulse-p;
B-=K*E;M+=I*E;G=s.MulMV(this.m_linearMass,new x(-(O.x-M*k-z.x+B*y),-(O.y+M*u-z.y-B*D)));E=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(G);G=L.dt*this.m_maxForce;
if(this.m_linearImpulse.LengthSquared()>G*G){this.m_linearImpulse.Normalize();this.m_linearImpulse.Multiply(G);}G=s.SubtractVV(this.m_linearImpulse,E);
z.x-=H*G.x;z.y-=H*G.y;B-=K*(D*G.y-y*G.x);O.x+=N*G.x;O.y+=N*G.y;M+=I*(u*G.y-k*G.x);F.m_angularVelocity=B;A.m_angularVelocity=M;};ab.prototype.SolvePositionConstraints=function(){return true;
};Box2D.inherit(j,Box2D.Dynamics.Joints.b2JointDef);j.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;j.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);
this.localAnchorA=new x;this.localAnchorB=new x;};j.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this);this.type=t.e_frictionJoint;
this.maxTorque=this.maxForce=0;};j.prototype.Initialize=function(u,p,k){this.bodyA=u;this.bodyB=p;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(k));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(k));
};Box2D.inherit(d,Box2D.Dynamics.Joints.b2Joint);d.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;d.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);
this.m_groundAnchor1=new x;this.m_groundAnchor2=new x;this.m_localAnchor1=new x;this.m_localAnchor2=new x;this.m_J=new o;};d.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
};d.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);};d.prototype.GetReactionForce=function(k){if(k===undefined){k=0;
}return new x(k*this.m_impulse*this.m_J.linearB.x,k*this.m_impulse*this.m_J.linearB.y);};d.prototype.GetReactionTorque=function(z){if(z===undefined){z=0;
}var u=this.m_bodyB.m_xf.R,k=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,p=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,y=u.col1.x*k+u.col2.x*p;
p=u.col1.y*k+u.col2.y*p;k=y;return z*(this.m_impulse*this.m_J.angularB-k*this.m_impulse*this.m_J.linearB.y+p*this.m_impulse*this.m_J.linearB.x);};d.prototype.GetRatio=function(){return this.m_ratio;
};d.prototype.SetRatio=function(k){if(k===undefined){k=0;}this.m_ratio=k;};d.prototype.b2GearJoint=function(z){this.__super.b2Joint.call(this,z);var u=parseInt(z.joint1.m_type),k=parseInt(z.joint2.m_type);
this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;var p=0,y=0;this.m_ground1=z.joint1.GetBodyA();this.m_bodyA=z.joint1.GetBodyB();
if(u==t.e_revoluteJoint){this.m_revolute1=z.joint1 instanceof m?z.joint1:null;this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1);this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2);
p=this.m_revolute1.GetJointAngle();}else{this.m_prismatic1=z.joint1 instanceof v?z.joint1:null;this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1);
this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2);p=this.m_prismatic1.GetJointTranslation();}this.m_ground2=z.joint2.GetBodyA();this.m_bodyB=z.joint2.GetBodyB();
if(k==t.e_revoluteJoint){this.m_revolute2=z.joint2 instanceof m?z.joint2:null;this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1);this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2);
y=this.m_revolute2.GetJointAngle();}else{this.m_prismatic2=z.joint2 instanceof v?z.joint2:null;this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1);
this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2);y=this.m_prismatic2.GetJointTranslation();}this.m_ratio=z.ratio;this.m_constant=p+this.m_ratio*y;
this.m_impulse=0;};d.prototype.InitVelocityConstraints=function(D){var A=this.m_ground1,y=this.m_ground2,z=this.m_bodyA,p=this.m_bodyB,k=0,u=0,G=0,E=0,B=G=0,F=0;
this.m_J.SetZero();if(this.m_revolute1){this.m_J.angularA=-1;F+=z.m_invI;}else{A=A.m_xf.R;u=this.m_prismatic1.m_localXAxis1;k=A.col1.x*u.x+A.col2.x*u.y;
u=A.col1.y*u.x+A.col2.y*u.y;A=z.m_xf.R;G=this.m_localAnchor1.x-z.m_sweep.localCenter.x;E=this.m_localAnchor1.y-z.m_sweep.localCenter.y;B=A.col1.x*G+A.col2.x*E;
E=A.col1.y*G+A.col2.y*E;G=B;G=G*u-E*k;this.m_J.linearA.Set(-k,-u);this.m_J.angularA=-G;F+=z.m_invMass+z.m_invI*G*G;}if(this.m_revolute2){this.m_J.angularB=-this.m_ratio;
F+=this.m_ratio*this.m_ratio*p.m_invI;}else{A=y.m_xf.R;u=this.m_prismatic2.m_localXAxis1;k=A.col1.x*u.x+A.col2.x*u.y;u=A.col1.y*u.x+A.col2.y*u.y;A=p.m_xf.R;
G=this.m_localAnchor2.x-p.m_sweep.localCenter.x;E=this.m_localAnchor2.y-p.m_sweep.localCenter.y;B=A.col1.x*G+A.col2.x*E;E=A.col1.y*G+A.col2.y*E;G=B;G=G*u-E*k;
this.m_J.linearB.Set(-this.m_ratio*k,-this.m_ratio*u);this.m_J.angularB=-this.m_ratio*G;F+=this.m_ratio*this.m_ratio*(p.m_invMass+p.m_invI*G*G);}this.m_mass=F>0?1/F:0;
if(D.warmStarting){z.m_linearVelocity.x+=z.m_invMass*this.m_impulse*this.m_J.linearA.x;z.m_linearVelocity.y+=z.m_invMass*this.m_impulse*this.m_J.linearA.y;
z.m_angularVelocity+=z.m_invI*this.m_impulse*this.m_J.angularA;p.m_linearVelocity.x+=p.m_invMass*this.m_impulse*this.m_J.linearB.x;p.m_linearVelocity.y+=p.m_invMass*this.m_impulse*this.m_J.linearB.y;
p.m_angularVelocity+=p.m_invI*this.m_impulse*this.m_J.angularB;}else{this.m_impulse=0;}};d.prototype.SolveVelocityConstraints=function(){var u=this.m_bodyA,p=this.m_bodyB,k=-this.m_mass*this.m_J.Compute(u.m_linearVelocity,u.m_angularVelocity,p.m_linearVelocity,p.m_angularVelocity);
this.m_impulse+=k;u.m_linearVelocity.x+=u.m_invMass*k*this.m_J.linearA.x;u.m_linearVelocity.y+=u.m_invMass*k*this.m_J.linearA.y;u.m_angularVelocity+=u.m_invI*k*this.m_J.angularA;
p.m_linearVelocity.x+=p.m_invMass*k*this.m_J.linearB.x;p.m_linearVelocity.y+=p.m_invMass*k*this.m_J.linearB.y;p.m_angularVelocity+=p.m_invI*k*this.m_J.angularB;
};d.prototype.SolvePositionConstraints=function(){var y=this.m_bodyA,u=this.m_bodyB,k=0,p=0;k=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation();
p=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();k=-this.m_mass*(this.m_constant-(k+this.m_ratio*p));y.m_sweep.c.x+=y.m_invMass*k*this.m_J.linearA.x;
y.m_sweep.c.y+=y.m_invMass*k*this.m_J.linearA.y;y.m_sweep.a+=y.m_invI*k*this.m_J.angularA;u.m_sweep.c.x+=u.m_invMass*k*this.m_J.linearB.x;u.m_sweep.c.y+=u.m_invMass*k*this.m_J.linearB.y;
u.m_sweep.a+=u.m_invI*k*this.m_J.angularB;y.SynchronizeTransform();u.SynchronizeTransform();return 0<P.b2_linearSlop;};Box2D.inherit(n,Box2D.Dynamics.Joints.b2JointDef);
n.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;n.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);
};n.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this);this.type=t.e_gearJoint;this.joint2=this.joint1=null;this.ratio=1;};o.b2Jacobian=function(){this.linearA=new x;
this.linearB=new x;};o.prototype.SetZero=function(){this.linearA.SetZero();this.angularA=0;this.linearB.SetZero();this.angularB=0;};o.prototype.Set=function(y,u,k,p){if(u===undefined){u=0;
}if(p===undefined){p=0;}this.linearA.SetV(y);this.angularA=u;this.linearB.SetV(k);this.angularB=p;};o.prototype.Compute=function(y,u,k,p){if(u===undefined){u=0;
}if(p===undefined){p=0;}return this.linearA.x*y.x+this.linearA.y*y.y+this.angularA*u+(this.linearB.x*k.x+this.linearB.y*k.y)+this.angularB*p;};t.b2Joint=function(){this.m_edgeA=new b;
this.m_edgeB=new b;this.m_localCenterA=new x;this.m_localCenterB=new x;};t.prototype.GetType=function(){return this.m_type;};t.prototype.GetAnchorA=function(){return null;
};t.prototype.GetAnchorB=function(){return null;};t.prototype.GetReactionForce=function(){return null;};t.prototype.GetReactionTorque=function(){return 0;
};t.prototype.GetBodyA=function(){return this.m_bodyA;};t.prototype.GetBodyB=function(){return this.m_bodyB;};t.prototype.GetNext=function(){return this.m_next;
};t.prototype.GetUserData=function(){return this.m_userData;};t.prototype.SetUserData=function(k){this.m_userData=k;};t.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive();
};t.Create=function(p){var k=null;switch(p.type){case t.e_distanceJoint:k=new e(p instanceof ad?p:null);break;case t.e_mouseJoint:k=new J(p instanceof X?p:null);
break;case t.e_prismaticJoint:k=new v(p instanceof l?p:null);break;case t.e_revoluteJoint:k=new m(p instanceof f?p:null);break;case t.e_pulleyJoint:k=new T(p instanceof g?p:null);
break;case t.e_gearJoint:k=new d(p instanceof n?p:null);break;case t.e_lineJoint:k=new ae(p instanceof q?p:null);break;case t.e_weldJoint:k=new af(p instanceof a?p:null);
break;case t.e_frictionJoint:k=new ab(p instanceof j?p:null);}return k;};t.Destroy=function(){};t.prototype.b2Joint=function(k){P.b2Assert(k.bodyA!=k.bodyB);
this.m_type=k.type;this.m_next=this.m_prev=null;this.m_bodyA=k.bodyA;this.m_bodyB=k.bodyB;this.m_collideConnected=k.collideConnected;this.m_islandFlag=false;
this.m_userData=k.userData;};t.prototype.InitVelocityConstraints=function(){};t.prototype.SolveVelocityConstraints=function(){};t.prototype.FinalizeVelocityConstraints=function(){};
t.prototype.SolvePositionConstraints=function(){return false;};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0;Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1;
Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2;Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3;Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4;Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5;
Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6;Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7;Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8;Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9;
Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0;Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1;Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2;Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3;
});c.b2JointDef=function(){};c.prototype.b2JointDef=function(){this.type=t.e_unknownJoint;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=false;
};b.b2JointEdge=function(){};Box2D.inherit(ae,Box2D.Dynamics.Joints.b2Joint);ae.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;ae.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);
this.m_localAnchor1=new x;this.m_localAnchor2=new x;this.m_localXAxis1=new x;this.m_localYAxis1=new x;this.m_axis=new x;this.m_perp=new x;this.m_K=new C;
this.m_impulse=new x;};ae.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);};ae.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
};ae.prototype.GetReactionForce=function(k){if(k===undefined){k=0;}return new x(k*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),k*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y));
};ae.prototype.GetReactionTorque=function(k){if(k===undefined){k=0;}return k*this.m_impulse.y;};ae.prototype.GetJointTranslation=function(){var y=this.m_bodyA,u=this.m_bodyB,k=y.GetWorldPoint(this.m_localAnchor1),p=u.GetWorldPoint(this.m_localAnchor2);
u=p.x-k.x;k=p.y-k.y;y=y.GetWorldVector(this.m_localXAxis1);return y.x*u+y.y*k;};ae.prototype.GetJointSpeed=function(){var D=this.m_bodyA,A=this.m_bodyB,y;
y=D.m_xf.R;var z=this.m_localAnchor1.x-D.m_sweep.localCenter.x,p=this.m_localAnchor1.y-D.m_sweep.localCenter.y,k=y.col1.x*z+y.col2.x*p;p=y.col1.y*z+y.col2.y*p;
z=k;y=A.m_xf.R;var u=this.m_localAnchor2.x-A.m_sweep.localCenter.x,G=this.m_localAnchor2.y-A.m_sweep.localCenter.y;k=y.col1.x*u+y.col2.x*G;G=y.col1.y*u+y.col2.y*G;
u=k;y=A.m_sweep.c.x+u-(D.m_sweep.c.x+z);k=A.m_sweep.c.y+G-(D.m_sweep.c.y+p);var E=D.GetWorldVector(this.m_localXAxis1),B=D.m_linearVelocity,F=A.m_linearVelocity;
D=D.m_angularVelocity;A=A.m_angularVelocity;return y*-D*E.y+k*D*E.x+(E.x*(F.x+-A*G-B.x- -D*p)+E.y*(F.y+A*u-B.y-D*z));};ae.prototype.IsLimitEnabled=function(){return this.m_enableLimit;
};ae.prototype.EnableLimit=function(k){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableLimit=k;};ae.prototype.GetLowerLimit=function(){return this.m_lowerTranslation;
};ae.prototype.GetUpperLimit=function(){return this.m_upperTranslation;};ae.prototype.SetLimits=function(p,k){if(p===undefined){p=0;}if(k===undefined){k=0;
}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_lowerTranslation=p;this.m_upperTranslation=k;};ae.prototype.IsMotorEnabled=function(){return this.m_enableMotor;
};ae.prototype.EnableMotor=function(k){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableMotor=k;};ae.prototype.SetMotorSpeed=function(k){if(k===undefined){k=0;
}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=k;};ae.prototype.GetMotorSpeed=function(){return this.m_motorSpeed;};ae.prototype.SetMaxMotorForce=function(k){if(k===undefined){k=0;
}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_maxMotorForce=k;};ae.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce;
};ae.prototype.GetMotorForce=function(){return this.m_motorImpulse;};ae.prototype.b2LineJoint=function(k){this.__super.b2Joint.call(this,k);this.m_localAnchor1.SetV(k.localAnchorA);
this.m_localAnchor2.SetV(k.localAnchorB);this.m_localXAxis1.SetV(k.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;
this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=k.lowerTranslation;this.m_upperTranslation=k.upperTranslation;this.m_maxMotorForce=k.maxMotorForce;
this.m_motorSpeed=k.motorSpeed;this.m_enableLimit=k.enableLimit;this.m_enableMotor=k.enableMotor;this.m_limitState=t.e_inactiveLimit;this.m_axis.SetZero();
this.m_perp.SetZero();};ae.prototype.InitVelocityConstraints=function(D){var A=this.m_bodyA,y=this.m_bodyB,z,p=0;this.m_localCenterA.SetV(A.GetLocalCenter());
this.m_localCenterB.SetV(y.GetLocalCenter());var k=A.GetTransform();y.GetTransform();z=A.m_xf.R;var u=this.m_localAnchor1.x-this.m_localCenterA.x,F=this.m_localAnchor1.y-this.m_localCenterA.y;
p=z.col1.x*u+z.col2.x*F;F=z.col1.y*u+z.col2.y*F;u=p;z=y.m_xf.R;var E=this.m_localAnchor2.x-this.m_localCenterB.x,B=this.m_localAnchor2.y-this.m_localCenterB.y;
p=z.col1.x*E+z.col2.x*B;B=z.col1.y*E+z.col2.y*B;E=p;z=y.m_sweep.c.x+E-A.m_sweep.c.x-u;p=y.m_sweep.c.y+B-A.m_sweep.c.y-F;this.m_invMassA=A.m_invMass;this.m_invMassB=y.m_invMass;
this.m_invIA=A.m_invI;this.m_invIB=y.m_invI;this.m_axis.SetV(s.MulMV(k.R,this.m_localXAxis1));this.m_a1=(z+u)*this.m_axis.y-(p+F)*this.m_axis.x;this.m_a2=E*this.m_axis.y-B*this.m_axis.x;
this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;
this.m_perp.SetV(s.MulMV(k.R,this.m_localYAxis1));this.m_s1=(z+u)*this.m_perp.y-(p+F)*this.m_perp.x;this.m_s2=E*this.m_perp.y-B*this.m_perp.x;k=this.m_invMassA;
u=this.m_invMassB;F=this.m_invIA;E=this.m_invIB;this.m_K.col1.x=k+u+F*this.m_s1*this.m_s1+E*this.m_s2*this.m_s2;this.m_K.col1.y=F*this.m_s1*this.m_a1+E*this.m_s2*this.m_a2;
this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=k+u+F*this.m_a1*this.m_a1+E*this.m_a2*this.m_a2;if(this.m_enableLimit){z=this.m_axis.x*z+this.m_axis.y*p;
if(s.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*P.b2_linearSlop){this.m_limitState=t.e_equalLimits;}else{if(z<=this.m_lowerTranslation){if(this.m_limitState!=t.e_atLowerLimit){this.m_limitState=t.e_atLowerLimit;
this.m_impulse.y=0;}}else{if(z>=this.m_upperTranslation){if(this.m_limitState!=t.e_atUpperLimit){this.m_limitState=t.e_atUpperLimit;this.m_impulse.y=0;
}}else{this.m_limitState=t.e_inactiveLimit;this.m_impulse.y=0;}}}}else{this.m_limitState=t.e_inactiveLimit;}if(this.m_enableMotor==false){this.m_motorImpulse=0;
}if(D.warmStarting){this.m_impulse.x*=D.dtRatio;this.m_impulse.y*=D.dtRatio;this.m_motorImpulse*=D.dtRatio;D=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x;
z=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y;p=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1;
k=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;A.m_linearVelocity.x-=this.m_invMassA*D;A.m_linearVelocity.y-=this.m_invMassA*z;
A.m_angularVelocity-=this.m_invIA*p;y.m_linearVelocity.x+=this.m_invMassB*D;y.m_linearVelocity.y+=this.m_invMassB*z;y.m_angularVelocity+=this.m_invIB*k;
}else{this.m_impulse.SetZero();this.m_motorImpulse=0;}};ae.prototype.SolveVelocityConstraints=function(D){var A=this.m_bodyA,y=this.m_bodyB,z=A.m_linearVelocity,p=A.m_angularVelocity,k=y.m_linearVelocity,u=y.m_angularVelocity,G=0,E=0,B=0,F=0;
if(this.m_enableMotor&&this.m_limitState!=t.e_equalLimits){F=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(k.x-z.x)+this.m_axis.y*(k.y-z.y)+this.m_a2*u-this.m_a1*p));
G=this.m_motorImpulse;E=D.dt*this.m_maxMotorForce;this.m_motorImpulse=s.Clamp(this.m_motorImpulse+F,-E,E);F=this.m_motorImpulse-G;G=F*this.m_axis.x;E=F*this.m_axis.y;
B=F*this.m_a1;F=F*this.m_a2;z.x-=this.m_invMassA*G;z.y-=this.m_invMassA*E;p-=this.m_invIA*B;k.x+=this.m_invMassB*G;k.y+=this.m_invMassB*E;u+=this.m_invIB*F;
}E=this.m_perp.x*(k.x-z.x)+this.m_perp.y*(k.y-z.y)+this.m_s2*u-this.m_s1*p;if(this.m_enableLimit&&this.m_limitState!=t.e_inactiveLimit){B=this.m_axis.x*(k.x-z.x)+this.m_axis.y*(k.y-z.y)+this.m_a2*u-this.m_a1*p;
G=this.m_impulse.Copy();D=this.m_K.Solve(new x,-E,-B);this.m_impulse.Add(D);if(this.m_limitState==t.e_atLowerLimit){this.m_impulse.y=s.Max(this.m_impulse.y,0);
}else{if(this.m_limitState==t.e_atUpperLimit){this.m_impulse.y=s.Min(this.m_impulse.y,0);}}E=-E-(this.m_impulse.y-G.y)*this.m_K.col2.x;B=0;B=this.m_K.col1.x!=0?E/this.m_K.col1.x+G.x:G.x;
this.m_impulse.x=B;D.x=this.m_impulse.x-G.x;D.y=this.m_impulse.y-G.y;G=D.x*this.m_perp.x+D.y*this.m_axis.x;E=D.x*this.m_perp.y+D.y*this.m_axis.y;B=D.x*this.m_s1+D.y*this.m_a1;
F=D.x*this.m_s2+D.y*this.m_a2;}else{D=0;D=this.m_K.col1.x!=0?-E/this.m_K.col1.x:0;this.m_impulse.x+=D;G=D*this.m_perp.x;E=D*this.m_perp.y;B=D*this.m_s1;
F=D*this.m_s2;}z.x-=this.m_invMassA*G;z.y-=this.m_invMassA*E;p-=this.m_invIA*B;k.x+=this.m_invMassB*G;k.y+=this.m_invMassB*E;u+=this.m_invIB*F;A.m_linearVelocity.SetV(z);
A.m_angularVelocity=p;y.m_linearVelocity.SetV(k);y.m_angularVelocity=u;};ae.prototype.SolvePositionConstraints=function(){var H=this.m_bodyA,D=this.m_bodyB,A=H.m_sweep.c,B=H.m_sweep.a,u=D.m_sweep.c,p=D.m_sweep.a,y,L=0,I=0,E=0,K=0,G=y=0,F=0;
I=false;var z=0,k=C.FromAngle(B);E=C.FromAngle(p);y=k;F=this.m_localAnchor1.x-this.m_localCenterA.x;var N=this.m_localAnchor1.y-this.m_localCenterA.y;L=y.col1.x*F+y.col2.x*N;
N=y.col1.y*F+y.col2.y*N;F=L;y=E;E=this.m_localAnchor2.x-this.m_localCenterB.x;K=this.m_localAnchor2.y-this.m_localCenterB.y;L=y.col1.x*E+y.col2.x*K;K=y.col1.y*E+y.col2.y*K;
E=L;y=u.x+E-A.x-F;L=u.y+K-A.y-N;if(this.m_enableLimit){this.m_axis=s.MulMV(k,this.m_localXAxis1);this.m_a1=(y+F)*this.m_axis.y-(L+N)*this.m_axis.x;this.m_a2=E*this.m_axis.y-K*this.m_axis.x;
var M=this.m_axis.x*y+this.m_axis.y*L;if(s.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*P.b2_linearSlop){z=s.Clamp(M,-P.b2_maxLinearCorrection,P.b2_maxLinearCorrection);
G=s.Abs(M);I=true;}else{if(M<=this.m_lowerTranslation){z=s.Clamp(M-this.m_lowerTranslation+P.b2_linearSlop,-P.b2_maxLinearCorrection,0);G=this.m_lowerTranslation-M;
I=true;}else{if(M>=this.m_upperTranslation){z=s.Clamp(M-this.m_upperTranslation+P.b2_linearSlop,0,P.b2_maxLinearCorrection);G=M-this.m_upperTranslation;
I=true;}}}}this.m_perp=s.MulMV(k,this.m_localYAxis1);this.m_s1=(y+F)*this.m_perp.y-(L+N)*this.m_perp.x;this.m_s2=E*this.m_perp.y-K*this.m_perp.x;k=new x;
N=this.m_perp.x*y+this.m_perp.y*L;G=s.Max(G,s.Abs(N));F=0;if(I){I=this.m_invMassA;E=this.m_invMassB;K=this.m_invIA;y=this.m_invIB;this.m_K.col1.x=I+E+K*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2;
this.m_K.col1.y=K*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=I+E+K*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2;
this.m_K.Solve(k,-N,-z);}else{I=this.m_invMassA;E=this.m_invMassB;K=this.m_invIA;y=this.m_invIB;z=I+E+K*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2;I=0;I=z!=0?-N/z:0;
k.x=I;k.y=0;}z=k.x*this.m_perp.x+k.y*this.m_axis.x;I=k.x*this.m_perp.y+k.y*this.m_axis.y;N=k.x*this.m_s1+k.y*this.m_a1;k=k.x*this.m_s2+k.y*this.m_a2;A.x-=this.m_invMassA*z;
A.y-=this.m_invMassA*I;B-=this.m_invIA*N;u.x+=this.m_invMassB*z;u.y+=this.m_invMassB*I;p+=this.m_invIB*k;H.m_sweep.a=B;D.m_sweep.a=p;H.SynchronizeTransform();
D.SynchronizeTransform();return G<=P.b2_linearSlop&&F<=P.b2_angularSlop;};Box2D.inherit(q,Box2D.Dynamics.Joints.b2JointDef);q.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;
q.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new x;this.localAnchorB=new x;this.localAxisA=new x;
};q.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this);this.type=t.e_lineJoint;this.localAxisA.Set(1,0);this.enableLimit=false;this.upperTranslation=this.lowerTranslation=0;
this.enableMotor=false;this.motorSpeed=this.maxMotorForce=0;};q.prototype.Initialize=function(y,u,k,p){this.bodyA=y;this.bodyB=u;this.localAnchorA=this.bodyA.GetLocalPoint(k);
this.localAnchorB=this.bodyB.GetLocalPoint(k);this.localAxisA=this.bodyA.GetLocalVector(p);};Box2D.inherit(J,Box2D.Dynamics.Joints.b2Joint);J.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;
J.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new C;this.K1=new C;this.K2=new C;this.m_localAnchor=new x;
this.m_target=new x;this.m_impulse=new x;this.m_mass=new C;this.m_C=new x;};J.prototype.GetAnchorA=function(){return this.m_target;};J.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor);
};J.prototype.GetReactionForce=function(k){if(k===undefined){k=0;}return new x(k*this.m_impulse.x,k*this.m_impulse.y);};J.prototype.GetReactionTorque=function(){return 0;
};J.prototype.GetTarget=function(){return this.m_target;};J.prototype.SetTarget=function(k){this.m_bodyB.IsAwake()==false&&this.m_bodyB.SetAwake(true);
this.m_target=k;};J.prototype.GetMaxForce=function(){return this.m_maxForce;};J.prototype.SetMaxForce=function(k){if(k===undefined){k=0;}this.m_maxForce=k;
};J.prototype.GetFrequency=function(){return this.m_frequencyHz;};J.prototype.SetFrequency=function(k){if(k===undefined){k=0;}this.m_frequencyHz=k;};J.prototype.GetDampingRatio=function(){return this.m_dampingRatio;
};J.prototype.SetDampingRatio=function(k){if(k===undefined){k=0;}this.m_dampingRatio=k;};J.prototype.b2MouseJoint=function(y){this.__super.b2Joint.call(this,y);
this.m_target.SetV(y.target);var u=this.m_target.x-this.m_bodyB.m_xf.position.x,k=this.m_target.y-this.m_bodyB.m_xf.position.y,p=this.m_bodyB.m_xf.R;this.m_localAnchor.x=u*p.col1.x+k*p.col1.y;
this.m_localAnchor.y=u*p.col2.x+k*p.col2.y;this.m_maxForce=y.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=y.frequencyHz;this.m_dampingRatio=y.dampingRatio;
this.m_gamma=this.m_beta=0;};J.prototype.InitVelocityConstraints=function(A){var u=this.m_bodyB,k=u.GetMass(),p=2*Math.PI*this.m_frequencyHz,z=k*p*p;this.m_gamma=A.dt*(2*k*this.m_dampingRatio*p+A.dt*z);
this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;this.m_beta=A.dt*z*this.m_gamma;z=u.m_xf.R;k=this.m_localAnchor.x-u.m_sweep.localCenter.x;p=this.m_localAnchor.y-u.m_sweep.localCenter.y;
var y=z.col1.x*k+z.col2.x*p;p=z.col1.y*k+z.col2.y*p;k=y;z=u.m_invMass;y=u.m_invI;this.K1.col1.x=z;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=z;this.K2.col1.x=y*p*p;
this.K2.col2.x=-y*k*p;this.K2.col1.y=-y*k*p;this.K2.col2.y=y*k*k;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;
this.K.GetInverse(this.m_mass);this.m_C.x=u.m_sweep.c.x+k-this.m_target.x;this.m_C.y=u.m_sweep.c.y+p-this.m_target.y;u.m_angularVelocity*=0.98;this.m_impulse.x*=A.dtRatio;
this.m_impulse.y*=A.dtRatio;u.m_linearVelocity.x+=z*this.m_impulse.x;u.m_linearVelocity.y+=z*this.m_impulse.y;u.m_angularVelocity+=y*(k*this.m_impulse.y-p*this.m_impulse.x);
};J.prototype.SolveVelocityConstraints=function(B){var y=this.m_bodyB,p,u=0,A=0;p=y.m_xf.R;var z=this.m_localAnchor.x-y.m_sweep.localCenter.x,D=this.m_localAnchor.y-y.m_sweep.localCenter.y;
u=p.col1.x*z+p.col2.x*D;D=p.col1.y*z+p.col2.y*D;z=u;u=y.m_linearVelocity.x+-y.m_angularVelocity*D;var k=y.m_linearVelocity.y+y.m_angularVelocity*z;p=this.m_mass;
u=u+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;A=k+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;k=-(p.col1.x*u+p.col2.x*A);A=-(p.col1.y*u+p.col2.y*A);
p=this.m_impulse.x;u=this.m_impulse.y;this.m_impulse.x+=k;this.m_impulse.y+=A;B=B.dt*this.m_maxForce;this.m_impulse.LengthSquared()>B*B&&this.m_impulse.Multiply(B/this.m_impulse.Length());
k=this.m_impulse.x-p;A=this.m_impulse.y-u;y.m_linearVelocity.x+=y.m_invMass*k;y.m_linearVelocity.y+=y.m_invMass*A;y.m_angularVelocity+=y.m_invI*(z*A-D*k);
};J.prototype.SolvePositionConstraints=function(){return true;};Box2D.inherit(X,Box2D.Dynamics.Joints.b2JointDef);X.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;
X.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.target=new x;};X.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this);
this.type=t.e_mouseJoint;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7;};Box2D.inherit(v,Box2D.Dynamics.Joints.b2Joint);v.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;
v.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new x;this.m_localAnchor2=new x;this.m_localXAxis1=new x;
this.m_localYAxis1=new x;this.m_axis=new x;this.m_perp=new x;this.m_K=new r;this.m_impulse=new ac;};v.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
};v.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);};v.prototype.GetReactionForce=function(k){if(k===undefined){k=0;
}return new x(k*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),k*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y));
};v.prototype.GetReactionTorque=function(k){if(k===undefined){k=0;}return k*this.m_impulse.y;};v.prototype.GetJointTranslation=function(){var y=this.m_bodyA,u=this.m_bodyB,k=y.GetWorldPoint(this.m_localAnchor1),p=u.GetWorldPoint(this.m_localAnchor2);
u=p.x-k.x;k=p.y-k.y;y=y.GetWorldVector(this.m_localXAxis1);return y.x*u+y.y*k;};v.prototype.GetJointSpeed=function(){var D=this.m_bodyA,A=this.m_bodyB,y;
y=D.m_xf.R;var z=this.m_localAnchor1.x-D.m_sweep.localCenter.x,p=this.m_localAnchor1.y-D.m_sweep.localCenter.y,k=y.col1.x*z+y.col2.x*p;p=y.col1.y*z+y.col2.y*p;
z=k;y=A.m_xf.R;var u=this.m_localAnchor2.x-A.m_sweep.localCenter.x,G=this.m_localAnchor2.y-A.m_sweep.localCenter.y;k=y.col1.x*u+y.col2.x*G;G=y.col1.y*u+y.col2.y*G;
u=k;y=A.m_sweep.c.x+u-(D.m_sweep.c.x+z);k=A.m_sweep.c.y+G-(D.m_sweep.c.y+p);var E=D.GetWorldVector(this.m_localXAxis1),B=D.m_linearVelocity,F=A.m_linearVelocity;
D=D.m_angularVelocity;A=A.m_angularVelocity;return y*-D*E.y+k*D*E.x+(E.x*(F.x+-A*G-B.x- -D*p)+E.y*(F.y+A*u-B.y-D*z));};v.prototype.IsLimitEnabled=function(){return this.m_enableLimit;
};v.prototype.EnableLimit=function(k){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableLimit=k;};v.prototype.GetLowerLimit=function(){return this.m_lowerTranslation;
};v.prototype.GetUpperLimit=function(){return this.m_upperTranslation;};v.prototype.SetLimits=function(p,k){if(p===undefined){p=0;}if(k===undefined){k=0;
}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_lowerTranslation=p;this.m_upperTranslation=k;};v.prototype.IsMotorEnabled=function(){return this.m_enableMotor;
};v.prototype.EnableMotor=function(k){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableMotor=k;};v.prototype.SetMotorSpeed=function(k){if(k===undefined){k=0;
}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=k;};v.prototype.GetMotorSpeed=function(){return this.m_motorSpeed;};v.prototype.SetMaxMotorForce=function(k){if(k===undefined){k=0;
}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_maxMotorForce=k;};v.prototype.GetMotorForce=function(){return this.m_motorImpulse;};v.prototype.b2PrismaticJoint=function(k){this.__super.b2Joint.call(this,k);
this.m_localAnchor1.SetV(k.localAnchorA);this.m_localAnchor2.SetV(k.localAnchorB);this.m_localXAxis1.SetV(k.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;
this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=k.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=k.lowerTranslation;
this.m_upperTranslation=k.upperTranslation;this.m_maxMotorForce=k.maxMotorForce;this.m_motorSpeed=k.motorSpeed;this.m_enableLimit=k.enableLimit;this.m_enableMotor=k.enableMotor;
this.m_limitState=t.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero();};v.prototype.InitVelocityConstraints=function(D){var A=this.m_bodyA,y=this.m_bodyB,z,p=0;
this.m_localCenterA.SetV(A.GetLocalCenter());this.m_localCenterB.SetV(y.GetLocalCenter());var k=A.GetTransform();y.GetTransform();z=A.m_xf.R;var u=this.m_localAnchor1.x-this.m_localCenterA.x,F=this.m_localAnchor1.y-this.m_localCenterA.y;
p=z.col1.x*u+z.col2.x*F;F=z.col1.y*u+z.col2.y*F;u=p;z=y.m_xf.R;var E=this.m_localAnchor2.x-this.m_localCenterB.x,B=this.m_localAnchor2.y-this.m_localCenterB.y;
p=z.col1.x*E+z.col2.x*B;B=z.col1.y*E+z.col2.y*B;E=p;z=y.m_sweep.c.x+E-A.m_sweep.c.x-u;p=y.m_sweep.c.y+B-A.m_sweep.c.y-F;this.m_invMassA=A.m_invMass;this.m_invMassB=y.m_invMass;
this.m_invIA=A.m_invI;this.m_invIB=y.m_invI;this.m_axis.SetV(s.MulMV(k.R,this.m_localXAxis1));this.m_a1=(z+u)*this.m_axis.y-(p+F)*this.m_axis.x;this.m_a2=E*this.m_axis.y-B*this.m_axis.x;
this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;if(this.m_motorMass>Number.MIN_VALUE){this.m_motorMass=1/this.m_motorMass;
}this.m_perp.SetV(s.MulMV(k.R,this.m_localYAxis1));this.m_s1=(z+u)*this.m_perp.y-(p+F)*this.m_perp.x;this.m_s2=E*this.m_perp.y-B*this.m_perp.x;k=this.m_invMassA;
u=this.m_invMassB;F=this.m_invIA;E=this.m_invIB;this.m_K.col1.x=k+u+F*this.m_s1*this.m_s1+E*this.m_s2*this.m_s2;this.m_K.col1.y=F*this.m_s1+E*this.m_s2;
this.m_K.col1.z=F*this.m_s1*this.m_a1+E*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=F+E;this.m_K.col2.z=F*this.m_a1+E*this.m_a2;
this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=k+u+F*this.m_a1*this.m_a1+E*this.m_a2*this.m_a2;if(this.m_enableLimit){z=this.m_axis.x*z+this.m_axis.y*p;
if(s.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*P.b2_linearSlop){this.m_limitState=t.e_equalLimits;}else{if(z<=this.m_lowerTranslation){if(this.m_limitState!=t.e_atLowerLimit){this.m_limitState=t.e_atLowerLimit;
this.m_impulse.z=0;}}else{if(z>=this.m_upperTranslation){if(this.m_limitState!=t.e_atUpperLimit){this.m_limitState=t.e_atUpperLimit;this.m_impulse.z=0;
}}else{this.m_limitState=t.e_inactiveLimit;this.m_impulse.z=0;}}}}else{this.m_limitState=t.e_inactiveLimit;}if(this.m_enableMotor==false){this.m_motorImpulse=0;
}if(D.warmStarting){this.m_impulse.x*=D.dtRatio;this.m_impulse.y*=D.dtRatio;this.m_motorImpulse*=D.dtRatio;D=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x;
z=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y;p=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1;
k=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;A.m_linearVelocity.x-=this.m_invMassA*D;A.m_linearVelocity.y-=this.m_invMassA*z;
A.m_angularVelocity-=this.m_invIA*p;y.m_linearVelocity.x+=this.m_invMassB*D;y.m_linearVelocity.y+=this.m_invMassB*z;y.m_angularVelocity+=this.m_invIB*k;
}else{this.m_impulse.SetZero();this.m_motorImpulse=0;}};v.prototype.SolveVelocityConstraints=function(D){var A=this.m_bodyA,y=this.m_bodyB,z=A.m_linearVelocity,p=A.m_angularVelocity,k=y.m_linearVelocity,u=y.m_angularVelocity,G=0,E=0,B=0,F=0;
if(this.m_enableMotor&&this.m_limitState!=t.e_equalLimits){F=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(k.x-z.x)+this.m_axis.y*(k.y-z.y)+this.m_a2*u-this.m_a1*p));
G=this.m_motorImpulse;D=D.dt*this.m_maxMotorForce;this.m_motorImpulse=s.Clamp(this.m_motorImpulse+F,-D,D);F=this.m_motorImpulse-G;G=F*this.m_axis.x;E=F*this.m_axis.y;
B=F*this.m_a1;F=F*this.m_a2;z.x-=this.m_invMassA*G;z.y-=this.m_invMassA*E;p-=this.m_invIA*B;k.x+=this.m_invMassB*G;k.y+=this.m_invMassB*E;u+=this.m_invIB*F;
}B=this.m_perp.x*(k.x-z.x)+this.m_perp.y*(k.y-z.y)+this.m_s2*u-this.m_s1*p;E=u-p;if(this.m_enableLimit&&this.m_limitState!=t.e_inactiveLimit){D=this.m_axis.x*(k.x-z.x)+this.m_axis.y*(k.y-z.y)+this.m_a2*u-this.m_a1*p;
G=this.m_impulse.Copy();D=this.m_K.Solve33(new ac,-B,-E,-D);this.m_impulse.Add(D);if(this.m_limitState==t.e_atLowerLimit){this.m_impulse.z=s.Max(this.m_impulse.z,0);
}else{if(this.m_limitState==t.e_atUpperLimit){this.m_impulse.z=s.Min(this.m_impulse.z,0);}}B=-B-(this.m_impulse.z-G.z)*this.m_K.col3.x;E=-E-(this.m_impulse.z-G.z)*this.m_K.col3.y;
E=this.m_K.Solve22(new x,B,E);E.x+=G.x;E.y+=G.y;this.m_impulse.x=E.x;this.m_impulse.y=E.y;D.x=this.m_impulse.x-G.x;D.y=this.m_impulse.y-G.y;D.z=this.m_impulse.z-G.z;
G=D.x*this.m_perp.x+D.z*this.m_axis.x;E=D.x*this.m_perp.y+D.z*this.m_axis.y;B=D.x*this.m_s1+D.y+D.z*this.m_a1;F=D.x*this.m_s2+D.y+D.z*this.m_a2;}else{D=this.m_K.Solve22(new x,-B,-E);
this.m_impulse.x+=D.x;this.m_impulse.y+=D.y;G=D.x*this.m_perp.x;E=D.x*this.m_perp.y;B=D.x*this.m_s1+D.y;F=D.x*this.m_s2+D.y;}z.x-=this.m_invMassA*G;z.y-=this.m_invMassA*E;
p-=this.m_invIA*B;k.x+=this.m_invMassB*G;k.y+=this.m_invMassB*E;u+=this.m_invIB*F;A.m_linearVelocity.SetV(z);A.m_angularVelocity=p;y.m_linearVelocity.SetV(k);
y.m_angularVelocity=u;};v.prototype.SolvePositionConstraints=function(){var H=this.m_bodyA,D=this.m_bodyB,A=H.m_sweep.c,B=H.m_sweep.a,u=D.m_sweep.c,p=D.m_sweep.a,y,L=0,I=0,E=0,K=L=y=0,G=0;
I=false;var F=0,z=C.FromAngle(B),k=C.FromAngle(p);y=z;G=this.m_localAnchor1.x-this.m_localCenterA.x;var N=this.m_localAnchor1.y-this.m_localCenterA.y;L=y.col1.x*G+y.col2.x*N;
N=y.col1.y*G+y.col2.y*N;G=L;y=k;k=this.m_localAnchor2.x-this.m_localCenterB.x;E=this.m_localAnchor2.y-this.m_localCenterB.y;L=y.col1.x*k+y.col2.x*E;E=y.col1.y*k+y.col2.y*E;
k=L;y=u.x+k-A.x-G;L=u.y+E-A.y-N;if(this.m_enableLimit){this.m_axis=s.MulMV(z,this.m_localXAxis1);this.m_a1=(y+G)*this.m_axis.y-(L+N)*this.m_axis.x;this.m_a2=k*this.m_axis.y-E*this.m_axis.x;
var M=this.m_axis.x*y+this.m_axis.y*L;if(s.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*P.b2_linearSlop){F=s.Clamp(M,-P.b2_maxLinearCorrection,P.b2_maxLinearCorrection);
K=s.Abs(M);I=true;}else{if(M<=this.m_lowerTranslation){F=s.Clamp(M-this.m_lowerTranslation+P.b2_linearSlop,-P.b2_maxLinearCorrection,0);K=this.m_lowerTranslation-M;
I=true;}else{if(M>=this.m_upperTranslation){F=s.Clamp(M-this.m_upperTranslation+P.b2_linearSlop,0,P.b2_maxLinearCorrection);K=M-this.m_upperTranslation;
I=true;}}}}this.m_perp=s.MulMV(z,this.m_localYAxis1);this.m_s1=(y+G)*this.m_perp.y-(L+N)*this.m_perp.x;this.m_s2=k*this.m_perp.y-E*this.m_perp.x;z=new ac;
N=this.m_perp.x*y+this.m_perp.y*L;k=p-B-this.m_refAngle;K=s.Max(K,s.Abs(N));G=s.Abs(k);if(I){I=this.m_invMassA;E=this.m_invMassB;y=this.m_invIA;L=this.m_invIB;
this.m_K.col1.x=I+E+y*this.m_s1*this.m_s1+L*this.m_s2*this.m_s2;this.m_K.col1.y=y*this.m_s1+L*this.m_s2;this.m_K.col1.z=y*this.m_s1*this.m_a1+L*this.m_s2*this.m_a2;
this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=y+L;this.m_K.col2.z=y*this.m_a1+L*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;
this.m_K.col3.z=I+E+y*this.m_a1*this.m_a1+L*this.m_a2*this.m_a2;this.m_K.Solve33(z,-N,-k,-F);}else{I=this.m_invMassA;E=this.m_invMassB;y=this.m_invIA;L=this.m_invIB;
F=y*this.m_s1+L*this.m_s2;M=y+L;this.m_K.col1.Set(I+E+y*this.m_s1*this.m_s1+L*this.m_s2*this.m_s2,F,0);this.m_K.col2.Set(F,M,0);F=this.m_K.Solve22(new x,-N,-k);
z.x=F.x;z.y=F.y;z.z=0;}F=z.x*this.m_perp.x+z.z*this.m_axis.x;I=z.x*this.m_perp.y+z.z*this.m_axis.y;N=z.x*this.m_s1+z.y+z.z*this.m_a1;z=z.x*this.m_s2+z.y+z.z*this.m_a2;
A.x-=this.m_invMassA*F;A.y-=this.m_invMassA*I;B-=this.m_invIA*N;u.x+=this.m_invMassB*F;u.y+=this.m_invMassB*I;p+=this.m_invIB*z;H.m_sweep.a=B;D.m_sweep.a=p;
H.SynchronizeTransform();D.SynchronizeTransform();return K<=P.b2_linearSlop&&G<=P.b2_angularSlop;};Box2D.inherit(l,Box2D.Dynamics.Joints.b2JointDef);l.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;
l.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new x;this.localAnchorB=new x;this.localAxisA=new x;
};l.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this);this.type=t.e_prismaticJoint;this.localAxisA.Set(1,0);this.referenceAngle=0;
this.enableLimit=false;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=false;this.motorSpeed=this.maxMotorForce=0;};l.prototype.Initialize=function(y,u,k,p){this.bodyA=y;
this.bodyB=u;this.localAnchorA=this.bodyA.GetLocalPoint(k);this.localAnchorB=this.bodyB.GetLocalPoint(k);this.localAxisA=this.bodyA.GetLocalVector(p);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle();
};Box2D.inherit(T,Box2D.Dynamics.Joints.b2Joint);T.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;T.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);
this.m_groundAnchor1=new x;this.m_groundAnchor2=new x;this.m_localAnchor1=new x;this.m_localAnchor2=new x;this.m_u1=new x;this.m_u2=new x;};T.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
};T.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);};T.prototype.GetReactionForce=function(k){if(k===undefined){k=0;
}return new x(k*this.m_impulse*this.m_u2.x,k*this.m_impulse*this.m_u2.y);};T.prototype.GetReactionTorque=function(){return 0;};T.prototype.GetGroundAnchorA=function(){var k=this.m_ground.m_xf.position.Copy();
k.Add(this.m_groundAnchor1);return k;};T.prototype.GetGroundAnchorB=function(){var k=this.m_ground.m_xf.position.Copy();k.Add(this.m_groundAnchor2);return k;
};T.prototype.GetLength1=function(){var p=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),k=p.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x);
p=p.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(k*k+p*p);};T.prototype.GetLength2=function(){var p=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),k=p.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x);
p=p.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y);return Math.sqrt(k*k+p*p);};T.prototype.GetRatio=function(){return this.m_ratio;};T.prototype.b2PulleyJoint=function(k){this.__super.b2Joint.call(this,k);
this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=k.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=k.groundAnchorA.y-this.m_ground.m_xf.position.y;
this.m_groundAnchor2.x=k.groundAnchorB.x-this.m_ground.m_xf.position.x;this.m_groundAnchor2.y=k.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.SetV(k.localAnchorA);
this.m_localAnchor2.SetV(k.localAnchorB);this.m_ratio=k.ratio;this.m_constant=k.lengthA+this.m_ratio*k.lengthB;this.m_maxLength1=s.Min(k.maxLengthA,this.m_constant-this.m_ratio*T.b2_minPulleyLength);
this.m_maxLength2=s.Min(k.maxLengthB,(this.m_constant-T.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0;};
T.prototype.InitVelocityConstraints=function(D){var A=this.m_bodyA,y=this.m_bodyB,z;z=A.m_xf.R;var p=this.m_localAnchor1.x-A.m_sweep.localCenter.x,k=this.m_localAnchor1.y-A.m_sweep.localCenter.y,u=z.col1.x*p+z.col2.x*k;
k=z.col1.y*p+z.col2.y*k;p=u;z=y.m_xf.R;var G=this.m_localAnchor2.x-y.m_sweep.localCenter.x,E=this.m_localAnchor2.y-y.m_sweep.localCenter.y;u=z.col1.x*G+z.col2.x*E;
E=z.col1.y*G+z.col2.y*E;G=u;z=y.m_sweep.c.x+G;u=y.m_sweep.c.y+E;var B=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,F=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;
this.m_u1.Set(A.m_sweep.c.x+p-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),A.m_sweep.c.y+k-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));
this.m_u2.Set(z-B,u-F);z=this.m_u1.Length();u=this.m_u2.Length();z>P.b2_linearSlop?this.m_u1.Multiply(1/z):this.m_u1.SetZero();u>P.b2_linearSlop?this.m_u2.Multiply(1/u):this.m_u2.SetZero();
if(this.m_constant-z-this.m_ratio*u>0){this.m_state=t.e_inactiveLimit;this.m_impulse=0;}else{this.m_state=t.e_atUpperLimit;}if(z<this.m_maxLength1){this.m_limitState1=t.e_inactiveLimit;
this.m_limitImpulse1=0;}else{this.m_limitState1=t.e_atUpperLimit;}if(u<this.m_maxLength2){this.m_limitState2=t.e_inactiveLimit;this.m_limitImpulse2=0;}else{this.m_limitState2=t.e_atUpperLimit;
}z=p*this.m_u1.y-k*this.m_u1.x;u=G*this.m_u2.y-E*this.m_u2.x;this.m_limitMass1=A.m_invMass+A.m_invI*z*z;this.m_limitMass2=y.m_invMass+y.m_invI*u*u;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;
this.m_limitMass1=1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;if(D.warmStarting){this.m_impulse*=D.dtRatio;
this.m_limitImpulse1*=D.dtRatio;this.m_limitImpulse2*=D.dtRatio;D=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x;z=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y;
u=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x;B=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;A.m_linearVelocity.x+=A.m_invMass*D;
A.m_linearVelocity.y+=A.m_invMass*z;A.m_angularVelocity+=A.m_invI*(p*z-k*D);y.m_linearVelocity.x+=y.m_invMass*u;y.m_linearVelocity.y+=y.m_invMass*B;y.m_angularVelocity+=y.m_invI*(G*B-E*u);
}else{this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0;}};T.prototype.SolveVelocityConstraints=function(){var D=this.m_bodyA,A=this.m_bodyB,y;
y=D.m_xf.R;var z=this.m_localAnchor1.x-D.m_sweep.localCenter.x,p=this.m_localAnchor1.y-D.m_sweep.localCenter.y,k=y.col1.x*z+y.col2.x*p;p=y.col1.y*z+y.col2.y*p;
z=k;y=A.m_xf.R;var u=this.m_localAnchor2.x-A.m_sweep.localCenter.x,F=this.m_localAnchor2.y-A.m_sweep.localCenter.y;k=y.col1.x*u+y.col2.x*F;F=y.col1.y*u+y.col2.y*F;
u=k;var E=k=y=0,B=0;y=B=y=B=E=k=y=0;if(this.m_state==t.e_atUpperLimit){y=D.m_linearVelocity.x+-D.m_angularVelocity*p;k=D.m_linearVelocity.y+D.m_angularVelocity*z;
E=A.m_linearVelocity.x+-A.m_angularVelocity*F;B=A.m_linearVelocity.y+A.m_angularVelocity*u;y=-(this.m_u1.x*y+this.m_u1.y*k)-this.m_ratio*(this.m_u2.x*E+this.m_u2.y*B);
B=this.m_pulleyMass*-y;y=this.m_impulse;this.m_impulse=s.Max(0,this.m_impulse+B);B=this.m_impulse-y;y=-B*this.m_u1.x;k=-B*this.m_u1.y;E=-this.m_ratio*B*this.m_u2.x;
B=-this.m_ratio*B*this.m_u2.y;D.m_linearVelocity.x+=D.m_invMass*y;D.m_linearVelocity.y+=D.m_invMass*k;D.m_angularVelocity+=D.m_invI*(z*k-p*y);A.m_linearVelocity.x+=A.m_invMass*E;
A.m_linearVelocity.y+=A.m_invMass*B;A.m_angularVelocity+=A.m_invI*(u*B-F*E);}if(this.m_limitState1==t.e_atUpperLimit){y=D.m_linearVelocity.x+-D.m_angularVelocity*p;
k=D.m_linearVelocity.y+D.m_angularVelocity*z;y=-(this.m_u1.x*y+this.m_u1.y*k);B=-this.m_limitMass1*y;y=this.m_limitImpulse1;this.m_limitImpulse1=s.Max(0,this.m_limitImpulse1+B);
B=this.m_limitImpulse1-y;y=-B*this.m_u1.x;k=-B*this.m_u1.y;D.m_linearVelocity.x+=D.m_invMass*y;D.m_linearVelocity.y+=D.m_invMass*k;D.m_angularVelocity+=D.m_invI*(z*k-p*y);
}if(this.m_limitState2==t.e_atUpperLimit){E=A.m_linearVelocity.x+-A.m_angularVelocity*F;B=A.m_linearVelocity.y+A.m_angularVelocity*u;y=-(this.m_u2.x*E+this.m_u2.y*B);
B=-this.m_limitMass2*y;y=this.m_limitImpulse2;this.m_limitImpulse2=s.Max(0,this.m_limitImpulse2+B);B=this.m_limitImpulse2-y;E=-B*this.m_u2.x;B=-B*this.m_u2.y;
A.m_linearVelocity.x+=A.m_invMass*E;A.m_linearVelocity.y+=A.m_invMass*B;A.m_angularVelocity+=A.m_invI*(u*B-F*E);}};T.prototype.SolvePositionConstraints=function(){var H=this.m_bodyA,D=this.m_bodyB,A,B=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,u=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,p=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,y=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,L=0,I=0,E=0,K=0,G=A=0,F=0,z=0,k=G=z=A=G=A=0;
if(this.m_state==t.e_atUpperLimit){A=H.m_xf.R;L=this.m_localAnchor1.x-H.m_sweep.localCenter.x;I=this.m_localAnchor1.y-H.m_sweep.localCenter.y;G=A.col1.x*L+A.col2.x*I;
I=A.col1.y*L+A.col2.y*I;L=G;A=D.m_xf.R;E=this.m_localAnchor2.x-D.m_sweep.localCenter.x;K=this.m_localAnchor2.y-D.m_sweep.localCenter.y;G=A.col1.x*E+A.col2.x*K;
K=A.col1.y*E+A.col2.y*K;E=G;A=H.m_sweep.c.x+L;G=H.m_sweep.c.y+I;F=D.m_sweep.c.x+E;z=D.m_sweep.c.y+K;this.m_u1.Set(A-B,G-u);this.m_u2.Set(F-p,z-y);A=this.m_u1.Length();
G=this.m_u2.Length();A>P.b2_linearSlop?this.m_u1.Multiply(1/A):this.m_u1.SetZero();G>P.b2_linearSlop?this.m_u2.Multiply(1/G):this.m_u2.SetZero();A=this.m_constant-A-this.m_ratio*G;
k=s.Max(k,-A);A=s.Clamp(A+P.b2_linearSlop,-P.b2_maxLinearCorrection,0);z=-this.m_pulleyMass*A;A=-z*this.m_u1.x;G=-z*this.m_u1.y;F=-this.m_ratio*z*this.m_u2.x;
z=-this.m_ratio*z*this.m_u2.y;H.m_sweep.c.x+=H.m_invMass*A;H.m_sweep.c.y+=H.m_invMass*G;H.m_sweep.a+=H.m_invI*(L*G-I*A);D.m_sweep.c.x+=D.m_invMass*F;D.m_sweep.c.y+=D.m_invMass*z;
D.m_sweep.a+=D.m_invI*(E*z-K*F);H.SynchronizeTransform();D.SynchronizeTransform();}if(this.m_limitState1==t.e_atUpperLimit){A=H.m_xf.R;L=this.m_localAnchor1.x-H.m_sweep.localCenter.x;
I=this.m_localAnchor1.y-H.m_sweep.localCenter.y;G=A.col1.x*L+A.col2.x*I;I=A.col1.y*L+A.col2.y*I;L=G;A=H.m_sweep.c.x+L;G=H.m_sweep.c.y+I;this.m_u1.Set(A-B,G-u);
A=this.m_u1.Length();if(A>P.b2_linearSlop){this.m_u1.x*=1/A;this.m_u1.y*=1/A;}else{this.m_u1.SetZero();}A=this.m_maxLength1-A;k=s.Max(k,-A);A=s.Clamp(A+P.b2_linearSlop,-P.b2_maxLinearCorrection,0);
z=-this.m_limitMass1*A;A=-z*this.m_u1.x;G=-z*this.m_u1.y;H.m_sweep.c.x+=H.m_invMass*A;H.m_sweep.c.y+=H.m_invMass*G;H.m_sweep.a+=H.m_invI*(L*G-I*A);H.SynchronizeTransform();
}if(this.m_limitState2==t.e_atUpperLimit){A=D.m_xf.R;E=this.m_localAnchor2.x-D.m_sweep.localCenter.x;K=this.m_localAnchor2.y-D.m_sweep.localCenter.y;G=A.col1.x*E+A.col2.x*K;
K=A.col1.y*E+A.col2.y*K;E=G;F=D.m_sweep.c.x+E;z=D.m_sweep.c.y+K;this.m_u2.Set(F-p,z-y);G=this.m_u2.Length();if(G>P.b2_linearSlop){this.m_u2.x*=1/G;this.m_u2.y*=1/G;
}else{this.m_u2.SetZero();}A=this.m_maxLength2-G;k=s.Max(k,-A);A=s.Clamp(A+P.b2_linearSlop,-P.b2_maxLinearCorrection,0);z=-this.m_limitMass2*A;F=-z*this.m_u2.x;
z=-z*this.m_u2.y;D.m_sweep.c.x+=D.m_invMass*F;D.m_sweep.c.y+=D.m_invMass*z;D.m_sweep.a+=D.m_invI*(E*z-K*F);D.SynchronizeTransform();}return k<P.b2_linearSlop;
};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2;});Box2D.inherit(g,Box2D.Dynamics.Joints.b2JointDef);g.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;
g.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.groundAnchorA=new x;this.groundAnchorB=new x;this.localAnchorA=new x;
this.localAnchorB=new x;};g.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this);this.type=t.e_pulleyJoint;this.groundAnchorA.Set(-1,1);
this.groundAnchorB.Set(1,1);this.localAnchorA.Set(-1,0);this.localAnchorB.Set(1,0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;
this.collideConnected=true;};g.prototype.Initialize=function(A,u,k,p,z,y,B){if(B===undefined){B=0;}this.bodyA=A;this.bodyB=u;this.groundAnchorA.SetV(k);
this.groundAnchorB.SetV(p);this.localAnchorA=this.bodyA.GetLocalPoint(z);this.localAnchorB=this.bodyB.GetLocalPoint(y);A=z.x-k.x;k=z.y-k.y;this.lengthA=Math.sqrt(A*A+k*k);
k=y.x-p.x;p=y.y-p.y;this.lengthB=Math.sqrt(k*k+p*p);this.ratio=B;B=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=B-this.ratio*T.b2_minPulleyLength;
this.maxLengthB=(B-T.b2_minPulleyLength)/this.ratio;};Box2D.inherit(m,Box2D.Dynamics.Joints.b2Joint);m.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;
m.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new C;this.K1=new C;this.K2=new C;this.K3=new C;this.impulse3=new ac;
this.impulse2=new x;this.reduced=new x;this.m_localAnchor1=new x;this.m_localAnchor2=new x;this.m_impulse=new ac;this.m_mass=new r;};m.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
};m.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);};m.prototype.GetReactionForce=function(k){if(k===undefined){k=0;
}return new x(k*this.m_impulse.x,k*this.m_impulse.y);};m.prototype.GetReactionTorque=function(k){if(k===undefined){k=0;}return k*this.m_impulse.z;};m.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle;
};m.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity;};m.prototype.IsLimitEnabled=function(){return this.m_enableLimit;
};m.prototype.EnableLimit=function(k){this.m_enableLimit=k;};m.prototype.GetLowerLimit=function(){return this.m_lowerAngle;};m.prototype.GetUpperLimit=function(){return this.m_upperAngle;
};m.prototype.SetLimits=function(p,k){if(p===undefined){p=0;}if(k===undefined){k=0;}this.m_lowerAngle=p;this.m_upperAngle=k;};m.prototype.IsMotorEnabled=function(){this.m_bodyA.SetAwake(true);
this.m_bodyB.SetAwake(true);return this.m_enableMotor;};m.prototype.EnableMotor=function(k){this.m_enableMotor=k;};m.prototype.SetMotorSpeed=function(k){if(k===undefined){k=0;
}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=k;};m.prototype.GetMotorSpeed=function(){return this.m_motorSpeed;};m.prototype.SetMaxMotorTorque=function(k){if(k===undefined){k=0;
}this.m_maxMotorTorque=k;};m.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque;};m.prototype.b2RevoluteJoint=function(k){this.__super.b2Joint.call(this,k);
this.m_localAnchor1.SetV(k.localAnchorA);this.m_localAnchor2.SetV(k.localAnchorB);this.m_referenceAngle=k.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;
this.m_lowerAngle=k.lowerAngle;this.m_upperAngle=k.upperAngle;this.m_maxMotorTorque=k.maxMotorTorque;this.m_motorSpeed=k.motorSpeed;this.m_enableLimit=k.enableLimit;
this.m_enableMotor=k.enableMotor;this.m_limitState=t.e_inactiveLimit;};m.prototype.InitVelocityConstraints=function(E){var A=this.m_bodyA,y=this.m_bodyB,z,p=0;
z=A.m_xf.R;var k=this.m_localAnchor1.x-A.m_sweep.localCenter.x,u=this.m_localAnchor1.y-A.m_sweep.localCenter.y;p=z.col1.x*k+z.col2.x*u;u=z.col1.y*k+z.col2.y*u;
k=p;z=y.m_xf.R;var H=this.m_localAnchor2.x-y.m_sweep.localCenter.x,F=this.m_localAnchor2.y-y.m_sweep.localCenter.y;p=z.col1.x*H+z.col2.x*F;F=z.col1.y*H+z.col2.y*F;
H=p;z=A.m_invMass;p=y.m_invMass;var B=A.m_invI,G=y.m_invI;this.m_mass.col1.x=z+p+u*u*B+F*F*G;this.m_mass.col2.x=-u*k*B-F*H*G;this.m_mass.col3.x=-u*B-F*G;
this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=z+p+k*k*B+H*H*G;this.m_mass.col3.y=k*B+H*G;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;
this.m_mass.col3.z=B+G;this.m_motorMass=1/(B+G);if(this.m_enableMotor==false){this.m_motorImpulse=0;}if(this.m_enableLimit){var D=y.m_sweep.a-A.m_sweep.a-this.m_referenceAngle;
if(s.Abs(this.m_upperAngle-this.m_lowerAngle)<2*P.b2_angularSlop){this.m_limitState=t.e_equalLimits;}else{if(D<=this.m_lowerAngle){if(this.m_limitState!=t.e_atLowerLimit){this.m_impulse.z=0;
}this.m_limitState=t.e_atLowerLimit;}else{if(D>=this.m_upperAngle){if(this.m_limitState!=t.e_atUpperLimit){this.m_impulse.z=0;}this.m_limitState=t.e_atUpperLimit;
}else{this.m_limitState=t.e_inactiveLimit;this.m_impulse.z=0;}}}}else{this.m_limitState=t.e_inactiveLimit;}if(E.warmStarting){this.m_impulse.x*=E.dtRatio;
this.m_impulse.y*=E.dtRatio;this.m_motorImpulse*=E.dtRatio;E=this.m_impulse.x;D=this.m_impulse.y;A.m_linearVelocity.x-=z*E;A.m_linearVelocity.y-=z*D;A.m_angularVelocity-=B*(k*D-u*E+this.m_motorImpulse+this.m_impulse.z);
y.m_linearVelocity.x+=p*E;y.m_linearVelocity.y+=p*D;y.m_angularVelocity+=G*(H*D-F*E+this.m_motorImpulse+this.m_impulse.z);}else{this.m_impulse.SetZero();
this.m_motorImpulse=0;}};m.prototype.SolveVelocityConstraints=function(H){var D=this.m_bodyA,A=this.m_bodyB,B=0,u=B=0,p=0,y=0,L=0,I=D.m_linearVelocity,E=D.m_angularVelocity,K=A.m_linearVelocity,G=A.m_angularVelocity,F=D.m_invMass,z=A.m_invMass,k=D.m_invI,N=A.m_invI;
if(this.m_enableMotor&&this.m_limitState!=t.e_equalLimits){u=this.m_motorMass*-(G-E-this.m_motorSpeed);p=this.m_motorImpulse;y=H.dt*this.m_maxMotorTorque;
this.m_motorImpulse=s.Clamp(this.m_motorImpulse+u,-y,y);u=this.m_motorImpulse-p;E-=k*u;G+=N*u;}if(this.m_enableLimit&&this.m_limitState!=t.e_inactiveLimit){H=D.m_xf.R;
u=this.m_localAnchor1.x-D.m_sweep.localCenter.x;p=this.m_localAnchor1.y-D.m_sweep.localCenter.y;B=H.col1.x*u+H.col2.x*p;p=H.col1.y*u+H.col2.y*p;u=B;H=A.m_xf.R;
y=this.m_localAnchor2.x-A.m_sweep.localCenter.x;L=this.m_localAnchor2.y-A.m_sweep.localCenter.y;B=H.col1.x*y+H.col2.x*L;L=H.col1.y*y+H.col2.y*L;y=B;H=K.x+-G*L-I.x- -E*p;
var M=K.y+G*y-I.y-E*u;this.m_mass.Solve33(this.impulse3,-H,-M,-(G-E));if(this.m_limitState==t.e_equalLimits){this.m_impulse.Add(this.impulse3);}else{if(this.m_limitState==t.e_atLowerLimit){B=this.m_impulse.z+this.impulse3.z;
if(B<0){this.m_mass.Solve22(this.reduced,-H,-M);this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=-this.m_impulse.z;this.m_impulse.x+=this.reduced.x;
this.m_impulse.y+=this.reduced.y;this.m_impulse.z=0;}}else{if(this.m_limitState==t.e_atUpperLimit){B=this.m_impulse.z+this.impulse3.z;if(B>0){this.m_mass.Solve22(this.reduced,-H,-M);
this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=-this.m_impulse.z;this.m_impulse.x+=this.reduced.x;this.m_impulse.y+=this.reduced.y;
this.m_impulse.z=0;}}}}I.x-=F*this.impulse3.x;I.y-=F*this.impulse3.y;E-=k*(u*this.impulse3.y-p*this.impulse3.x+this.impulse3.z);K.x+=z*this.impulse3.x;
K.y+=z*this.impulse3.y;G+=N*(y*this.impulse3.y-L*this.impulse3.x+this.impulse3.z);}else{H=D.m_xf.R;u=this.m_localAnchor1.x-D.m_sweep.localCenter.x;p=this.m_localAnchor1.y-D.m_sweep.localCenter.y;
B=H.col1.x*u+H.col2.x*p;p=H.col1.y*u+H.col2.y*p;u=B;H=A.m_xf.R;y=this.m_localAnchor2.x-A.m_sweep.localCenter.x;L=this.m_localAnchor2.y-A.m_sweep.localCenter.y;
B=H.col1.x*y+H.col2.x*L;L=H.col1.y*y+H.col2.y*L;y=B;this.m_mass.Solve22(this.impulse2,-(K.x+-G*L-I.x- -E*p),-(K.y+G*y-I.y-E*u));this.m_impulse.x+=this.impulse2.x;
this.m_impulse.y+=this.impulse2.y;I.x-=F*this.impulse2.x;I.y-=F*this.impulse2.y;E-=k*(u*this.impulse2.y-p*this.impulse2.x);K.x+=z*this.impulse2.x;K.y+=z*this.impulse2.y;
G+=N*(y*this.impulse2.y-L*this.impulse2.x);}D.m_linearVelocity.SetV(I);D.m_angularVelocity=E;A.m_linearVelocity.SetV(K);A.m_angularVelocity=G;};m.prototype.SolvePositionConstraints=function(){var H=0,D,A=this.m_bodyA,B=this.m_bodyB,u=0,p=D=0,y=0,L=0;
if(this.m_enableLimit&&this.m_limitState!=t.e_inactiveLimit){H=B.m_sweep.a-A.m_sweep.a-this.m_referenceAngle;var I=0;if(this.m_limitState==t.e_equalLimits){H=s.Clamp(H-this.m_lowerAngle,-P.b2_maxAngularCorrection,P.b2_maxAngularCorrection);
I=-this.m_motorMass*H;u=s.Abs(H);}else{if(this.m_limitState==t.e_atLowerLimit){H=H-this.m_lowerAngle;u=-H;H=s.Clamp(H+P.b2_angularSlop,-P.b2_maxAngularCorrection,0);
I=-this.m_motorMass*H;}else{if(this.m_limitState==t.e_atUpperLimit){u=H=H-this.m_upperAngle;H=s.Clamp(H-P.b2_angularSlop,0,P.b2_maxAngularCorrection);I=-this.m_motorMass*H;
}}}A.m_sweep.a-=A.m_invI*I;B.m_sweep.a+=B.m_invI*I;A.SynchronizeTransform();B.SynchronizeTransform();}D=A.m_xf.R;I=this.m_localAnchor1.x-A.m_sweep.localCenter.x;
H=this.m_localAnchor1.y-A.m_sweep.localCenter.y;p=D.col1.x*I+D.col2.x*H;H=D.col1.y*I+D.col2.y*H;I=p;D=B.m_xf.R;var E=this.m_localAnchor2.x-B.m_sweep.localCenter.x,K=this.m_localAnchor2.y-B.m_sweep.localCenter.y;
p=D.col1.x*E+D.col2.x*K;K=D.col1.y*E+D.col2.y*K;E=p;y=B.m_sweep.c.x+E-A.m_sweep.c.x-I;L=B.m_sweep.c.y+K-A.m_sweep.c.y-H;var G=y*y+L*L;D=Math.sqrt(G);p=A.m_invMass;
var F=B.m_invMass,z=A.m_invI,k=B.m_invI,M=10*P.b2_linearSlop;if(G>M*M){G=1/(p+F);y=G*-y;L=G*-L;A.m_sweep.c.x-=0.5*p*y;A.m_sweep.c.y-=0.5*p*L;B.m_sweep.c.x+=0.5*F*y;
B.m_sweep.c.y+=0.5*F*L;y=B.m_sweep.c.x+E-A.m_sweep.c.x-I;L=B.m_sweep.c.y+K-A.m_sweep.c.y-H;}this.K1.col1.x=p+F;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=p+F;
this.K2.col1.x=z*H*H;this.K2.col2.x=-z*I*H;this.K2.col1.y=-z*I*H;this.K2.col2.y=z*I*I;this.K3.col1.x=k*K*K;this.K3.col2.x=-k*E*K;this.K3.col1.y=-k*E*K;
this.K3.col2.y=k*E*E;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.AddM(this.K3);this.K.Solve(m.tImpulse,-y,-L);y=m.tImpulse.x;L=m.tImpulse.y;A.m_sweep.c.x-=A.m_invMass*y;
A.m_sweep.c.y-=A.m_invMass*L;A.m_sweep.a-=A.m_invI*(I*L-H*y);B.m_sweep.c.x+=B.m_invMass*y;B.m_sweep.c.y+=B.m_invMass*L;B.m_sweep.a+=B.m_invI*(E*L-K*y);
A.SynchronizeTransform();B.SynchronizeTransform();return D<=P.b2_linearSlop&&u<=P.b2_angularSlop;};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new x;
});Box2D.inherit(f,Box2D.Dynamics.Joints.b2JointDef);f.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;f.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);
this.localAnchorA=new x;this.localAnchorB=new x;};f.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this);this.type=t.e_revoluteJoint;
this.localAnchorA.Set(0,0);this.localAnchorB.Set(0,0);this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=false;
};f.prototype.Initialize=function(u,p,k){this.bodyA=u;this.bodyB=p;this.localAnchorA=this.bodyA.GetLocalPoint(k);this.localAnchorB=this.bodyB.GetLocalPoint(k);
this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle();};Box2D.inherit(af,Box2D.Dynamics.Joints.b2Joint);af.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;
af.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new x;this.m_localAnchorB=new x;this.m_impulse=new ac;
this.m_mass=new r;};af.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);};af.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
};af.prototype.GetReactionForce=function(k){if(k===undefined){k=0;}return new x(k*this.m_impulse.x,k*this.m_impulse.y);};af.prototype.GetReactionTorque=function(k){if(k===undefined){k=0;
}return k*this.m_impulse.z;};af.prototype.b2WeldJoint=function(k){this.__super.b2Joint.call(this,k);this.m_localAnchorA.SetV(k.localAnchorA);this.m_localAnchorB.SetV(k.localAnchorB);
this.m_referenceAngle=k.referenceAngle;this.m_impulse.SetZero();this.m_mass=new r;};af.prototype.InitVelocityConstraints=function(D){var A,y=0,z=this.m_bodyA,p=this.m_bodyB;
A=z.m_xf.R;var k=this.m_localAnchorA.x-z.m_sweep.localCenter.x,u=this.m_localAnchorA.y-z.m_sweep.localCenter.y;y=A.col1.x*k+A.col2.x*u;u=A.col1.y*k+A.col2.y*u;
k=y;A=p.m_xf.R;var G=this.m_localAnchorB.x-p.m_sweep.localCenter.x,E=this.m_localAnchorB.y-p.m_sweep.localCenter.y;y=A.col1.x*G+A.col2.x*E;E=A.col1.y*G+A.col2.y*E;
G=y;A=z.m_invMass;y=p.m_invMass;var B=z.m_invI,F=p.m_invI;this.m_mass.col1.x=A+y+u*u*B+E*E*F;this.m_mass.col2.x=-u*k*B-E*G*F;this.m_mass.col3.x=-u*B-E*F;
this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=A+y+k*k*B+G*G*F;this.m_mass.col3.y=k*B+G*F;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;
this.m_mass.col3.z=B+F;if(D.warmStarting){this.m_impulse.x*=D.dtRatio;this.m_impulse.y*=D.dtRatio;this.m_impulse.z*=D.dtRatio;z.m_linearVelocity.x-=A*this.m_impulse.x;
z.m_linearVelocity.y-=A*this.m_impulse.y;z.m_angularVelocity-=B*(k*this.m_impulse.y-u*this.m_impulse.x+this.m_impulse.z);p.m_linearVelocity.x+=y*this.m_impulse.x;
p.m_linearVelocity.y+=y*this.m_impulse.y;p.m_angularVelocity+=F*(G*this.m_impulse.y-E*this.m_impulse.x+this.m_impulse.z);}else{this.m_impulse.SetZero();
}};af.prototype.SolveVelocityConstraints=function(){var L,G=0,E=this.m_bodyA,F=this.m_bodyB,A=E.m_linearVelocity,z=E.m_angularVelocity,B=F.m_linearVelocity,O=F.m_angularVelocity,M=E.m_invMass,H=F.m_invMass,N=E.m_invI,K=F.m_invI;
L=E.m_xf.R;var I=this.m_localAnchorA.x-E.m_sweep.localCenter.x,D=this.m_localAnchorA.y-E.m_sweep.localCenter.y;G=L.col1.x*I+L.col2.x*D;D=L.col1.y*I+L.col2.y*D;
I=G;L=F.m_xf.R;var y=this.m_localAnchorB.x-F.m_sweep.localCenter.x,u=this.m_localAnchorB.y-F.m_sweep.localCenter.y;G=L.col1.x*y+L.col2.x*u;u=L.col1.y*y+L.col2.y*u;
y=G;L=B.x-O*u-A.x+z*D;G=B.y+O*y-A.y-z*I;var k=O-z,p=new ac;this.m_mass.Solve33(p,-L,-G,-k);this.m_impulse.Add(p);A.x-=M*p.x;A.y-=M*p.y;z-=N*(I*p.y-D*p.x+p.z);
B.x+=H*p.x;B.y+=H*p.y;O+=K*(y*p.y-u*p.x+p.z);E.m_angularVelocity=z;F.m_angularVelocity=O;};af.prototype.SolvePositionConstraints=function(){var H,D=0,A=this.m_bodyA,B=this.m_bodyB;
H=A.m_xf.R;var u=this.m_localAnchorA.x-A.m_sweep.localCenter.x,p=this.m_localAnchorA.y-A.m_sweep.localCenter.y;D=H.col1.x*u+H.col2.x*p;p=H.col1.y*u+H.col2.y*p;
u=D;H=B.m_xf.R;var y=this.m_localAnchorB.x-B.m_sweep.localCenter.x,L=this.m_localAnchorB.y-B.m_sweep.localCenter.y;D=H.col1.x*y+H.col2.x*L;L=H.col1.y*y+H.col2.y*L;
y=D;H=A.m_invMass;D=B.m_invMass;var I=A.m_invI,E=B.m_invI,K=B.m_sweep.c.x+y-A.m_sweep.c.x-u,G=B.m_sweep.c.y+L-A.m_sweep.c.y-p,F=B.m_sweep.a-A.m_sweep.a-this.m_referenceAngle,z=10*P.b2_linearSlop,k=Math.sqrt(K*K+G*G),M=s.Abs(F);
if(k>z){I*=1;E*=1;}this.m_mass.col1.x=H+D+p*p*I+L*L*E;this.m_mass.col2.x=-p*u*I-L*y*E;this.m_mass.col3.x=-p*I-L*E;this.m_mass.col1.y=this.m_mass.col2.x;
this.m_mass.col2.y=H+D+u*u*I+y*y*E;this.m_mass.col3.y=u*I+y*E;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=I+E;
z=new ac;this.m_mass.Solve33(z,-K,-G,-F);A.m_sweep.c.x-=H*z.x;A.m_sweep.c.y-=H*z.y;A.m_sweep.a-=I*(u*z.y-p*z.x+z.z);B.m_sweep.c.x+=D*z.x;B.m_sweep.c.y+=D*z.y;
B.m_sweep.a+=E*(y*z.y-L*z.x+z.z);A.SynchronizeTransform();B.SynchronizeTransform();return k<=P.b2_linearSlop&&M<=P.b2_angularSlop;};Box2D.inherit(a,Box2D.Dynamics.Joints.b2JointDef);
a.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;a.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);
this.localAnchorA=new x;this.localAnchorB=new x;};a.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this);this.type=t.e_weldJoint;this.referenceAngle=0;
};a.prototype.Initialize=function(u,p,k){this.bodyA=u;this.bodyB=p;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(k));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(k));
this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle();};})();(function(){var a=Box2D.Dynamics.b2DebugDraw;a.b2DebugDraw=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;
var b=this;this.m_sprite={graphics:{clear:function(){b.m_ctx.clearRect(0,0,b.m_ctx.canvas.width,b.m_ctx.canvas.height);}}};};a.prototype._color=function(c,b){return"rgba("+((c&16711680)>>16)+","+((c&65280)>>8)+","+(c&255)+","+b+")";
};a.prototype.b2DebugDraw=function(){this.m_drawFlags=0;};a.prototype.SetFlags=function(b){if(b===undefined){b=0;}this.m_drawFlags=b;};a.prototype.GetFlags=function(){return this.m_drawFlags;
};a.prototype.AppendFlags=function(b){if(b===undefined){b=0;}this.m_drawFlags|=b;};a.prototype.ClearFlags=function(b){if(b===undefined){b=0;}this.m_drawFlags&=~b;
};a.prototype.SetSprite=function(b){this.m_ctx=b;};a.prototype.GetSprite=function(){return this.m_ctx;};a.prototype.SetDrawScale=function(b){if(b===undefined){b=0;
}this.m_drawScale=b;};a.prototype.GetDrawScale=function(){return this.m_drawScale;};a.prototype.SetLineThickness=function(b){if(b===undefined){b=0;}this.m_lineThickness=b;
this.m_ctx.strokeWidth=b;};a.prototype.GetLineThickness=function(){return this.m_lineThickness;};a.prototype.SetAlpha=function(b){if(b===undefined){b=0;
}this.m_alpha=b;};a.prototype.GetAlpha=function(){return this.m_alpha;};a.prototype.SetFillAlpha=function(b){if(b===undefined){b=0;}this.m_fillAlpha=b;
};a.prototype.GetFillAlpha=function(){return this.m_fillAlpha;};a.prototype.SetXFormScale=function(b){if(b===undefined){b=0;}this.m_xformScale=b;};a.prototype.GetXFormScale=function(){return this.m_xformScale;
};a.prototype.DrawPolygon=function(e,d,f){if(d){var c=this.m_ctx,b=this.m_drawScale;c.beginPath();c.strokeStyle=this._color(f.color,this.m_alpha);c.moveTo(e[0].x*b,e[0].y*b);
for(f=1;f<d;f++){c.lineTo(e[f].x*b,e[f].y*b);}c.lineTo(e[0].x*b,e[0].y*b);c.closePath();c.stroke();}};a.prototype.DrawSolidPolygon=function(e,d,f){if(d){var c=this.m_ctx,b=this.m_drawScale;
c.beginPath();c.strokeStyle=this._color(f.color,this.m_alpha);c.fillStyle=this._color(f.color,this.m_fillAlpha);c.moveTo(e[0].x*b,e[0].y*b);for(f=1;f<d;
f++){c.lineTo(e[f].x*b,e[f].y*b);}c.lineTo(e[0].x*b,e[0].y*b);c.closePath();c.fill();c.stroke();}};a.prototype.DrawCircle=function(e,d,f){if(d){var c=this.m_ctx,b=this.m_drawScale;
c.beginPath();c.strokeStyle=this._color(f.color,this.m_alpha);c.arc(e.x*b,e.y*b,d*b,0,Math.PI*2,true);c.closePath();c.stroke();}};a.prototype.DrawSolidCircle=function(f,d,k,c){if(d){var b=this.m_ctx,e=this.m_drawScale,g=f.x*e,j=f.y*e;
b.moveTo(0,0);b.beginPath();b.strokeStyle=this._color(c.color,this.m_alpha);b.fillStyle=this._color(c.color,this.m_fillAlpha);b.arc(g,j,d*e,0,Math.PI*2,true);
b.moveTo(g,j);b.lineTo((f.x+k.x*d)*e,(f.y+k.y*d)*e);b.closePath();b.fill();b.stroke();}};a.prototype.DrawSegment=function(e,d,f){var c=this.m_ctx,b=this.m_drawScale;
c.strokeStyle=this._color(f.color,this.m_alpha);c.beginPath();c.moveTo(e.x*b,e.y*b);c.lineTo(d.x*b,d.y*b);c.closePath();c.stroke();};a.prototype.DrawTransform=function(c){var b=this.m_ctx,d=this.m_drawScale;
b.beginPath();b.strokeStyle=this._color(16711680,this.m_alpha);b.moveTo(c.position.x*d,c.position.y*d);b.lineTo((c.position.x+this.m_xformScale*c.R.col1.x)*d,(c.position.y+this.m_xformScale*c.R.col1.y)*d);
b.strokeStyle=this._color(65280,this.m_alpha);b.moveTo(c.position.x*d,c.position.y*d);b.lineTo((c.position.x+this.m_xformScale*c.R.col2.x)*d,(c.position.y+this.m_xformScale*c.R.col2.y)*d);
b.closePath();b.stroke();};})();var i;for(i=0;i<Box2D.postDefs.length;++i){Box2D.postDefs[i]();}delete Box2D.postDefs;(function(a){isString=function(b){return toString.call(b)=="[object String]";
};a.fn.bodysnatch=function(){var b=this;return b.each(function(d,c){var e=a(this);var f=e.clone();w=e.width();h=e.height();if(this.offsetWidth>0&&this.offsetHeight>0){f.css({position:"absolute",top:e.offset().top,left:e.offset().left,width:e.width(),height:e.height(),margin:0,});
f.addClass("perfect");}else{f.css({position:"absolute",top:e.offset().top,left:e.offset().left,margin:0,});f.addClass("imperfect");}if(e[0].id){e[0].id=e[0].id+"_snatched";
}e.addClass("snatched");f.addClass("bodysnatcher");e.css("visibility","hidden");if(e[0].pause){e[0].pause();e[0].src="";}b[d]=f[0];a("body").append(f);
});};})(jQuery);(function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];
window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"];}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(j,e){var d=new Date().getTime();
var f=Math.max(0,16-(d-b));var g=window.setTimeout(function(){j(d+f);},f);b=d+f;return g;};}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d);
};}}());(function(){var K,Y,Z,v,x,A,T,y,X,k,D,F,p,aa,s,L,e,r,c,P,q,a,J,M,g,B,z,j,u,G,H,U,l,o,W,d,m,E,b,S,Q,t,O,n,f,N,R,C,I,V;P=Box2D.Common.Math.b2Vec2;
X=Box2D.Collision.b2AABB;D=Box2D.Dynamics.b2BodyDef;k=Box2D.Dynamics.b2Body;s=Box2D.Dynamics.b2FixtureDef;aa=Box2D.Dynamics.b2Fixture;q=Box2D.Dynamics.b2World;
L=Box2D.Collision.Shapes.b2MassData;r=Box2D.Collision.Shapes.b2PolygonShape;F=Box2D.Collision.Shapes.b2CircleShape;p=Box2D.Dynamics.b2DebugDraw;c=Box2D.Dynamics.Joints.b2RevoluteJointDef;
e=Box2D.Dynamics.Joints.b2MouseJointDef;K=jQuery;W={"-webkit-transform":"translateZ(0)","-moz-transform":"translateZ(0)","-o-transform":"translateZ(0)",transform:"translateZ(0)"};
y=false;Z=false;C={};I=0;V=0;T=30;Y=Math.PI/180;A=180/Math.PI;x=Math.PI*2;d={};u=false;g=1.5;B=0.3;z=0.4;j="box";S=0;Q=0;b=void 0;m=false;O=void 0;E=void 0;
v=function(af,ao,ah,ad){var ac,ai,am,ak,ap,al,aj,ag,an,ae,ab;ac=af;S=void 0;Q=void 0;aj=void 0;ag=void 0;ai=false;ak=function(aq){ab(aq);return ad(S,Q);
};ab=function(aq){var ar;aq.preventDefault();ar=aq.originalEvent;if(ar&&ar.touches&&ar.touches.length===1){ar.preventDefault();S=ar.touches[0].pageX;return Q=ar.touches[0].pageY;
}else{S=aq.pageX;return Q=aq.pageY;}};ap=function(aq){ac.addEventListener("mousedown",am,true);ac.removeEventListener("mousemove",ak,true);ai=false;ab(aq);
return ah(S,Q);};ae=function(aq){ac.addEventListener("touchstart",an,true);ac.removeEventListener("touchmove",ak,true);ai=false;ab(aq);return ah(S,Q);};
am=function(aq){ac.removeEventListener("mousedown",am,true);ac.addEventListener("mouseup",ap,true);ac.addEventListener("mousemove",ak,true);ai=true;ab(aq);
return ao(S,Q);};an=function(aq){ac.removeEventListener("touchstart",an,true);ac.addEventListener("touchend",ae,true);ac.addEventListener("touchmove",ak,true);
ai=true;ab(aq);return ao(S,Q);};ac.addEventListener("mousedown",am,true);ac.addEventListener("touchstart",an,true);al={};al.mouseX=function(){return S;
};al.mouseY=function(){return Q;};al.isDown=function(){return ai;};return al;};G=function(ab,ac){m=true;return t(ab,ac);};f=function(ab,ac){m=false;S=null;
return Q=null;};t=function(ab,ac){S=ab/30;return Q=ac/30;};U=function(){var ab;b=new P(S,Q);ab=new X();ab.lowerBound.Set(S-0.001,Q-0.001);ab.upperBound.Set(S+0.001,Q+0.001);
O=null;C.QueryAABB(l,ab);return O;};l=function(ab){if(ab.GetBody().GetType()!==k.b2_staticBody){if(ab.GetShape().TestPoint(ab.GetBody().GetTransform(),b)){O=ab.GetBody();
return false;}}return true;};o=function(ac){var ad,ae,ab,af;ad=ac;ae="";ab=0;af=0;while((typeof ad==="object")&&(typeof ad.tagName!=="undefined")){af+=ad.offsetTop;
ab+=ad.offsetLeft;ae=ad.tagName.toUpperCase();if(ae==="BODY"){ad=0;}if(typeof ad==="object"?typeof ad.offsetParent==="object":void 0){ad=ad.offsetParent;
}}return{x:ab,y:af};};R=function(){var ab,ac;if(m&&(!E)){ab=U();if(ab){ac=new e();ac.bodyA=C.GetGroundBody();ac.bodyB=ab;ac.target.Set(S,Q);ac.collideConnected=true;
ac.maxForce=300*ab.GetMass();E=C.CreateJoint(ac);ab.SetAwake(true);}}if(E){if(m){return E.SetTarget(new P(S,Q));}else{C.DestroyJoint(E);return E=null;}}};
M=function(ae,ac,af,ab,ad,ag){if(ac==null){ac=j;}if(af==null){af=u;}if(ab==null){ab=g;}if(ad==null){ad=z;}if(ag==null){ag=B;}return K(ae).each(function(ay,ax){var an,av,ao,aw,au,aq,ar,al,aj,ah,ai,az,ap,at,am,ak;
av=K(ax);au=av.width();aw=av.height();if(!(au&&aw)){if(av.attr("src")){if(typeof console!=="undefined"&&console!==null){console.log(" - box2d-jquery ERROR: an element withour width or height, will lead to strangeness!");
}av.on("load",function(){return M(this,ac,af,ab,ad,ag);});}return true;}ao=K(ax).position();at=au/2;aq=aw/2;am=ao.left+at;ak=ao.top+aq;ah=(av.attr("data-box2d-shape")?av.attr("data-box2d-shape"):ac);
ar=parseFloat((av.attr("data-box2d-density")?av.attr("data-box2d-density"):ab));aj=parseFloat((av.attr("data-box2d-restitution")?av.attr("data-box2d-restitution"):ad));
al=parseFloat((av.attr("data-box2d-friction")?av.attr("data-box2d-friction"):ag));if(av.attr("data-box2d-static")==="true"){ai=true;}else{if(av.attr("data-box2d-static")==="false"){ai=false;
}else{ai=af;}}if(ah&&ah!=="circle"){an=a(am,ak,at,aq,ai,ar,aj,al);}else{ap=(at>aq?at:aq);an=J(am,ak,ap,ai,ar,aj,al);}an.m_userData={domObj:av,width:at,height:aq};
az="50% 50% 0";av.css({"-webkit-transform-origin":az,"-moz-transform-origin":az,"-ms-transform-origin":az,"-o-transform-origin":az,"transform-origin":az});
return true;});};a=function(ai,ah,ad,ak,ag,aj,ac,af){var ae,ab;if(ag==null){ag=u;}if(aj==null){aj=g;}if(ac==null){ac=z;}if(af==null){af=B;}ae=new D;ae.type=(ag?k.b2_staticBody:k.b2_dynamicBody);
ae.position.x=ai/T;ae.position.y=ah/T;ab=new s;ab.density=aj;ab.friction=af;ab.restitution=ac;ab.shape=new r;ab.shape.SetAsBox(ad/T,ak/T);return C.CreateBody(ae).CreateFixture(ab);
};J=function(ai,ah,ab,ag,aj,ad,af){var ae,ac;if(ag==null){ag=u;}if(aj==null){aj=g;}if(ad==null){ad=z;}if(af==null){af=B;}ae=new D;ae.type=(ag?k.b2_staticBody:k.b2_dynamicBody);
ae.position.x=ai/T;ae.position.y=ah/T;ac=new s;ac.density=aj;ac.friction=af;ac.restitution=ad;ac.shape=new F(ab/T);return C.CreateBody(ae).CreateFixture(ac);
};H=function(){var ai,af,ag,ae,ab,ac,aj,ah,ad;ae=0;ai=C.m_bodyList;ad=[];while(ai){ag=ai.m_fixtureList;while(ag){if(ag.m_userData){aj=Math.floor((ag.m_body.m_xf.position.x*T)-ag.m_userData.width);
ah=Math.floor((ag.m_body.m_xf.position.y*T)-ag.m_userData.height);ab=Math.round(((ag.m_body.m_sweep.a+x)%x)*A*100)/100;ac="rotate("+ab+"deg)";af={"-webkit-transform":ac,"-moz-transform":ac,"-ms-transform":ac,"-o-transform":ac,transform:ac,left:aj+"px",top:ah+"px"};
ag.m_userData.domObj.css(af);}ag=ag.m_next;}ad.push(ai=ai.m_next);}return ad;};N=function(){R();C.Step(2/60,8,3);H();if(Z){C.DrawDebugData();}C.ClearForces();
return window.setTimeout(N,1000/30);};n=function(aj,ai,ab,ae){var ac,ad,af,ag,ah;if(ai==null){ai=g;}if(ab==null){ab=z;}if(ae==null){ae=B;}y=true;C=new q(new P(I,V),true);
ah=K(window).width();af=K(window).height();a(0,-1,K(window).width(),1,true,ai,ab,ae);a(K(window).width()+1,0,1,K(window.document).height(),true,ai,ab,ae);
a(-1,0,1,K(window.document).height(),true,ai,ab,ae);a(0,K(window.document).height()+1,K(window).width(),1,true,ai,ab,ae);ag=v(document,G,f,t);if(Z){ad=new p();
ac=K("<canvas></canvas>");ad.SetSprite(ac[0].getContext("2d"));ad.SetDrawScale(T);ad.SetFillAlpha(0.3);ad.SetLineThickness(1);ad.SetFlags(p.e_shapeBit|p.e_jointBit);
ac.css("position","absolute");ac.css("top",0);ac.css("left",0);ac.css("border","1px solid green");ac.attr("width",K(window).width());ac.attr("height",K(document).height());
C.SetDebugDraw(ad);K("body").append(ac);}return N();};K.fn.extend({box2d:function(ak){var af,ad,ai,ae,ab,ac,aj,ag,ah;aj=K.fn.box2d;ab=K.extend({},aj.default_options,ak);
I=ab["x-velocity"];V=ab["y-velocity"];ai=ab.density;ac=ab.restitution;ae=ab.friction;ag=ab.shape;ah=ab["static"];ad=ab.debug;if(y===false){if(ad===true){Z=true;
}n(this,ai,ac,ae);}af=this.bodysnatch();M(af,ag,ah,ai,ac,ae);return K(af);}});K.extend(K.fn.physics,{default_options:{"x-velocity":0,"y-velocity":0,density:g,restitution:z,friction:B,"static":u,shape:j,debug:Z}});
}).call(this);